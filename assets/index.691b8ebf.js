var Cn=Object.defineProperty;var _t=Object.getOwnPropertySymbols;var yn=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable;var gt=(e,t,n)=>t in e?Cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t)=>{for(var n in t||(t={}))yn.call(t,n)&&gt(e,n,t[n]);if(_t)for(var n of _t(t))An.call(t,n)&&gt(e,n,t[n]);return e};import{A as wn,E as B,a as Se,C as Sn,e as kn,d as Bn,b as Ln,c as $n,u as xn,f as G,g as $,h as Rn,o as _,i as x,n as ke,j as i,r as Y,k as I,l as r,w as f,m as re,p as ve,q as L,s as ae,t as Be,v as Ze,x as Le,y as et,z as ht,B as Et,D as tt,F as nt,G as $e,H as Z,I as C,J as be,K as k,L as T,M as fe,N as _e,O as Tn,P as m,Q as ce,R as Un,S as se,T as De,U as Ie,V as Ft,W as Ve,X as vt,Y as xe,Z as bt,_ as On,$ as Dt,a0 as It,a1 as Ct,a2 as Mn,a3 as yt,a4 as Ce,a5 as Re,a6 as Pn,a7 as Vn,a8 as Nn,a9 as Gn,aa as At,ab as wt,ac as St,ad as zn,ae as jn,af as Hn,ag as Xn,ah as kt,ai as Kn,aj as qn,ak as Wn,al as Yn,am as Jn,an as Qn,ao as Zn,ap as ea,aq as ta}from"./vendor.70dcc70f.js";const na=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const s of u.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}};na();const aa="XPoet/picx",Ne="picx-images-hosting",sa="PicX images hosting repository",Ge="master",oa="Upload image via PicX(https://github.com/XPoet/picx)",ua="Upload images via PicX(https://github.com/XPoet/picx)",ia="Delete image via PicX(https://github.com/XPoet/picx)",la="https://api.github.com",ra=3e5,at="PICX_",st=`${at}CONFIG`,Bt=`${at}MANAGEMENT`,Lt=`${at}SETTINGS`,$t=5,xt=30,Rt=18,Tt=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Ut=la,ze=wn.create({baseURL:Ut,timeout:ra});ze.defaults.headers["Content-Type"]="application/json";ze.interceptors.request.use(e=>{var n;const t=Tt(st);if(t){const{token:a}=t;((n=e.baseURL)==null?void 0:n.includes(Ut))&&a&&(e.headers.Authorization=`token ${a}`)}return e},e=>Promise.reject(e));ze.interceptors.response.use(e=>e,e=>((e==null?void 0:e.response)||B.error({duration:6e3,message:`${e}`}),Promise.reject(e.response)));function K(e){const t={};e.method=e.method.toUpperCase();for(const n in e)n==="params"?e.method==="GET"?t.params=e.params:t.data=e.params:t[n]=e[n];return new Promise(n=>{ze.request(t).then(a=>{const{status:o,data:u}=a;n(a&&(o===200||o===201||o===204)?u||"SUCCESS":null)}).catch(a=>{var o;if((t==null?void 0:t.success422)&&(a==null?void 0:a.status)===422)n((a==null?void 0:a.data)||"SUCCESS");else{const u=a==null?void 0:a.status,s=(o=a==null?void 0:a.data)==null?void 0:o.message;(t==null?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",a),u!==void 0&&s!==void 0&&B.error({duration:6e3,message:`Code: ${u}, Message: ${s}`})),n(null)}})})}const Ot=e=>K({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),ca=(e=aa)=>K({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}),da=(e,t=1)=>new Promise(async n=>{const a=await K({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:t}});a&&a.length?n(a.filter(o=>!o.fork&&!o.private).map(o=>({value:o.name,label:o.name}))):n(null)}),Mt=async e=>{const t=[];for(let n=1;n<=3;n++){const a=await da(e,n);a&&t.push(...a)}return Promise.resolve(t.length?t:null)},Pt=async(e,t=!0)=>{const n=`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).
        `,{owner:a,selectedRepo:o,selectedBranch:u}=e;let s=null;t&&(s=Se.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."})),await K({url:`/repos/${a}/${o}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:u,content:window.btoa(n)},noShowErrorMsg:!0})?s==null||s.close():t&&B.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")},ma=e=>K({url:"/user/repos",method:"POST",params:{name:Ne,description:sa,private:!1},headers:{Authorization:`token ${e}`},success422:!0}),Te=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),pa=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},fa=e=>{if(e==="/")return[];const t=e.split("/"),n=[];let a="";return t.forEach((o,u)=>{a+=`${u>0?"/":""}${o}`,n.unshift(a)}),n};function Vt(e,t,n){var a;return e?t.length===n?e:Vt((a=e.childrenDirs)==null?void 0:a.find(o=>o.dir===t[n]),t,++n):null}const je=(e,t)=>{if(e==="/")return t;const n=e.split("/");return Vt(t,n,0)},He=(e,t,n)=>{var a;return n==="dir"?(a=t.childrenDirs)==null?void 0:a.filter(o=>o.type==="dir"):n==="image"?t.imageList.filter(o=>o.type==="image"):[]},_a=()=>{const e=localStorage.getItem(Bt);return e?JSON.parse(e):Te("/","/")},ga={state:{name:"dirImageListModule",dirObject:_a()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(l,c,p)=>l?(l.childrenDirs.some(v=>v.dir===c)||l.childrenDirs.push(Te(c,p)),l.childrenDirs.find(v=>v.dir===c)||Te(c,p)):Te(c,p),o=n.split("/");let u="",s=e.dirObject;for(let l=0,c=o.length;l<c;l++){const p=o[l];u+=`${l>0?"/":""}${p}`,s=a(s,p,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",p)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(s,l,c)=>{if(l==="/")return e.dirObject;const p=s.childrenDirs.find(g=>g.dir===l);if(!p)return s;if(c){const g=s.childrenDirs.findIndex(v=>v.dir===l);g!==-1&&s.childrenDirs.splice(g,1)}return p},o=n.split("/");let u=e.dirObject;o.forEach((s,l)=>{u=a(u,s,l===o.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",s)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},n){const a=(u,s,l,c,p=!1)=>{var v;if(!u)return e.dirObject;let g=(v=u.childrenDirs)==null?void 0:v.find(D=>D.dir===s);return g||(g={type:"dir",dir:s,dirPath:l,childrenDirs:[],imageList:[]},u.childrenDirs.push(g)),p&&!g.imageList.some(D=>D.name===c.name)&&g.imageList.push(c),g};let o=e.dirObject;if(n.dir==="/")o.imageList.some(u=>u.name===n.name)||o.imageList.push(n);else{const u=n.dir.split("/");let s="";u.forEach((l,c)=>{s+=`${c>0?"/":""}${l}`,o=a(o,l,s,n,c===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},n){const a=(p,g)=>{if(p.length){const v=p.findIndex(D=>D.uuid===g);v!==-1&&p.splice(v,1)}},o=(p,g,v,D)=>{if(!p)return e.dirObject;const E=p.childrenDirs.find(d=>d.dir===g);return E?(E.dir===g&&D&&a(E.imageList,v.uuid),E):e.dirObject},{dir:u,uuid:s}=n;if(u==="/"){a(e.dirObject.imageList,s),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let c=e.dirObject;l.forEach((p,g)=>{c=o(c,p,n,g===l.length-1),!c.imageList.length&&!c.childrenDirs.length&&fa(c.dirPath).forEach(D=>{const E=je(D,e.dirObject);if(E&&!E.imageList.length&&!E.childrenDirs.length){const{dirPath:d}=pa(D);t("SET_USER_CONFIG_INFO",{viewDir:d}),t("DIR_IMAGE_LIST_REMOVE_DIR",D)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},n){let a=e.dirObject;if(n==="/"){a.imageList=[],a.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const o=(s,l,c)=>{var g;if(!s)return e.dirObject;const p=(g=s.childrenDirs)==null?void 0:g.find(v=>v.dir===l);return p?(c&&(p.imageList=[],p.childrenDirs=[]),p):e.dirObject},u=n.split("/");u.forEach((s,l)=>{a=o(a,s,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(Bt,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Te("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var Ee;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(Ee||(Ee={}));var Fe;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(Fe||(Fe={}));var ue;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(ue||(ue={}));var de;(function(e){e.newBranch="newBranch",e.repoBranch="repoBranch"})(de||(de={}));var q;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.repoDir="repoDir"})(q||(q={}));var J;(function(e){e.large="large",e.default="default",e.small="small"})(J||(J={}));var me;(function(e){e.leftTop="leftTop",e.leftBottom="leftBottom",e.rightTop="rightTop",e.rightBottom="rightBottom"})(me||(me={}));var Q;(function(e){e.auto="auto",e.light="light",e.dark="dark"})(Q||(Q={}));var ye;(function(e){e[e.parentDir=0]="parentDir",e[e.childDir=1]="childDir",e[e.img=2]="img"})(ye||(ye={}));const Nt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},ge=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Gt=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{t&&t()})},zt=e=>{for(const t in e)switch(Nt(e[t])){case"object":zt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},ot=(e,t)=>{for(const n in t)Nt(t[n])!=="object"?e&&(e[n]=t[n]):ot(e[n],t[n])},jt=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},Xe=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function n(u){return`00${u}`.substr(u.length)}const a=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${a.getFullYear()}`.substr(4-RegExp.$1.length)));const o={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds()};for(const u in o)if(new RegExp(`(${u})`).test(e)){const s=`${o[u]}`;e=e.replace(RegExp.$1,RegExp.$1.length===1?s:n(s))}return e},ha=(e,t=500)=>{let n,a;function o(...u){a=u,n||(n=setTimeout(()=>{e(...a),n=void 0},t))}return o};function Ea(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=()=>{const o=new Image;o.setAttribute("crossOrigin","Anonymous"),o.onload=()=>t(o),o.onerror=n,o.src=a.result},a.onerror=n,a.readAsDataURL(e)})}async function Fa(e,t){const{text:n,fontSize:a,position:o,opacity:u}=t,s=await Ea(e),l=document.createElement("canvas"),c=l.getContext("2d");l.width=s.width,l.height=s.height,c.drawImage(s,0,0),c.font=`bold ${a}px Arial`,c.strokeStyle=`rgba(0, 0, 0, ${u})`,c.lineWidth=3,c.fillStyle=`rgba(255, 255, 255, ${u})`;let p=0,g=0;switch(o){case me.leftTop:p=10,g=a+5;break;case me.rightTop:p=l.width-c.measureText(n).width-10,g=a+5;break;case me.leftBottom:p=10,g=l.height-15;break;case me.rightBottom:p=l.width-c.measureText(n).width-10,g=l.height-15;break}return c.strokeText(n,p,g),c.fillText(n,p,g),new Promise(v=>{l.toBlob(D=>{if(!D)v(null);else{const E=new File([D],e.name,{type:e.type});v(E)}},e.type)})}const Ht=()=>({uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isHashRename:!0,isRename:!1,isPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}}),va=(e,t)=>({type:"image",uuid:ge(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});async function ba(e,t){e.deleting=!0;const{owner:n,selectedRepo:a}=t,{path:o,sha:u}=e;return new Promise(async s=>{const l=await nn(n,a,o,u);e.deleting=!1,l?(s(!0),await V.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await V.dispatch("DIR_IMAGE_LIST_REMOVE",e)):s(!1)})}const Ue=(e,t=!1)=>{e.forEach(n=>{n.deleting=t})};async function Da(e,t){Ue(e,!0);const{owner:n,selectedRepo:a,selectedBranch:o}=t,u=await en(n,a,o);if(!u)throw Ue(e,!1),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const s=await an(n,a,e.map(p=>({path:p.path,sha:null})),u);if(!s)throw Ue(e,!1),new Error("\u521B\u5EFA tree \u5931\u8D25");const l=await sn(n,a,s,u);if(!l)throw Ue(e,!1),new Error("\u521B\u5EFA commit \u5931\u8D25");if(!await on(n,a,o,l.sha))throw Ue(e,!1),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(p=>{p.deleting=!1,V.dispatch("UPLOAD_IMG_LIST_REMOVE",p.uuid),V.dispatch("DIR_IMAGE_LIST_REMOVE",p)})}async function Ia(e,t){if(e.length===1)return await ba(e[0],t)?Fe.deleted:Fe.deleteFail;try{return await Da(e,t),Fe.allDeleted}catch(n){return console.error(n),Fe.deleteFail}}function Ca(e,t){const n=document.createElement("canvas"),a=n.getContext("2d"),o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(u=>{o.onload=()=>{const{width:s}=o,{height:l}=o;n.width=s,n.height=l,a==null||a.drawImage(o,0,0,s,l);const c=n.toDataURL(`image/${t}`);u(c)}})}function ya(e){return new Promise(t=>{K({baseURL:"",url:e,method:"GET",responseType:"blob"}).then(n=>{if(n){const a=new FileReader;a.onload=()=>{const o=a.result;t(o)},a.onerror=()=>{t(null)},a.readAsDataURL(n)}else t(null)}).catch(()=>{t(null)})})}function Ke(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{const a=n.result;t(a)},n.onerror=()=>t(null)})}function Xt(e){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}const Kt=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},ut=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},it=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),Aa=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),wa=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),Ae=e=>e&&Number((e/1024).toFixed(0)),Sa=e=>new Promise(async t=>{e||t(null),it(e.type)||(B.error(`${e.name} \u4E0D\u662F\u56FE\u7247\u683C\u5F0F`),t(null));const n=await Ke(e)||"";Ae(n.length)>=xt*1024&&(B.error(`${e.name} \u8D85\u8FC7 ${xt} MB\uFF0C\u8DF3\u8FC7\u9009\u62E9`),t(null)),t({uuid:ge(),base64:n,file:e})}),qt=async(e,t)=>Aa(e.type)?new Sn(e,{encoderState:{type:t,options:kn[t].meta.defaultOptions},processorState:Bn,preprocessorState:Ln}).process():e,lt=(e,t,n)=>{var u;const a=n.imageLinkType.selected,o=(u=n.imageLinkType.presetList.find(s=>s.name===a))==null?void 0:u.rule;if(o){const{owner:s,selectedRepo:l,selectedBranch:c}=t;return o.replaceAll("{{owner}}",s).replaceAll("{{repo}}",l).replaceAll("{{branch}}",c).replaceAll("{{path}}",e.path)}return null},Wt=(e,t,n)=>{var a;if(n.imageLinkFormat.enable){const o=n.imageLinkFormat.selected,u=(a=n.imageLinkFormat.presetList.find(s=>s.name===o))==null?void 0:a.format;if(u)return u.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},qe=(e,t,n,a=!1)=>{const o=Wt(lt(e,t,n),e.name,n);o?Gt(o,()=>{a?B.success({message:"\u56FE\u7247\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u7CFB\u7EDF\u526A\u8D34\u677F",duration:6e3}):B.success(`${n.imageLinkType.selected} \u56FE\u7247\u94FE\u63A5\u590D\u5236\u6210\u529F`)}):B.error("\u590D\u5236\u5931\u8D25")},Yt=(e,t,n,a=!1)=>{if((e==null?void 0:e.length)>0){let o="";e.forEach((u,s)=>{o+=`${Wt(lt(u,t,n),u.name,n)}${s<e.length-1?`
`:""}`}),Gt(o,()=>{a?B.success({message:`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5\u5230\u7CFB\u7EDF\u526A\u8D34\u677F`,duration:6e3}):B.success(`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5`)})}else console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},Jt=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:de.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:q.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(st);return t&&(ot(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===q.autoDir&&(e.selectedDir=Xe("yyyyMMdd"))),e},ka=e=>{const{selectedDir:t,selectedBranch:n,dirMode:a}=e.userConfigInfo;if(a==="newDir"){const o=t.split("");let u=0,s="";const l=[" ",".","\u3001",",","\uFF0C","!","\uFF1F","?"];for(let c=0;c<o.length&&(l.some(p=>p===o[c])&&(o[c]="-"),o[c]==="/"&&(u+=1),!(u>=$t));c++)s+=o[c];e.userConfigInfo.selectedDir=s}e.userConfigInfo.selectedBranch=n.replace(/\s+/g,"-")},Ba={state:{userConfigInfo:Jt()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Jt()},SET_USER_CONFIG_INFO({state:e,dispatch:t},n){for(const a in n)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=n[a]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},n){e.userConfigInfo.dirList.some(a=>a.value===n)||(e.userConfigInfo.dirList.push({label:n,value:n}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},n){const{dirList:a}=e.userConfigInfo;if(a.some(o=>o.value===n)){const o=a.findIndex(u=>u.value===n);a.splice(o,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){ka(e),localStorage.setItem(st,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){zt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},La={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:n,checked:a}=t;a&&e.imgCardArr.forEach(o=>{o.uuid===n&&(o.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},$a={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},rt={defaultHash:!0,prefixNaming:{enable:!1,prefix:""},compress:{enable:!0,encoder:ue.webP},theme:{mode:Q.light,autoLightTime:["08:00","19:00"]},elementPlusSize:J.default,imageLinkType:{selected:"Staticaly",presetList:[{id:ge(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:ge(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:ge(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:ge(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:me.rightBottom,opacity:.5}},xa=()=>{const e=Tt(Lt);return e&&ot(rt,e),rt},Ra={state:{userSettings:xa()},actions:{SET_USER_SETTINGS({state:e},t){for(const n in t)e.userSettings.hasOwnProperty(n)&&(e.userSettings[n]=t[n])},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){e.userSettings.imageLinkType.presetList.some(o=>o.name===n.name)?B.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u89C4\u5219\u5DF2\u5B58\u5728\uFF01"):n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")?(e.userSettings.imageLinkType.presetList.push(n),t("USER_SETTINGS_PERSIST")):B.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){if(n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")){const a=e.userSettings.imageLinkType.presetList.find(o=>o.id===n.id);a&&(a.rule=n.rule,t("USER_SETTINGS_PERSIST"))}else B.error("\u4FEE\u6539\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){const a=e.userSettings.imageLinkType.presetList;a.splice(a.findIndex(o=>o.id===n),1),t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Lt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=rt}},getters:{getUserSettings:e=>e.userSettings}},Ta={state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const n=e.toolboxImageList.findIndex(a=>a.uuid===t);n!==-1&&e.toolboxImageList.splice(n,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},Ua={state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const n=e.uploadImageList.findIndex(a=>a.uuid===t);n!==-1&&e.uploadImageList[n].uploadStatus.progress===0&&e.uploadImageList.splice(n,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},V=$n({modules:{dirImageListModule:ga,userConfigInfoModule:Ba,imageCardModule:La,uploadAreaActiveModule:$a,userSettingsModule:Ra,toolboxImageListModule:Ta,uploadImageListModule:Ua},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),Qt=Symbol("vuex-store");function ee(){return xn(Qt)}const Zt=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:o}=e;return new Promise(async u=>{const s=await K({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{ref:o}});s&&s.length?u(s.filter(l=>l.type==="dir").map(l=>({value:l.name,label:l.name}))):u(null)})},We=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:o}=e;return new Promise(async u=>{const s=await K({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{"no-cache":ge(),ref:o}});s&&s.length?(s.filter(l=>l.type==="dir").forEach(l=>V.dispatch("DIR_IMAGE_LIST_ADD_DIR",l.path)),setTimeout(()=>{s.filter(l=>l.type==="file"&&it(ut(l.name))).forEach(l=>{V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",va(l,t))})},120),u(!0)):u(null)})},en=(e,t,n)=>K({url:`/repos/${e}/${t}/branches/${n}`,method:"GET"}),tn=(e,t)=>new Promise(async n=>{const a=await K({url:`/repos/${e}/${t}/branches`,method:"GET"});a&&a.length?n(a.filter(o=>!o.protected).map(o=>({value:o.name,label:o.name})).reverse()):n(null)}),Oa=async(e,t,n)=>{const{owner:a,selectedRepo:o,branchList:u}=e,s=Se.service({text:`\u6B63\u5728\u65B0\u5EFA ${t} \u5206\u652F...`});try{let l="";const c=await K({url:`/repos/${a}/${o}/git/refs/heads/${u[0].value}`,method:"GET"});if(c&&(l=c.object.sha),!l){s.close(),B.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}let p="";const g=await K({url:`/repos/${a}/${o}/git/refs`,method:"POST",params:{ref:`refs/heads/${t}`,sha:l}});if(g&&(p=g.object.sha),!p){s.close(),B.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}await K({url:`/repos/${a}/${o}/git/refs/heads/${t}`,method:"PATCH",params:{force:!0,sha:p}})&&n()}catch(l){console.error(l)}},nn=(e,t,n,a)=>K({url:`/repos/${e}/${t}/contents/${n}`,method:"DELETE",data:{owner:e,repo:t,path:n,message:ia,sha:a}}),Ma=(e,t)=>K({url:e,method:"PUT",data:t}),Pa=(e,t,n)=>K({url:`/repos/${t}/${n}/git/blobs`,method:"POST",params:{owner:t,repo:n,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),an=(e,t,n,a)=>{var o,u,s;return K({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:n.map(l=>({path:l.path,mode:"100644",type:"blob",sha:l.sha})),base_tree:((s=(u=(o=a==null?void 0:a.commit)==null?void 0:o.commit)==null?void 0:u.tree)==null?void 0:s.sha)||null}})},sn=(e,t,n,a)=>K({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:n.sha,parents:[a.commit.sha],message:ua}}),on=(e,t,n,a)=>K({url:`/repos/${e}/${t}/git/refs/heads/${n}`,method:"PATCH",params:{sha:a}}),un=G({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:J.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!0}},setup(e){const t=ee(),n=$(()=>t.getters.getUserConfigInfo).value,a={lazy:!0,checkStrictly:!0,async lazyLoad(u,s){const{level:l,pathLabels:c}=u;let p;l===0?p=n.dirList:p=await Zt(n,c.join("/")),s(p?p.map(g=>({value:g.value,label:g.label,leaf:l>=$t-1})):[])}},o=u=>{n.selectedDirList=u,n.selectedDir=u.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,s)=>{const l=Rn;return _(),x(l,{style:ke({width:e.elWidth}),size:e.elSize,debounce:500,props:a,key:e.elKey,modelValue:i(n).selectedDirList,"onUpdate:modelValue":s[0]||(s[0]=c=>i(n).selectedDirList=c),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:e.elClearable,onChange:o},null,8,["style","size","modelValue","clearable"])}}});var H=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n};const Va=G({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:""}},setup(e){const t=e,n=ee(),a=$(()=>n.getters.getUserConfigInfo).value,o=$(()=>t.dataType==="repo"?"\u4ED3\u5E93":"\u5206\u652F"),u=async()=>{const s=Se.service({lock:!0,text:`\u6B63\u5728\u52A0\u8F7D ${o.value} \u6570\u636E ...`}),{owner:l,selectedRepo:c}=a;if(t.dataType==="repo"){const p=await Mt(l);p&&(a.repoList=p)}else if(t.dataType==="branch"){const p=await tn(l,c);p&&(a.branchList=p)}s.close(),await n.dispatch("USER_CONFIG_INFO_PERSIST")};return(s,l)=>{const c=Y("Refresh"),p=re,g=ve;return _(),I("div",{class:"refresh-config-box",style:ke({width:e.boxWidth+"rem"})},[r(g,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(o)+" \u6570\u636E"},{default:f(()=>[r(p,{class:"icon",onClick:u},{default:f(()=>[r(c)]),_:1})]),_:1},8,["content"])],4)}}});var Na=H(Va,[["__scopeId","data-v-9acb8ba8"]]);const N=$(()=>V.getters.getUserConfigInfo).value,Ga=()=>{V.dispatch("LOGOUT")},he=()=>{V.dispatch("USER_CONFIG_INFO_PERSIST")};function ln(e){N.logined=!0,N.owner=e.login,N.name=e.name,N.email=e.email,N.avatarUrl=e.avatar_url,he()}const za=()=>{N.selectedRepo="",N.repoList=[],N.selectedBranch="",N.branchMode=de.repoBranch,N.branchList=[],N.selectedDir="",N.dirMode=q.repoDir,N.dirList=[]},ja=async()=>{const{selectedDir:e,dirMode:t}=N;let n="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(e===""){switch(t){case q.newDir:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case q.repoDir:n=`\u8BF7\u9009\u62E9 ${N.selectedRepo} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}B.warning(n)}else await Oe.push("/upload")},Ha=async()=>{const{token:e}=N;if(!e){B.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}const t=Se.service({lock:!0,text:"\u6B63\u5728\u81EA\u52A8\u914D\u7F6E..."}),n=await Ot(N.token);if(console.log("getGitHubUserInfo >> ",n),!n){t.close(),B.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}ln(n);const a=await ma(N.token);if(console.log("createRepo >> ",a),!a){t.close(),B.error("\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01");return}N.repoList=[{value:Ne,label:Ne}],N.selectedRepo=Ne,N.branchList=[{value:Ge,label:Ge}],N.selectedBranch=Ge,N.branchMode=de.repoBranch,N.selectedDir=Xe("yyyyMMdd"),N.dirMode=q.autoDir,N.dirList=[],he(),await Pt(N,!1),t.close(),B.success("\u81EA\u52A8\u914D\u7F6E\u6210\u529F"),await Oe.push("/upload")};const Xa={class:"page-container config-page-container"},Ka=G({__name:"my-config",setup(e){const t=ee(),n=L(!1),a=L(!1),o=L(!1),u=L(32),s=$(()=>t.getters.getUserConfigInfo).value,l=$(()=>t.getters.getUserLoginStatus).value,c=$(()=>t.getters.getUserSettings).value,p=$(()=>!s.token||!s.owner),g=$(()=>c.elementPlusSize===J.large?"right":"top"),v=$(()=>n.value||a.value||o.value),D=L(null),E=L(null),d=L(""),F=L("repoDirCascaderKey"),S=R=>{var A;switch(R){case q.rootDir:s.selectedDir="/";break;case q.autoDir:s.selectedDir=Xe("yyyyMMdd");break;case q.newDir:s.selectedDir="xxx",(A=D.value)==null||A.focus();break;case q.repoDir:const{dirList:P}=s;P.length?(s.selectedDir=P[0].value,s.selectedDirList=[P[0].value]):s.selectedDir="";break;default:s.selectedDir="/";break}he()};async function b(R){const A=await Mt(R);console.log("getAllRepoList >> ",A),n.value=!1,A?(s.repoList=A,he()):B.error("\u4ED3\u5E93\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}async function y(){a.value=!0;const R=await Zt(s);console.log("getDirInfoList >> ",R),a.value=!1,R&&(s.dirList=R),he()}const M=R=>{var U;const A=s.selectedBranch,P=s.branchList[0].value;switch(R){case de.newBranch:s.dirMode=q.newDir,s.selectedBranch="",s.selectedDir="",(U=E.value)==null||U.focus();break;case de.repoBranch:A!==P&&(s.selectedBranch=P,y());break;default:s.selectedBranch="";break}he()};async function w(R){o.value=!0;const{owner:A,dirMode:P}=s,U=await tn(A,R);console.log("getBranchInfoList >> ",U),o.value=!1,U?(U.length>0?(s.branchList=U,s.selectedBranch=s.branchList[0].value,s.branchMode=de.repoBranch,await y()):(s.selectedBranch=Ge,s.branchMode=de.newBranch,await Pt(s)),S(P),he()):B.error("\u5206\u652F\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")}async function h(){if(!s.token){B.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}p.value||za(),n.value=!0;const R=await Ot(s.token);if(console.log("getGitHubUserInfo >> ",R),!R){B.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}ln(R),await b(R.login)}function z(R){s.branchList=[],s.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),w(R),he()}async function W(R){s.selectedBranch=R,await y(),F.value=s.selectedBranch,s.selectedDir=s.dirList[0].value,s.selectedDirList=[s.selectedDir],he()}const te=()=>{const R=d.value,A=s.branchList;R?A.find(P=>P.value===R)?B.warning(`${R} \u5206\u652F\u5DF2\u5B58\u5728\uFF0C\u8BF7\u5728\u5206\u652F\u5217\u8868\u4E2D\u9009\u62E9`):Oa(s,R,()=>{B.success(`\u65B0\u5EFA ${R} \u6210\u529F`),s.branchList.push({value:R,label:R})}):B.error("\u65B0\u5EFA\u5206\u652F\u4E0D\u80FD\u4E3A\u7A7A\uFF01")};return ae(()=>l,R=>{R||(n.value=!1,a.value=!1,o.value=!1)}),(R,A)=>{const P=Be,U=Ze,ne=Le,oe=ve,pe=et,X=ht,le=Et,ft=Na,Me=tt,Dn=nt,In=un,Je=$e;return _(),I("div",Xa,[r(pe,{"label-width":"70rem","label-position":i(g)},{default:f(()=>[r(U,{label:"Token"},{default:f(()=>[r(P,{modelValue:i(s).token,"onUpdate:modelValue":A[0]||(A[0]=O=>i(s).token=O),clearable:"",autofocus:!i(s).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),r(U,{class:"operation"},{default:f(()=>[r(oe,{placement:"top",content:"\u9009\u62E9\u5DF2\u6709\u7684 GitHub \u4ED3\u5E93"},{default:f(()=>[r(ne,{disabled:i(v),plain:"",type:"primary","native-type":"submit",onClick:A[1]||(A[1]=be(O=>h(),["prevent"]))},{default:f(()=>[k(T(i(p)?"":"\u91CD\u65B0")+"\u624B\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1}),r(oe,{placement:"top",content:"\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\uFF08\u9002\u5408\u65B0\u7528\u6237\uFF09"},{default:f(()=>[r(ne,{plain:"",disabled:i(v),type:"primary",onClick:A[2]||(A[2]=be(O=>i(Ha)(),["prevent"]))},{default:f(()=>[k(T(i(p)?"":"\u91CD\u65B0")+"\u4E00\u952E\u81EA\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["label-position"]),i(s).token&&i(s).owner?Z((_(),x(pe,{key:0,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F..."},{default:f(()=>[i(s).owner?(_(),x(U,{key:0,label:"\u7528\u6237\u540D"},{default:f(()=>[r(P,{modelValue:i(s).owner,"onUpdate:modelValue":A[3]||(A[3]=O=>i(s).owner=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(s).email?(_(),x(U,{key:1,label:"\u90AE\u7BB1"},{default:f(()=>[r(P,{modelValue:i(s).email,"onUpdate:modelValue":A[4]||(A[4]=O=>i(s).email=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(s).repoList.length?(_(),x(U,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:f(()=>[r(le,{modelValue:i(s).selectedRepo,"onUpdate:modelValue":A[5]||(A[5]=O=>i(s).selectedRepo=O),filterable:!0,style:ke({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:z},{default:f(()=>[(_(!0),I(fe,null,_e(i(s).repoList,(O,Qe)=>(_(),x(X,{key:Qe,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(ft,{"box-width":u.value,"data-type":"repo"},null,8,["box-width"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,n.value]]):C("",!0),i(s).token&&i(s).selectedRepo&&i(s).branchList.length?Z((_(),x(pe,{key:1,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u5206\u652F\u4FE1\u606F..."},{default:f(()=>[(i(s).selectedRepo,C("",!0)),i(s).branchList.length&&i(s).branchMode===i(de).repoBranch?(_(),x(U,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:f(()=>[r(le,{modelValue:i(s).selectedBranch,"onUpdate:modelValue":A[7]||(A[7]=O=>i(s).selectedBranch=O),filterable:!0,style:ke({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:W},{default:f(()=>[(_(!0),I(fe,null,_e(i(s).branchList,(O,Qe)=>(_(),x(X,{key:Qe,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(ft,{"box-width":u.value,"data-type":"branch"},null,8,["box-width"])]),_:1})):C("",!0),i(s).branchMode===i(de).newBranch?(_(),x(U,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:f(()=>[r(P,{modelValue:d.value,"onUpdate:modelValue":A[8]||(A[8]=O=>d.value=O),onBlur:te,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F...",ref_key:"newBranchInputRef",ref:E},null,8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,o.value]]):C("",!0),i(s).token&&i(s).selectedBranch?Z((_(),x(pe,{key:2,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u76EE\u5F55\u4FE1\u606F..."},{default:f(()=>[i(s).selectedBranch?(_(),x(U,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:f(()=>[r(Dn,{modelValue:i(s).dirMode,"onUpdate:modelValue":A[9]||(A[9]=O=>i(s).dirMode=O),onChange:S},{default:f(()=>[r(oe,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[r(Me,{label:"newDir"},{default:f(()=>[k("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),r(oe,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+i(s).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:f(()=>[r(Me,{label:"rootDir"},{default:f(()=>[k("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),r(oe,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[r(Me,{label:"autoDir"},{default:f(()=>[k("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),i(s).dirList.length&&i(s).branchMode!=="newBranch"?(_(),x(oe,{key:0,content:"\u9009\u62E9 "+i(s).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[r(Me,{label:"repoDir"},{default:f(()=>[k(" \u9009\u62E9 "+T(i(s).selectedRepo)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):C("",!0)]),_:1},8,["modelValue"])]),_:1})):C("",!0),i(s).dirMode==="autoDir"?(_(),x(U,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:f(()=>[r(P,{modelValue:i(s).selectedDir,"onUpdate:modelValue":A[10]||(A[10]=O=>i(s).selectedDir=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(s).dirMode==="rootDir"?(_(),x(U,{key:2,label:"\u6839\u76EE\u5F55"},{default:f(()=>[r(P,{modelValue:i(s).selectedDir,"onUpdate:modelValue":A[11]||(A[11]=O=>i(s).selectedDir=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(s).dirMode==="newDir"?(_(),x(U,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:f(()=>[r(P,{ref_key:"newDirInputRef",ref:D,modelValue:i(s).selectedDir,"onUpdate:modelValue":A[12]||(A[12]=O=>i(s).selectedDir=O),onInput:A[13]||(A[13]=O=>i(he)()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):C("",!0),i(s).dirList.length&&i(s).dirMode==="repoDir"&&i(s).branchMode!=="newBranch"?(_(),x(U,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:f(()=>[r(In,{"el-key":F.value,"el-size":i(c).elementPlusSize},null,8,["el-key","el-size"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,a.value]]):C("",!0),i(s).token?(_(),x(pe,{key:3,"label-width":"70rem","label-position":i(g)},{default:f(()=>[r(U,{class:"operation"},{default:f(()=>[i(s).owner?(_(),x(ne,{key:0,plain:"",disabled:i(v),type:"warning",onClick:A[14]||(A[14]=O=>i(Ga)())},{default:f(()=>[k(" \u91CD\u7F6E ")]),_:1},8,["disabled"])):C("",!0),i(s).selectedRepo?(_(),x(ne,{key:1,plain:"",disabled:i(v),type:"success",onClick:A[15]||(A[15]=O=>i(ja)())},{default:f(()=>[k(" \u786E\u8BA4 ")]),_:1},8,["disabled"])):C("",!0)]),_:1})]),_:1},8,["label-position"])):C("",!0)])}}});var qa=H(Ka,[["__scopeId","data-v-2e44335c"]]);const Wa={key:0,class:"selected-info-bar-box"},Ya={class:"info-item repo"},Ja={key:0,class:"info-item branch"},Qa={class:"info-item dir"},Za=G({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=ee(),n=$(()=>t.getters.getUserConfigInfo),a=$(()=>t.getters.getUserSettings);return(o,u)=>{const s=Tn,l=un;return i(n).selectedRepo?(_(),I("div",Wa,[m("span",Ya,[k(" \u4ED3\u5E93\uFF1A "),r(s,{"disable-transitions":""},{default:f(()=>[k(T(i(n).selectedRepo),1)]),_:1})]),i(n).selectedBranch?(_(),I("span",Ja,[k(" \u5206\u652F\uFF1A "),r(s,{"disable-transitions":""},{default:f(()=>[k(T(i(n).selectedBranch),1)]),_:1})])):C("",!0),m("span",Qa,[k(" \u76EE\u5F55\uFF1A "),i(n).dirMode!==i(q).repoDir||e.barType==="management"?(_(),x(s,{key:0,"disable-transitions":""},{default:f(()=>[k(T(e.barType==="management"?i(n).viewDir:i(n).selectedDir),1)]),_:1})):C("",!0),i(n).dirMode===i(q).repoDir&&e.barType==="upload"?(_(),x(l,{key:1,"el-size":i(a).elementPlusSize===i(J).large?i(J).default:i(a).elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):C("",!0)])])):C("",!0)}}});var rn=H(Za,[["__scopeId","data-v-dc55c6ba"]]);const cn=e=>(De("data-v-e7b81042"),e=e(),Ie(),e),es=["onDrop","onPaste"],ts=cn(()=>m("label",{for:"input-file-selector"},null,-1)),ns={key:0,class:"upload-area-tips"},as=cn(()=>m("div",{class:"text"},"\u62D6\u62FD / \u7C98\u8D34 / \u70B9\u51FB\u6B64\u5904\u9009\u62E9\u56FE\u7247",-1)),ss=["src"],os=G({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:n}){const a=ee(),o=$(()=>a.getters.getUploadAreaActive),u=L({uuid:"",base64:""}),s=L([]),l=()=>{const d=s.value.length,F=d>0?s.value[d-1]:{uuid:"",base64:""};u.value={uuid:F.uuid,base64:F.base64}},c=async d=>{if(!!d.length){s.value=[];for(const F of d){const S=await Sa(F);S&&s.value.push(S)}l(),a.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),n("getImgList",s.value)}},p=async d=>{const F=d.target;await c(F.files),F.value="",F.value=F.defaultValue},g=async d=>{await c(d.dataTransfer.files)},v=async d=>{const F=Array.from(d.clipboardData.items).filter(S=>S.kind==="file"&&it(S.type)).map(S=>S.getAsFile());await c(F)},D=()=>{s.value=[],u.value.uuid="",u.value.base64=""},E=d=>{const F=s.value.findIndex(S=>S.uuid===d);F!==-1&&s.value.splice(F,1),d===u.value.uuid&&l()};return ce(()=>{window.addEventListener("paste",v)}),Un(()=>{window.removeEventListener("paste",v)}),t({reset:D,remove:E}),(d,F)=>{const S=Y("UploadFilled"),b=re;return _(),I("div",{class:se(["getting-images-container",{focus:i(o)&&u.value.base64,disabled:e.disabled}]),onDragover:F[0]||(F[0]=be(()=>{},["prevent"])),onDrop:be(g,["stop","prevent"]),onPaste:be(v,["stop"])},[ts,m("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:p,multiple:"multiple"},null,32),u.value.base64?C("",!0):(_(),I("div",ns,[r(b,{class:"icon"},{default:f(()=>[r(S)]),_:1}),as])),u.value.base64?(_(),I("img",{key:1,class:"preview-img",src:u.value.base64},null,8,ss)):C("",!0)],42,es)}}});var dn=H(os,[["__scopeId","data-v-e7b81042"]]);const us=$(()=>V.getters.getUserSettings).value,mn=async e=>{const{starred:t}=e;t||await ca()&&await V.dispatch("SET_USER_SETTINGS",{starred:!0})},is=e=>{const t=Ht();t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{prefixNaming:n,defaultHash:a}=us,o=e.uuid,u=e.file.name.lastIndexOf("."),s=e.file.name.slice(0,u),l=e.file.name.slice(u+1);return t.filename.initName=s,t.filename.name=n.enable?`${n.prefix}${s}`:s,t.filename.prefixName=n.prefix,t.filename.hash=o,t.filename.suffix=l,t.filename.final=a?`${t.filename.name}.${o}.${l}`:`${t.filename.name}.${l}`,t.filename.isHashRename=a,t.filename.isPrefix=n.enable,t},pn=(e,t,n)=>{var u;let a=n.selectedDir;((u=t==null?void 0:t.reUploadInfo)==null?void 0:u.isReUpload)&&(a=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const o={checked:!1,type:"image",uuid:t.uuid,dir:a,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=o,V.dispatch("DIR_IMAGE_LIST_ADD_DIR",a),V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)},ls=(e,t)=>{var l;const{owner:n,selectedRepo:a,selectedDir:o}=e,u=t.filename.final;let s=u;return o!=="/"&&(s=`${o}/${u}`),((l=t==null?void 0:t.reUploadInfo)==null?void 0:l.isReUpload)&&(s=t.reUploadInfo.path),`/repos/${n}/${a}/contents/${s}`};async function rs(e,t){const{selectedBranch:n,selectedRepo:a,selectedDir:o,owner:u}=e,s=[];for(const D of t){D.uploadStatus.uploading=!0;const E=await Pa(D,u,a);E?s.push(Pe({img:D},E)):(D.uploadStatus.uploading=!1,B.error(`${D.filename.final} \u4E0A\u4F20\u5931\u8D25`))}const l=await en(u,a,n);if(!l)return Promise.resolve(!1);const c=o==="/"?"":`${o}/`,p=await an(u,a,s.map(D=>({sha:D.sha,path:`${c}${D.img.filename.final}`})),l);if(!p)return Promise.resolve(!1);const g=await sn(u,a,p,l);return!g||!await on(u,a,n,g.sha)?Promise.resolve(!1):(s.forEach(D=>{const E=D.img.filename.final;pn({name:E,sha:D.sha,path:`${c}${E}`,size:0},D.img,e)}),Promise.resolve(!0))}function fn(e,t){const{selectedBranch:n,email:a,owner:o}=e,u={message:oa,branch:n,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return a&&(u.committer={name:o,email:a}),t.uploadStatus.uploading=!0,new Promise(async s=>{const l=await Ma(ls(e,t),u);if(console.log("uploadSingleImage >> ",l),t.uploadStatus.uploading=!1,l){const{name:c,sha:p,path:g,size:v}=l.content;pn({name:c,sha:p,path:g,size:v},t,e),s(!0)}else s(!1)})}const ct=(e,t)=>{e?t.filename.name=`${t.filename.prefixName}${t.filename.initName}`:t.filename.name=`${t.filename.initName}`,t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},_n=(e,t)=>{e?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},cs=(e,t)=>{t.filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):ct(t.filename.isPrefix,t),t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},ds=async(e,t)=>{const{watermark:n,compress:a}=t;let o=e.fileInfo.originalFile;n.enable&&n.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=wa(e.fileInfo.originalFile.type)?await Fa(e.fileInfo.originalFile,n):e.fileInfo.originalFile,o=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Ke(o),e.beforeUploadStatus.watermarking=!1),a.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await qt(o,a.encoder),o=e.fileInfo.compressFile,e.base64.compressBase64=await Ke(o),e.filename.suffix=ut(o.name),e.beforeUploadStatus.compressing=!1)};const ms=["element-loading-text"],ps={class:"before-upload-handle-container"},fs={class:"img-name-box"},_s={class:"img-name text-ellipsis"},gs={class:"operate-item"},hs={class:"operate-item"},Es={key:0,class:"operate-item"},Fs={key:1,class:"img-info-box"},vs={class:"file-size-box"},bs={key:0,class:"finial-file-size file-size-item"},Ds={class:"last-modified"},Is=G({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=e,a=ee(),o=L(null),u=$(()=>a.getters.getUserSettings).value,s=$(()=>a.getters.getUserConfigInfo).value,l=L(""),c=Ft({isHash:!1,prefixNaming:!1,isRename:!1,newName:""}),p=L(!0),g=E=>{t("remove",E)},v=()=>{n.imgObj.filename.newName=c.newName,setTimeout(()=>{var E;(E=o.value)==null||E.focus()},100),cs(c.isRename,n.imgObj)},D=()=>{const{defaultHash:E,prefixNaming:d}=u;n.imgObj.uploadStatus.progress===0&&(n.imgObj.filename.isHashRename=E,n.imgObj.filename.isPrefix=d.enable,n.imgObj.filename.prefixName=d.prefix,ct(d.enable,n.imgObj),_n(E,n.imgObj),c.isHash=n.imgObj.filename.isHashRename,c.prefixNaming=n.imgObj.filename.isPrefix,c.isRename=n.imgObj.filename.isRename,c.newName=n.imgObj.filename.newName)};return ae(()=>n.imgObj.uploadStatus,E=>{E.uploading&&(l.value="\u6B63\u5728\u4E0A\u4F20...")},{deep:!0,immediate:!0}),ce(async()=>{await ds(n.imgObj,u),D()}),(E,d)=>{var A,P,U,ne,oe,pe;const F=Ve,S=Y("CaretBottom"),b=Y("CaretLeft"),y=re,M=ve,w=vt,h=Be,z=Y("Remove"),W=Y("Upload"),te=Y("Check"),R=$e;return _(),I("div",{class:se(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploading:e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress!==100,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[Z((_(),I("div",{class:"img-show-container","element-loading-text":l.value},[r(F,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])],8,ms)),[[R,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),m("div",ps,[m("div",fs,[m("span",_s,T(e.imgObj.filename.final||e.imgObj.filename.name),1),e.imgObj.uploadStatus.progress===0?(_(),x(M,{key:0,placement:"top",offset:8,content:p.value?"\u5C55\u5F00":"\u6298\u53E0"},{default:f(()=>[r(y,{class:"fold-btn",onClick:d[0]||(d[0]=X=>p.value=!p.value)},{default:f(()=>[p.value?C("",!0):(_(),x(S,{key:0})),p.value?(_(),x(b,{key:1})):C("",!0)]),_:1})]),_:1},8,["content"])):C("",!0)]),e.imgObj.uploadStatus.progress===0?(_(),I("div",{key:0,class:se(["img-name-operate-box",{folded:p.value}])},[m("div",gs,[r(w,{label:"\u54C8\u5E0C\u5316",modelValue:c.isHash,"onUpdate:modelValue":d[1]||(d[1]=X=>c.isHash=X),onChange:d[2]||(d[2]=X=>i(_n)(X,e.imgObj))},null,8,["modelValue"])]),m("div",hs,[r(w,{label:"\u91CD\u547D\u540D",modelValue:c.isRename,"onUpdate:modelValue":d[3]||(d[3]=X=>c.isRename=X),onChange:v},null,8,["modelValue"]),e.imgObj.filename.isRename?(_(),x(h,{key:0,class:"rename-input",size:"small",modelValue:c.newName,"onUpdate:modelValue":d[4]||(d[4]=X=>c.newName=X),onInput:v,maxlength:i(Rt),ref_key:"renameInputRef",ref:o,clearable:""},null,8,["modelValue","maxlength"])):C("",!0)]),!e.imgObj.filename.isRename&&i(u).prefixNaming.enable&&i(u).prefixNaming.prefix?(_(),I("div",Es,[r(w,{label:"\u547D\u540D\u524D\u7F00",modelValue:c.prefixNaming,"onUpdate:modelValue":d[5]||(d[5]=X=>c.prefixNaming=X),onChange:d[6]||(d[6]=X=>i(ct)(X,e.imgObj))},null,8,["modelValue"])])):C("",!0)],2)):C("",!0),e.imgObj.uploadStatus.progress===0?(_(),I("div",Fs,[m("div",vs,[m("span",{class:se(["original-file-size file-size-item",{"del-line":(P=(A=e.imgObj.fileInfo)==null?void 0:A.compressFile)==null?void 0:P.size}])},T(i(Ae)(e.imgObj.fileInfo.originalFile.size))+" KB ",3),((ne=(U=e.imgObj.fileInfo)==null?void 0:U.compressFile)==null?void 0:ne.size)?(_(),I("span",bs,T(i(Ae)((pe=(oe=e.imgObj.fileInfo)==null?void 0:oe.compressFile)==null?void 0:pe.size))+" KB ",1)):C("",!0)]),m("span",Ds,T(i(Xe)("yyyy-MM-dd hh:mm",e.imgObj.fileInfo.originalFile.lastModified)),1)])):C("",!0)]),e.imgObj.uploadStatus.progress===100?(_(),I("div",{key:0,class:"after-upload-handle-container flex-center",onClick:d[7]||(d[7]=X=>i(qe)(e.imgObj.uploadedImg,i(s),i(u)))}," \u70B9\u51FB\u590D\u5236\u56FE\u7247\u94FE\u63A5 ")):C("",!0),e.imgObj.uploadStatus.progress===0?(_(),x(M,{key:1,placement:"top",offset:8,content:"\u5220\u9664"},{default:f(()=>[r(y,{class:"del-img-btn",onClick:d[8]||(d[8]=X=>g(e.imgObj.uuid))},{default:f(()=>[r(z)]),_:1})]),_:1})):C("",!0),m("div",{class:se(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[r(y,null,{default:f(()=>[!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0?(_(),x(W,{key:0})):C("",!0),!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100?(_(),x(te,{key:1})):C("",!0)]),_:1})],2)],2)}}});var Cs=H(Is,[["__scopeId","data-v-2a6b23a0"]]);const ys={class:"upload-page-container"},As={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},ws={class:"row-item"},Ss={class:"content-box"},ks={class:"row-item"},Bs={class:"content-box upload-area-status"},Ls={key:0},$s={key:0,class:"row-item"},xs={class:"content-box",style:{"text-align":"right"}},Rs={class:"shortcut-key"},Ts={class:"shortcut-key"},Us=G({__name:"upload-image",setup(e){const t=ee(),n=xe(),a=L(null),o=$(()=>t.getters.getUserConfigInfo).value,u=$(()=>t.getters.getUserSettings).value,s=$(()=>t.getters.getUserLoginStatus),l=L([]),c=L(!1),p=$(()=>jt()==="mac"?"Command":"Ctrl"),g=b=>{b.forEach(y=>{t.dispatch("UPLOAD_IMG_LIST_ADD",is(y))})},v=()=>{var b;(b=a.value)==null||b.reset()},D=async b=>{if(b.length===1)return await fn(o,b[0])?Ee.uploaded:Ee.uploadFail;if(b.length>1)return await rs(o,b)?Ee.allUploaded:Ee.uploadFail},E=async()=>{const{token:b,selectedRepo:y,selectedDir:M}=o;if(!b){B.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E"),await n.push("/config");return}if(!y){B.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),await n.push("/config");return}if(!M){B.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),await n.push("/config");return}const w=l.value.filter(W=>W.uploadStatus.progress===0);if(w.length===0){B.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247");return}c.value=!0;const h=await D(w);c.value=!1;const z=w.filter(W=>W.uploadStatus.progress===100).map(W=>W.uploadedImg);switch(h){case Ee.uploaded:v(),B.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F"),qe(z[0],o,u,!0),await mn(u);break;case Ee.allUploaded:v(),B.success("\u56FE\u7247\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),Yt(z,o,u,!0),await mn(u);break;case Ee.uploadFail:B.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF01")}},d=()=>{c.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),v()},F=b=>{var y;t.dispatch("UPLOAD_IMG_LIST_REMOVE",b),(y=a.value)==null||y.remove(b)};ae(()=>s,b=>{!b&&d()}),ae(()=>t.state.uploadImageListModule.uploadImageList,b=>{l.value=b},{immediate:!0,deep:!0});const S=()=>{document.addEventListener("keydown",b=>{const y=b.keyCode||b.which||b.charCode,M=b.ctrlKey||b.metaKey;M&&y===65&&l.value.length&&(d(),b.preventDefault()),M&&y===83&&(c.value||(E(),b.preventDefault()))})};return ce(()=>{S()}),(b,y)=>{const M=dn,w=rn,h=Le;return _(),I("div",ys,[l.value.length&&(i(u).elementPlusSize===i(J).large||i(u).elementPlusSize===i(J).default)?(_(),I("div",As,[(_(!0),I(fe,null,_e(l.value,(z,W)=>(_(),I("div",{class:"uploaded-item",key:W+z.uuid},[r(Cs,{"img-obj":z,onRemove:y[0]||(y[0]=te=>F(te))},null,8,["img-obj"])]))),128))])):C("",!0),m("div",{class:se(["upload-page-right page-container",{"has-left":l.value.length}])},[m("div",ws,[m("div",Ss,[r(M,{disabled:c.value,ref_key:"gettingImagesRef",ref:a,onGetImgList:g},null,8,["disabled"])])]),m("div",ks,[m("div",Bs,[r(w),l.value.length?(_(),I("div",Ls," \u5DF2\u4E0A\u4F20\uFF1A"+T(l.value.filter(z=>z.uploadStatus.progress===100).length)+" / "+T(l.value.length),1)):C("",!0)])]),l.value.length?(_(),I("div",$s,[m("div",xs,[r(h,{disabled:c.value,plain:"",type:"warning",onClick:d},{default:f(()=>[k(" \u91CD\u7F6E "),m("span",Rs,T(i(p))+" + A",1)]),_:1},8,["disabled"]),r(h,{disabled:c.value,plain:"",type:"primary",onClick:E},{default:f(()=>[k(" \u4E0A\u4F20 "),m("span",Ts,T(i(p))+" + S",1)]),_:1},8,["disabled"])])])):C("",!0)],2)])}}});const Os={class:"copy-image-link-box"},Ms={class:"left"},Ps={class:"btn-box right"},Vs=G({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,n=$(()=>V.getters.getUserSettings).value,a=$(()=>V.getters.getUserConfigInfo).value;let o=L(t.imgObj).value;const u=()=>{qe(o,a,n)};return bt(()=>{o=t.imgObj}),(s,l)=>{const c=Y("InfoFilled"),p=re,g=ve;return _(),I("div",Os,[m("div",Ms,[r(g,{content:"\u8BF7\u5728'\u6211\u7684\u8BBE\u7F6E'\u8FDB\u884C\u56FE\u7247\u94FE\u63A5\u76F8\u5173\u914D\u7F6E",placement:"top"},{default:f(()=>[r(p,null,{default:f(()=>[r(c)]),_:1})]),_:1})]),m("div",Ps,[r(g,{content:"\u70B9\u51FB\u590D\u5236 "+i(n).imageLinkType.selected+" \u56FE\u7247\u94FE\u63A5",placement:"top"},{default:f(()=>[m("span",{class:"btn-item flex-center",onClick:u}," \u590D\u5236\u94FE\u63A5 ")]),_:1},8,["content"])])])}}});var Ns=H(Vs,[["__scopeId","data-v-88d7032a"]]);const Gs={class:"image-box"},zs={class:"info-box"},js={class:"image-info"},Hs={key:0,class:"rename-operate"},Xs={key:1,class:"filename"},Ks={class:"copy-link-box"},qs={class:"operation-box"},Ws={class:"operation-left"},Ys={class:"operation-right"},Js={class:"operation-btn"},Qs=G({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,n=ee(),a=On(),o=$(()=>n.getters.getUserConfigInfo).value,u=$(()=>n.getters.getUserSettings).value,s=$(()=>a.path==="/management"),l=$(()=>lt(t.imageObj,o,u)),c=L(),p=L(""),g=L(!1),v=L(!1),D=L(!1),E=(w,h=!1)=>{h||(w.deleting=!0);const{owner:z,selectedRepo:W}=o,{path:te,sha:R}=w;return new Promise(async A=>{await nn(z,W,te,R)?(h?(g.value=!1,B.success("\u66F4\u65B0\u6210\u529F")):B.success("\u5220\u9664\u6210\u529F"),await n.dispatch("DIR_IMAGE_LIST_REMOVE",w),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid),A(!0)):A(!1)})},d=w=>{Re.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${w.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{E(w)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},F=w=>{w.checked=!w.checked,n.commit("IMAGE_CARD",{imageObj:w})},S=async w=>{g.value=!0,p.value=Kt(w.name),setTimeout(()=>{var h;(h=c.value)==null||h.focus()},100)},b=async()=>{var z;const{imageObj:w}=t;if(!p.value){B.error("\u56FE\u7247\u540D\u4E0D\u80FD\u4E3A\u7A7A"),(z=c.value)==null||z.focus();return}if(p.value===Kt(w.name)){B.error("\u56FE\u7247\u540D\u65E0\u6539\u53D8"),g.value=!1;return}const h=async()=>{const W=Se.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),te=ut(w.name),R=ge(),A=`${p.value}${u.defaultHash?`.${R}`:""}.${te}`;let P;if(te.includes("svg")?P=await ya(l.value||""):P=await Ca(l.value||"",te),P){const U=Ht();U.uuid=R,U.base64.originalBase64=P,U.filename.final=A,U.reUploadInfo.isReUpload=!0,U.reUploadInfo.dir=w.dir;let ne=A;w.dir!=="/"&&(ne=`${w.dir}/${A}`),U.reUploadInfo.path=ne,await fn(o,U)?(p.value="",await E(w,!0),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid)):B.error("\u91CD\u547D\u540D\u5931\u8D25")}else B.error("\u91CD\u547D\u540D\u5931\u8D25");W.close(),g.value=!1};Re.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${p.value} \uFF1F`,"\u63D0\u793A",{type:"info"}).then(()=>{h()}).catch(()=>{console.log("\u53D6\u6D88\u91CD\u547D\u540D"),g.value=!1})},y=w=>{D.value=w},M=w=>{Re.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${w.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Ae(w.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(w,h)=>{const z=Ve,W=Be,te=Le,R=Pn,A=Ns,P=re,U=Y("MoreFilled"),ne=Dt,oe=It,pe=Ct,X=$e;return Z((_(),I("div",{class:se(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:h[6]||(h[6]=le=>v.value=!0),onMouseleave:h[7]||(h[7]=le=>v.value=!1)},[m("div",Gs,[r(z,{src:i(l),fit:"cover",loading:"lazy",lazy:"","data-fancybox":"gallery"},null,8,["src"])]),m("div",zs,[m("div",js,[g.value?(_(),I("div",Hs,[r(W,{size:"small",class:"rename-input",modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=le=>p.value=le),clearable:"",ref_key:"renameInputRef",ref:c,maxlength:i(Rt)},null,8,["modelValue","maxlength"]),r(R,{size:"small"},{default:f(()=>[r(te,{icon:i(Mn),onClick:h[1]||(h[1]=le=>g.value=!1)},null,8,["icon"]),r(te,{icon:i(yt),onClick:be(b,["prevent"])},null,8,["icon","onClick"])]),_:1})])):(_(),I("div",Xs,T(e.imageObj.name),1))])]),m("div",Ks,[r(A,{"img-obj":e.imageObj},null,8,["img-obj"])]),Z(m("div",qs,[m("div",Ws,[i(s)?(_(),I("div",{key:0,class:se([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:h[2]||(h[2]=le=>F(e.imageObj))},[e.imageObj.checked?(_(),x(P,{key:0},{default:f(()=>[r(i(yt))]),_:1})):C("",!0)],2)):C("",!0)]),m("div",Ys,[r(pe,{size:"default",trigger:"click",onVisibleChange:y},{dropdown:f(()=>[r(oe,null,{default:f(()=>[r(ne,{onClick:h[3]||(h[3]=le=>d(e.imageObj))},{default:f(()=>[k(" \u5220\u9664 ")]),_:1}),r(ne,{onClick:h[4]||(h[4]=be(le=>S(e.imageObj),["self"]))},{default:f(()=>[k(" \u91CD\u547D\u540D ")]),_:1}),r(ne,{onClick:h[5]||(h[5]=le=>M(e.imageObj))},{default:f(()=>[k(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:f(()=>[m("div",Js,[r(P,null,{default:f(()=>[r(U)]),_:1})])]),_:1})])],512),[[Ce,v.value||D.value||e.imageObj.checked]])],34)),[[X,e.imageObj.deleting]])}}});var Zs=H(Qs,[["__scopeId","data-v-4a38fea8"]]);const gn=e=>(De("data-v-fba37bd4"),e=e(),Ie(),e),eo=gn(()=>m("div",{class:"icon"},[m("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[m("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),m("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),to={key:1,class:"text"},no={key:2,class:"icon"},ao=gn(()=>m("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[m("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),so=[ao],oo={key:3,class:"text"},uo=G({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,n=ee(),a=$(()=>n.getters.getUserConfigInfo).value,o=()=>{const{folderObj:u,mode:s}=t;if(s==="back"){const l=a.viewDir;if(l==="/")return;const c=l.split("/");c.length===1?a.viewDir="/":c.length>1&&(c.length-=1,a.viewDir=c.join("/"))}s==="dir"&&(a.viewDir=u.dirPath),n.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,s)=>{const l=ve;return _(),I("div",{class:"folder-card",onDblclick:o},[e.mode==="dir"?(_(),x(l,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:f(()=>[eo]),_:1})):C("",!0),e.mode==="dir"?(_(),I("div",to,T(e.folderObj.dir),1)):C("",!0),e.mode==="back"?(_(),I("div",no,so)):C("",!0),e.mode==="back"?(_(),I("div",oo,"\u53CC\u51FB\u540E\u9000")):C("",!0)],32)}}});var hn=H(uo,[["__scopeId","data-v-fba37bd4"]]);const io={key:0,class:"selector-wrapper"},lo={class:"selector-left-box"},ro={class:"item"},co={class:"selector-right-box"},mo=G({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,n=ee(),a=L(!1),o=$(()=>n.getters.getImageCardCheckedArr),u=$(()=>n.getters.getUserConfigInfo).value,s=$(()=>n.getters.getUserSettings).value,l=$(()=>o.value.length||0);ae(()=>l.value,D=>{const E=t.currentDirImageList.length;a.value=D===E});const c=()=>{Yt(o.value,u,s)},p=()=>{t.currentDirImageList.forEach(D=>{D.checked&&(D.checked=!1)})},g=()=>{var D,E;((D=o.value)==null?void 0:D.length)>0?Re.confirm(`\u5DF2\u9009\u4E2D ${(E=o.value)==null?void 0:E.length} \u5F20\u56FE\u7247\uFF0C\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F`,"\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const d=await Ia(o.value,u);d===Fe.deleted&&B.success("\u5220\u9664\u6210\u529F"),d===Fe.allDeleted&&B.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),d===Fe.deleteFail&&B.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):B.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},v=()=>{let D=[];t.currentDirImageList.forEach(E=>{E.checked=a.value}),D=t.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:D})};return ce(()=>{v()}),(D,E)=>{const d=vt,F=Y("CopyDocument"),S=re,b=ve,y=Y("Delete");return i(l)?(_(),I("div",io,[m("div",lo,[r(d,{label:a.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:a.value,"onUpdate:modelValue":E[0]||(E[0]=M=>a.value=M),onChange:v},null,8,["label","modelValue"]),m("div",ro,"\u5DF2\u9009\u62E9 "+T(i(l))+" \u5F20\u56FE\u7247",1),m("div",{class:"item cancel-select-btn",onClick:p},"\u53D6\u6D88\u9009\u62E9")]),m("div",co,[r(b,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u94FE\u63A5"},{default:f(()=>[r(S,{class:"btn-icon",onClick:c},{default:f(()=>[r(F)]),_:1})]),_:1}),r(b,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:f(()=>[r(S,{class:"btn-icon",onClick:g},{default:f(()=>[r(y)]),_:1})]),_:1})])])):C("",!0)}}});var po=H(mo,[["__scopeId","data-v-fb405f6a"]]);const fo=e=>(De("data-v-45520a6c"),e=e(),Ie(),e),_o={class:"page-container management-page-container"},go={class:"content-container"},ho={class:"top"},Eo={class:"left"},Fo={class:"right flex-start"},vo={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},bo={key:0,class:"image-management-item"},Do=fo(()=>m("div",{style:{width:"100%"}},null,-1)),Io=G({__name:"imgs-management",setup(e){const t=ee(),n=xe(),a=$(()=>t.getters.getUserConfigInfo).value,o=$(()=>t.getters.getUserLoginStatus).value,u=$(()=>t.getters.getDirObject).value,s=L(new Date().getTime()),l=L(!1),c=L([]),p=L([]),g=L(!1);async function v(d){l.value=!0;const F=je(d,u);if(F){const S=He(d,F,"dir"),b=He(d,F,"image");!S.length&&!b.length?await We(a,d):(c.value=S,p.value=b,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:p.value}))}else await We(a,d);l.value=!1}async function D(){const{selectedDir:d,viewDir:F,dirMode:S}=a;if(F===""&&((S===q.newDir||S===q.autoDir)&&!je(d,u)&&(a.selectedDir="/",a.dirMode="rootDir"),a.selectedDir?a.viewDir=a.selectedDir:a.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await We(a,a.viewDir);return}await v(a.viewDir)}async function E(){const{viewDir:d}=a;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",d),l.value=!0,await We(a,d),l.value=!1}return ce(()=>{D()}),ae(()=>o,d=>{d===!1&&n.push("/config")}),ae(()=>a.viewDir,async d=>{await v(d),s.value+=1},{deep:!0}),ae(()=>u,d=>{const{viewDir:F}=a,S=je(F,d);S&&(c.value=He(F,S,"dir"),p.value=He(F,S,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:p.value}))},{deep:!0}),ae(()=>p.value,d=>{g.value=d.filter(F=>F.checked).length>0},{deep:!0}),(d,F)=>{const S=Y("Refresh"),b=re,y=ve,M=Vn("contextmenu"),w=$e;return _(),I("div",_o,[m("div",go,[m("div",ho,[m("div",Eo,[r(rn,{"bar-type":"management"})]),m("div",Fo,[r(y,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(a).viewDir+" \u76EE\u5F55\u5185\u5BB9"},{default:f(()=>[r(b,{class:"btn-icon",onClick:be(E,["stop"])},{default:f(()=>[r(S)]),_:1},8,["onClick"])]),_:1},8,["content"])])]),Z((_(),I("div",vo,[p.value.length?(_(),x(po,{currentDirImageList:p.value,"onUpdate:initImageList":p.value,key:s.value},null,8,["currentDirImageList","onUpdate:initImageList"])):C("",!0),Z((_(),I("ul",{class:"image-management-list",style:ke({height:g.value?"calc(100% - 50rem)":"100%"})},[i(a).viewDir!=="/"?(_(),I("li",bo,[r(hn,{mode:"back"})])):C("",!0),(_(!0),I(fe,null,_e(c.value,(h,z)=>Z((_(),I("li",{class:"image-management-item",key:"folder-card-"+h.dir+"-"+z},[r(hn,{"folder-obj":h},null,8,["folder-obj"])])),[[M,{type:i(ye).childDir,dir:h.dir}]])),128)),Do,(_(!0),I(fe,null,_e(p.value,(h,z)=>Z((_(),I("li",{class:"image-management-item image",key:"image-card-"+z},[r(Zs,{"image-obj":h},null,8,["image-obj"])])),[[M,{type:i(ye).img,img:h}]])),128))],4)),[[M,{type:i(ye).parentDir}]])])),[[w,l.value]])])])}}});var Co=H(Io,[["__scopeId","data-v-45520a6c"]]);const yo=["contenteditable","onFocusout"],Ao={style:{"margin-top":"20px"}},wo=G({__name:"image-link-rule-config",setup(e){const t=$(()=>V.getters.getUserSettings).value,n=L(),a=Ft({id:"",name:"",rule:"",editable:!0}),o=(l,c)=>{V.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:l,id:c})},u=l=>{Re.confirm(`<span>\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A</span><strong>${l.name}</strong>`,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{V.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l.id)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},s=l=>{!l||l.validate(c=>{if(c)a.id=ge(),V.dispatch("ADD_IMAGE_LINK_TYPE_RULE",a);else return!1})};return(l,c)=>{const p=Nn,g=Le,v=Gn,D=At,E=Be,d=Ze,F=et,S=wt;return _(),x(S,null,{default:f(()=>[r(v,{data:i(t).imageLinkType.presetList,style:{width:"100%"}},{default:f(()=>[r(p,{prop:"name",label:"\u7C7B\u578B",width:"120"}),r(p,{label:"CDN \u89C4\u5219"},{default:f(b=>[m("div",{contenteditable:b.row.editable,onFocusout:y=>o(y.target.innerHTML,b.row.id)},T(b.row.rule),41,yo)]),_:1}),r(p,{label:"\u64CD\u4F5C",width:"80"},{default:f(b=>[r(g,{link:"",type:"danger",size:"small",disabled:!b.row.editable,onClick:y=>u(b.row)},{default:f(()=>[k(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),r(D),m("div",Ao,[r(F,{ref_key:"formRef",ref:n,"label-position":"left",model:a,"label-width":"120px",size:"default"},{default:f(()=>[r(d,{label:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B",prop:"name",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:f(()=>[r(E,{modelValue:a.name,"onUpdate:modelValue":c[0]||(c[0]=b=>a.name=b),type:"text"},null,8,["modelValue"])]),_:1}),r(d,{label:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219",prop:"rule",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:f(()=>[r(E,{modelValue:a.rule,"onUpdate:modelValue":c[1]||(c[1]=b=>a.rule=b),type:"text"},null,8,["modelValue"])]),_:1}),r(d,null,{default:f(()=>[r(g,{type:"primary",disabled:!a.name||!a.rule,onClick:c[2]||(c[2]=b=>s(n.value))},{default:f(()=>[k(" \u6DFB\u52A0\u56FE\u7247\u94FE\u63A5\u89C4\u5219 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])]),_:1})}}});var So=H(wo,[["__scopeId","data-v-3fcb9f0e"]]);const Ye=e=>(De("data-v-d876ad10"),e=e(),Ie(),e),ko={class:"compress-config-box"},Bo=Ye(()=>m("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u7247\u538B\u7F29\u7B97\u6CD5\uFF1A",-1)),Lo=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u538B\u7F29\u7387\u8F83\u9AD8\uFF0C\u5927\u591A\u6570\u6D4F\u89C8\u5668\u652F\u6301",-1)),$o=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF0C\u6240\u6709\u6D4F\u89C8\u5668\u652F\u6301",-1)),xo=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u7387\u6781\u9AD8\uFF0C\u90E8\u5206\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301",-1)),Ro=G({__name:"compress-config-box",emits:["encoder"],setup(e,{expose:t,emit:n}){const a=L(ue.webP),o=s=>{n("encoder",s)},u=()=>{a.value=ue.webP};return ce(()=>{n("encoder",a.value)}),t({reset:u}),(s,l)=>{const c=tt,p=nt;return _(),I("div",ko,[Bo,r(p,{class:"img-encoder-group",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=g=>a.value=g),onChange:o},{default:f(()=>[r(c,{label:i(ue).webP},{default:f(()=>[k(T(i(ue).webP)+" ",1),Lo]),_:1},8,["label"]),r(c,{label:i(ue).mozJPEG},{default:f(()=>[k(T(i(ue).mozJPEG)+" ",1),$o]),_:1},8,["label"]),r(c,{label:i(ue).avif},{default:f(()=>[k(T(i(ue).avif)+" ",1),xo]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}});var En=H(Ro,[["__scopeId","data-v-d876ad10"]]);const ie=e=>(De("data-v-92d0dcc8"),e=e(),Ie(),e),To={class:"page-container settings-page-container"},Uo=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u540D\u79F0\u8BBE\u7F6E\uFF1A",-1)),Oo={class:"setting-list"},Mo={class:"setting-item has-desc"},Po=ie(()=>m("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u54C8\u5E0C\u7801\uFF0C\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),Vo={class:"setting-item has-desc"},No=ie(()=>m("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u524D\u7F00\uFF0C\u4F8B\u5982\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00",-1)),Go={key:0,class:"setting-item has-desc"},zo=ie(()=>m("div",{class:"setting-title"},"\u6C34\u5370\u8BBE\u7F6E\uFF1A",-1)),jo={class:"setting-list"},Ho={class:"setting-item has-desc"},Xo=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6C34\u5370\u6587\u5B57\u3001\u5B57\u4F53\u5927\u5C0F\u3001\u4F4D\u7F6E\u548C\u900F\u660E\u5EA6",-1)),Ko={key:0,class:"setting-item"},qo=ie(()=>m("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),Wo={class:"setting-list"},Yo={class:"setting-item has-desc"},Jo=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u4E0A\u4F20\u524D\u4F1A\u81EA\u52A8\u538B\u7F29\u56FE\u7247\uFF0C\u6709\u6548\u7F29\u77ED\u56FE\u7247\u52A0\u8F7D\u65F6\u95F4\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),Qo={key:0,class:"setting-item"},Zo=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u914D\u7F6E\uFF1A",-1)),eu={class:"setting-list"},tu={class:"setting-item cdn"},nu={class:"left"},au={class:"right"},su={class:"setting-item has-desc"},ou=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u65B0\u589E\u548C\u7BA1\u7406\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219",-1)),uu={key:0,class:"setting-item"},iu=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\u8BBE\u7F6E\uFF1A",-1)),lu={class:"setting-list"},ru={class:"setting-item has-desc"},cu={class:"desc"},du={class:"setting-item"},mu={class:"left"},pu={class:"right"},fu=ie(()=>m("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),_u={class:"setting-list"},gu={class:"setting-item"},hu={key:0,class:"setting-title"},Eu={key:1,class:"setting-list"},Fu={class:"setting-item"},vu=ie(()=>m("span",{class:"time-middle-space"}," ~ ",-1)),bu=G({__name:"my-settings",setup(e){const t=$(()=>V.getters.getUserSettings).value,n=L(!1),a=()=>{V.dispatch("USER_SETTINGS_PERSIST")},o=()=>{V.dispatch("SET_USER_SETTINGS",Pe({},t)),a()};return(u,s)=>{const l=St,c=Be,p=At,g=Ze,v=zn,D=tt,E=nt,d=et,F=wt,S=En,b=ht,y=Et,M=So,w=jn;return _(),I("div",To,[Uo,m("ul",Oo,[m("li",Mo,[r(l,{modelValue:i(t).defaultHash,"onUpdate:modelValue":s[0]||(s[0]=h=>i(t).defaultHash=h),onChange:a,"active-text":"\u81EA\u52A8\u54C8\u5E0C\u5316"},null,8,["modelValue"]),Po]),m("li",Vo,[r(l,{modelValue:i(t).prefixNaming.enable,"onUpdate:modelValue":s[1]||(s[1]=h=>i(t).prefixNaming.enable=h),onChange:a,"active-text":"\u6DFB\u52A0\u524D\u7F00\u547D\u540D"},null,8,["modelValue"]),No]),i(t).prefixNaming.enable?(_(),I("li",Go,[r(c,{class:"prefix-input",modelValue:i(t).prefixNaming.prefix,"onUpdate:modelValue":s[2]||(s[2]=h=>i(t).prefixNaming.prefix=h),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:a,clearable:"",autofocus:""},null,8,["modelValue"])])):C("",!0)]),r(p),zo,m("ul",jo,[m("li",Ho,[r(l,{modelValue:i(t).watermark.enable,"onUpdate:modelValue":s[3]||(s[3]=h=>i(t).watermark.enable=h),onChange:a,"active-text":"\u662F\u5426\u6DFB\u52A0\u6C34\u5370"},null,8,["modelValue"]),Xo]),i(t).watermark.enable?(_(),I("li",Ko,[r(F,null,{default:f(()=>[r(d,{"label-position":"left","label-width":"120rem"},{default:f(()=>[r(g,{label:"\u6C34\u5370\u6587\u5B57"},{default:f(()=>[r(c,{modelValue:i(t).watermark.text,"onUpdate:modelValue":s[4]||(s[4]=h=>i(t).watermark.text=h),clearable:"",maxlength:"10",onInput:a},null,8,["modelValue"])]),_:1}),r(g,{label:"\u5B57\u4F53\u5927\u5C0F"},{default:f(()=>[r(v,{modelValue:i(t).watermark.fontSize,"onUpdate:modelValue":s[5]||(s[5]=h=>i(t).watermark.fontSize=h),min:40,max:60,step:2,onChange:a},null,8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u4F4D\u7F6E"},{default:f(()=>[r(E,{modelValue:i(t).watermark.position,"onUpdate:modelValue":s[6]||(s[6]=h=>i(t).watermark.position=h),onChange:a},{default:f(()=>[r(D,{label:i(me).leftTop},{default:f(()=>[k("\u5DE6\u4E0A\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).leftBottom},{default:f(()=>[k("\u5DE6\u4E0B\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).rightTop},{default:f(()=>[k("\u53F3\u4E0A\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).rightBottom},{default:f(()=>[k("\u53F3\u4E0B\u89D2")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u900F\u660E\u5EA6"},{default:f(()=>[r(v,{modelValue:i(t).watermark.opacity,"onUpdate:modelValue":s[7]||(s[7]=h=>i(t).watermark.opacity=h),precision:1,step:.1,min:.1,max:.9,onChange:a},null,8,["modelValue","step","min","max"])]),_:1})]),_:1})]),_:1})])):C("",!0)]),r(p),qo,m("ul",Wo,[m("li",Yo,[r(l,{modelValue:i(t).compress.enable,"onUpdate:modelValue":s[8]||(s[8]=h=>i(t).compress.enable=h),onChange:a,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"]),Jo]),i(t).compress.enable?(_(),I("li",Qo,[r(F,null,{default:f(()=>[r(S,{ref:"compressConfigBoxRef",style:{"margin-top":"10rem"},onEncoder:s[9]||(s[9]=h=>{i(t).compress.encoder=h,a()})},null,512)]),_:1})])):C("",!0)]),r(p),Zo,m("ul",eu,[m("li",tu,[k(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A "),r(y,{modelValue:i(t).imageLinkType.selected,"onUpdate:modelValue":s[10]||(s[10]=h=>i(t).imageLinkType.selected=h),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u89C4\u5219",onChange:o},{default:f(()=>[(_(!0),I(fe,null,_e(i(t).imageLinkType.presetList,h=>(_(),x(b,{key:h.name+"-"+h.id,label:h.name,value:h.name,class:"image-link-type-rule-option"},{default:f(()=>[m("span",nu,T(h.name),1),m("span",au,T(h.rule),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),m("li",su,[r(l,{modelValue:n.value,"onUpdate:modelValue":s[11]||(s[11]=h=>n.value=h),"active-text":"\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219"},null,8,["modelValue"]),ou]),n.value?(_(),I("li",uu,[r(M)])):C("",!0)]),r(p),iu,m("ul",lu,[m("li",ru,[r(l,{modelValue:i(t).imageLinkFormat.enable,"onUpdate:modelValue":s[12]||(s[12]=h=>i(t).imageLinkFormat.enable=h),onChange:a,"active-text":"\u81EA\u52A8\u8F6C\u6362\u56FE\u7247\u94FE\u63A5\u683C\u5F0F"},null,8,["modelValue"]),m("span",cu," \u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u94FE\u63A5\u65F6\u4F7F\u7528 "+T(i(t).imageLinkFormat.selected)+" \u683C\u5F0F ",1)]),m("li",du,[k(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\uFF1A "),r(y,{modelValue:i(t).imageLinkFormat.selected,"onUpdate:modelValue":s[13]||(s[13]=h=>i(t).imageLinkFormat.selected=h),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u683C\u5F0F",onChange:o},{default:f(()=>[(_(!0),I(fe,null,_e(i(t).imageLinkFormat.presetList,h=>(_(),x(b,{key:h.name,label:h.name,value:h.name,class:"image-link-type-rule-option"},{default:f(()=>[m("span",mu,T(h.name),1),m("span",pu,T(h.format),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),r(p),fu,m("ul",_u,[m("li",gu,[k(" \u9009\u62E9\u4E3B\u9898\u6A21\u5F0F\uFF1A "),r(y,{modelValue:i(t).theme.mode,"onUpdate:modelValue":s[14]||(s[14]=h=>i(t).theme.mode=h),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:o},{default:f(()=>[r(b,{label:"\u6697\u591C\u4E3B\u9898",value:i(Q).dark},null,8,["value"]),r(b,{label:"\u767D\u663C\u4E3B\u9898",value:i(Q).light},null,8,["value"]),r(b,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:i(Q).auto},null,8,["value"])]),_:1},8,["modelValue"])])]),i(t).theme.mode===i(Q).auto?(_(),I("div",hu," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):C("",!0),i(t).theme.mode===i(Q).auto?(_(),I("ul",Eu,[m("li",Fu,[r(d,{ref:"form"},{default:f(()=>[r(g,null,{default:f(()=>[r(w,{modelValue:i(t).theme.autoLightTime[0],"onUpdate:modelValue":s[15]||(s[15]=h=>i(t).theme.autoLightTime[0]=h),start:"00:00",step:"00:30",end:"23:59",onChange:o},null,8,["modelValue"]),vu,r(w,{modelValue:i(t).theme.autoLightTime[1],"onUpdate:modelValue":s[16]||(s[16]=h=>i(t).theme.autoLightTime[1]=h),start:i(t).theme.autoLightTime[0],step:"00:30",end:"23:59",onChange:o},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):C("",!0)])}}});var Du=H(bu,[["__scopeId","data-v-92d0dcc8"]]);const Iu={class:"page-container"},Cu={key:0,class:"tool-panel"},yu={class:"panel-header"},Au={class:"panel-body"},wu={key:1,class:"toolbox"},Su=["onClick"],ku={class:"top"},Bu={class:"left flex-center"},Lu={class:"right"},$u={class:"bottom"},xu=G({__name:"picx-toolbox",setup(e){const t=xe(),n=L("/toolbox"),a=L(!1),o=L({path:"",icon:"",name:"",desc:"",uuid:""}),u=L([{name:"\u56FE\u7247\u538B\u7F29",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u4E0D\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\u7684\u79BB\u7EBF\u6781\u81F4\u538B\u7F29",icon:"MagicStick",uuid:ge(),path:"/compress"}]),s=c=>{a.value=!0,o.value=Pe({},c),t.push(`${n.value}${c.path}`)};ae(()=>t.currentRoute.value,c=>{c.path===n.value&&(a.value=!1)},{deep:!0});const l=()=>{t.isReady().then(()=>{const c=t.currentRoute.value.path;if(n.value!==c){const p=c.substring(c.lastIndexOf("/")),g=u.value.find(v=>v.path===p);g&&s(g)}})};return ce(()=>{l()}),(c,p)=>{const g=Hn,v=Xn,D=Y("router-view"),E=re;return _(),I("div",Iu,[a.value?(_(),I("div",Cu,[m("div",yu,[r(v,{"separator-icon":"ArrowRight"},{default:f(()=>[r(g,{to:{path:n.value}},{default:f(()=>[k("\u5DE5\u5177\u7BB1")]),_:1},8,["to"]),r(g,null,{default:f(()=>[k(T(o.value.name),1)]),_:1})]),_:1})]),m("div",Au,[r(D)])])):(_(),I("ul",wu,[(_(!0),I(fe,null,_e(u.value,d=>(_(),I("li",{class:"tool-item",key:d.uuid,onClick:F=>s(d)},[m("div",ku,[m("div",Bu,[r(E,{size:30},{default:f(()=>[(_(),x(kt(d.icon)))]),_:2},1024)]),m("div",Lu,T(d.name),1)]),m("div",$u,T(d.desc),1)],8,Su))),128))]))])}}});var Ru=H(xu,[["__scopeId","data-v-1dd2822d"]]);const dt=e=>(De("data-v-19b6b02f"),e=e(),Ie(),e),Tu={class:"page-container feedback-page-container"},Uu=dt(()=>m("div",{class:"help-info-item description"}," \u{1F3DE}\uFE0F PicX \u662F\u4E00\u6B3E\u57FA\u4E8E GitHub API \u5F00\u53D1\u7684\u56FE\u5E8A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u56FE\u7247\u4E0A\u4F20\u6258\u7BA1\u3001\u751F\u6210\u56FE\u7247\u94FE\u63A5\u548C\u5E38\u7528\u56FE\u7247\u5DE5\u5177\u7BB1\u670D\u52A1\u3002 ",-1)),Ou={class:"help-info-item"},Mu={class:"help-info-item"},Pu={class:"help-info-item"},Vu={class:"help-info-item"},Nu={class:"help-info-item"},Gu=dt(()=>m("div",{class:"help-info-item",style:{"margin-bottom":"2rem"}}," \u{1F381} \u5982\u679C PicX \u5BF9\u4F60\u6709\u5E2E\u52A9\uFF0C\u6B22\u8FCE\u8D5E\u8D4F\u4F5C\u8005\uFF0C\u652F\u6301\u5F00\u6E90\u3002 ",-1)),zu={class:"help-info-item img"},ju=dt(()=>m("div",{class:"help-info-item red-text"},[m("strong",null," \u26A0\uFE0F \u90D1\u91CD\u58F0\u660E\uFF1A\u8BF7\u52FF\u4F7F\u7528 PicX \u4E0A\u4F20\u8FDD\u53CD\u4F60\u5F53\u5730\u6CD5\u5F8B\u7684\u56FE\u7247\uFF0C\u6240\u9020\u6210\u7684\u4E00\u5207\u540E\u679C\u4E0E\u4F5C\u8005\u65E0\u5173\u3002 ")],-1)),Hu=G({__name:"feedback-info",setup(e){const t=$(()=>jt()==="win"?"Ctrl + D":"Command + D");return(n,a)=>{const o=Kn,u=Ve;return _(),I("div",Tu,[Uu,m("div",Ou,[k(" \u{1F30D} \u5EFA\u8BAE\u5C06\u672C\u7AD9\u6DFB\u52A0\u5230\u6D4F\u89C8\u5668\u6536\u85CF\u5939\uFF0C\u65B9\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002\u5FEB\u6377\u952E\uFF1A"),m("code",null,T(i(t)),1)]),m("div",Mu,[k(" \u{1F981} \u4F5C\u8005\uFF1A "),r(o,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:f(()=>[k("@XPoet")]),_:1})]),m("div",Pu,[k(" \u{1F300} \u4ED3\u5E93\uFF1A "),r(o,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:f(()=>[k(" https://github.com/XPoet/picx ")]),_:1})]),m("div",Vu,[k(" \u{1F4D6} \u6587\u6863\uFF1A "),r(o,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:f(()=>[k(" https://picx-docs.xpoet.cn ")]),_:1})]),m("div",Nu,[k(" \u{1F4A1} \u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u5982\u9047\u5230\u95EE\u9898\uFF0C\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u6587\u6863\uFF0C\u6216\u8005\u7ED9\u4F5C\u8005\u63D0\xA0 "),r(o,{type:"primary",style:{"font-size":"16rem"},href:"https://github.com/XPoet/picx/issues",target:"_blank"},{default:f(()=>[k(" Issue ")]),_:1}),k(" \xA0\u3002 ")]),Gu,m("div",zu,[r(u,{style:{width:"300rem"},src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/common/appreciation.webp"})]),ju])}}});var Xu=H(Hu,[["__scopeId","data-v-19b6b02f"]]);const Ku={class:"img-process-state-card-container"},qu={class:"img-container","element-loading-text":"\u6B63\u5728\u538B\u7F29..."},Wu={class:"info-container"},Yu={class:"img-name text-ellipsis"},Ju={class:"img-size"},Qu={key:0,class:"finial-file-size file-size-item"},Zu=G({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=o=>{Xt(o)},a=o=>{t("remove",o)};return(o,u)=>{const s=Ve,l=Y("Remove"),c=re,p=ve,g=$e;return _(),I("div",Ku,[Z((_(),I("div",qu,[r(s,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])])),[[g,e.imgObj.processing]]),m("div",Wu,[m("div",Yu,T(e.imgObj.finialName||e.imgObj.originalName),1),m("div",Ju,[m("div",{class:se(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize}])},T(i(Ae)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize?(_(),I("div",Qu,T(i(Ae)(e.imgObj.finialSize))+" KB ",1)):C("",!0)])]),e.imgObj.finialFile?(_(),I("div",{key:0,class:"operate-container flex-center",onClick:u[0]||(u[0]=v=>n(e.imgObj.finialFile))}," \u70B9\u51FB\u4E0B\u8F7D ")):C("",!0),r(p,{placement:"top",offset:8,content:"\u5220\u9664"},{default:f(()=>[r(c,{class:"del-btn",onClick:u[1]||(u[1]=v=>a(e.imgObj.uuid))},{default:f(()=>[r(l)]),_:1})]),_:1})])}}});var ei=H(Zu,[["__scopeId","data-v-42d0a1eb"]]);const ti={class:"compress-tool-container"},ni={key:0,class:"compress-tool-left"},ai=G({__name:"compress-tool",setup(e){const t=ee(),n=L(null),a=L(null),o=L([]),u=L(ue.webP),s=L(!1),l=L(!1),c=d=>{l.value=!1,s.value=!1,d.forEach(F=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:F.uuid,originalName:F.file.name,originalSize:F.file.size,originalBase64:F.base64,originalFile:F.file})})},p=d=>{l.value=!1,u.value=d},g=()=>{var d,F;t.dispatch("TOOLBOX_IMG_LIST_RESET"),l.value=!1,(d=n.value)==null||d.reset(),(F=a.value)==null||F.reset()},v=async()=>{s.value=!0;for(const d of o.value)d.processing=!0,d.finialFile=await qt(d.originalFile,u.value),d.finialBase64=await Ke(d.finialFile)||"",d.finialSize=d.finialFile.size,d.finialName=d.finialFile.name,d.processing=!1;l.value=!0,s.value=!1},D=()=>{o.value.forEach(d=>{Xt(d.finialFile)})},E=d=>{var F;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",d),(F=n.value)==null||F.remove(d)};return ae(()=>t.state.toolboxImageListModule.toolboxImageList,d=>{o.value=d},{immediate:!0,deep:!0}),(d,F)=>{const S=ei,b=dn,y=En,M=Le;return _(),I("div",ti,[o.value.length?(_(),I("div",ni,[(_(!0),I(fe,null,_e(o.value,w=>(_(),x(S,{"img-obj":w,key:w.uuid,onRemove:E},null,8,["img-obj"]))),128))])):C("",!0),m("div",{class:se(["compress-tool-right",{"no-img":!o.value.length}])},[r(b,{ref_key:"gettingImagesRef",ref:n,onGetImgList:c},null,512),r(y,{ref_key:"compressConfigBoxRef",ref:a,style:{"margin-top":"18rem"},onEncoder:F[0]||(F[0]=w=>p(w))},null,512),m("div",{class:se(["user-operate",{compressed:l.value&&o.value.length>1}])},[l.value&&o.value.length>1?(_(),x(M,{key:0,plain:"",type:"success",onClick:D},{default:f(()=>[k(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1})):C("",!0),m("div",null,[o.value.length?(_(),x(M,{key:0,plain:"",type:"warning",onClick:g},{default:f(()=>[k(" \u91CD\u7F6E ")]),_:1})):C("",!0),o.value.length?(_(),x(M,{key:1,disabled:s.value||l.value,plain:"",type:"primary",onClick:v},{default:f(()=>[k(" \u538B\u7F29 ")]),_:1},8,["disabled"])):C("",!0)])],2)],2)])}}});var si=H(ai,[["__scopeId","data-v-3e4ce208"]]);const we=" | PicX \u56FE\u5E8A",oi=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:qa,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${we}`}},{path:"/upload",name:"upload",component:Us,meta:{title:`\u56FE\u7247\u4E0A\u4F20${we}`}},{path:"/management",name:"Management",component:Co,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${we}`}},{path:"/settings",name:"settings",component:Du,meta:{title:`\u6211\u7684\u8BBE\u7F6E${we}`}},{path:"/toolbox",name:"toolbox",component:Ru,meta:{title:`\u5DE5\u5177\u7BB1${we}`},children:[{path:"/toolbox/compress",name:"compress",component:si}]},{path:"/feedback",name:"feedback",component:Xu,meta:{title:`\u5E2E\u52A9\u53CD\u9988${we}`}}],Oe=qn({history:Wn(),routes:oi});Oe.beforeEach((e,t,n)=>{e.meta.title&&(window.document.title=e.meta.title),n()});const Fn=()=>{const e=ee(),t=async o=>{await Yn(()=>{const u=document.getElementsByTagName("html")[0];o===Q.dark&&(u.classList.remove("light"),u.classList.add("dark")),o===Q.light&&(u.classList.remove("dark"),u.classList.add("light"))})},n=o=>{const u=l=>{const c=new Date,p=c.getFullYear(),g=c.getMonth()+1,v=c.getDate();return new Date(`${p}/${g}/${v} ${o[l]}:00`).getTime()},s=Date.now();return u(0)<=s&&s<=u(1)},a=async o=>{const{theme:u}=o;u.mode===Q.auto?await t(n(u.autoLightTime)?Q.light:Q.dark):await t(u.mode)};ae(()=>e.getters.getUserSettings,async o=>{await a(o)},{deep:!0,immediate:!0})};const ui={id:"busuanzi_value_site_uv",class:"uv"},ii={id:"busuanzi_value_site_pv",class:"pv"},li=G({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,n=L(null),a=L(!1),o=$(()=>!0),u=(s,l)=>s.querySelector(`.${l?"u":"p"}v`).innerText;return ce(()=>{const s=document.createElement("script");s.async=!0,s.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",n.value.appendChild(s),s.onload=()=>{const l=setTimeout(()=>{u(n.value,t.isuv)&&(a.value=!0),clearTimeout(l)},1500)}}),(s,l)=>Z((_(),I("span",{class:"site-count",ref_key:"siteCountDom",ref:n},[k(" \u8D85\u8FC7 "),Z(m("span",ui,null,512),[[Ce,e.isuv]]),Z(m("span",ii,null,512),[[Ce,!e.isuv]]),k(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[Ce,a.value&&i(o)]])}});var ri="./assets/logo.206d082d.png";const vn=e=>(De("data-v-1f5f4d49"),e=e(),Ie(),e),ci={class:"header"},di={class:"header-left"},mi=vn(()=>m("div",{class:"logo"},[m("img",{src:ri,alt:"PicX"})],-1)),pi=vn(()=>m("div",{class:"title"},"PicX",-1)),fi=[mi,pi],_i={class:"website-count"},gi={class:"header-right"},hi={class:"username"},Ei={key:0,class:"avatar"},Fi={class:"el-dropdown-link"},vi={class:"avatar"},bi=["src","alt"],Di=G({__name:"header-content",setup(e){const t=xe(),n=ee(),a=$(()=>n.getters.getUserConfigInfo).value,o=()=>{!a.logined&&t.currentRoute.value.path!=="/config"&&t.push("/config")},u=()=>{n.dispatch("LOGOUT"),t.push("/config")},s=l=>{switch(l){case"upload":t.push("/");break;case"config":t.push("/config");break;case"management":t.push("/management");break;case"logout":u();break}};return(l,c)=>{var F,S;const p=li,g=Y("UserFilled"),v=re,D=Dt,E=It,d=Ct;return _(),I("header",ci,[m("div",di,[m("div",{class:"brand",onClick:c[0]||(c[0]=b=>i(t).push("/"))},fi),m("div",_i,[r(p,{isuv:!1})])]),m("div",gi,[m("div",{class:"user-info",onClick:o},[m("div",hi,T(i(a).owner?i(a).owner:l.$t("header.notLogin")),1),((F=i(a))==null?void 0:F.avatarUrl)?C("",!0):(_(),I("div",Ei,[r(v,{size:22},{default:f(()=>[r(g)]),_:1})])),((S=i(a))==null?void 0:S.avatarUrl)?(_(),x(d,{key:1,trigger:"click",onCommand:s},{dropdown:f(()=>[r(E,null,{default:f(()=>[r(D,{command:"logout"},{default:f(()=>[k(T(l.$t("header.logout")),1)]),_:1})]),_:1})]),default:f(()=>{var b,y;return[m("span",Fi,[m("span",vi,[m("img",{src:(b=i(a))==null?void 0:b.avatarUrl,alt:(y=i(a))==null?void 0:y.owner},null,8,bi)])])]}),_:1})):C("",!0)])])])}}});var Ii=H(Di,[["__scopeId","data-v-1f5f4d49"]]);const Ci=[{name:"nav.config",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"nav.upload",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"nav.management",icon:"picture",isActive:!1,path:"/management",isShow:!0},{name:"nav.settings",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"nav.toolbox",icon:"files",isActive:!1,path:"/toolbox",isShow:!0},{name:"nav.feedback",icon:"chat-dot-round",isActive:!1,path:"/feedback",isShow:!0}];const yi={class:"nav"},Ai={class:"nav-list"},wi=["onClick"],Si={class:"nav-content"},ki={class:"nav-name"},Bi={class:"nav-content"},Li={class:"nav-name"},$i={class:"quick-actions-box"},xi=G({__name:"nav-content",setup(e){const t=xe(),n=ee(),a=$(()=>n.getters.getUserConfigInfo).value,o=$(()=>n.getters.getUserSettings).value,u=$(()=>{switch(o.elementPlusSize){case J.small:return 22;case J.large:return 30;default:return 26}}),s=L(o.theme.mode===Q.dark),l=L(Ci),c=L(!1),p=E=>{const{path:d}=E;if(d==="/management"){if(a.selectedRepo===""){B.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),t.push("/config");return}if(a.selectedDir===""){B.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),t.push("/config");return}}t.push(d)},g=E=>{l.value.forEach(d=>{const F=d;return F.isActive=d.path===E||E.includes(d.path),F})},v=()=>{n.dispatch("USER_SETTINGS_PERSIST")},D=()=>{o.theme.mode===Q.dark?o.theme.mode=Q.light:o.theme.mode=Q.dark,v()};return ae(()=>t.currentRoute.value,E=>{g(E.path)}),ae(()=>a.logined,E=>{l.value.forEach(d=>{switch(d.path){case"/management":case"/settings":d.isShow=E}})},{deep:!0,immediate:!0}),bt(()=>{t.isReady().then(()=>{const E=`/${t.currentRoute.value.path.split("/")[1]}`;g(E)})}),ce(()=>{var E,d;t.isReady().then(()=>{g(t.currentRoute.value.path)}),(E=document.querySelector(".quick-actions .quick-actions-box"))==null||E.addEventListener("click",F=>{c.value=!0,F.stopPropagation()}),(d=document.querySelector(".quick-actions"))==null||d.addEventListener("click",F=>{c.value=!c.value,F.stopPropagation()}),document.addEventListener("click",()=>{c.value&&(c.value=!1)})}),(E,d)=>{const F=re,S=Y("Operation"),b=St;return _(),I("aside",yi,[m("ul",Ai,[(_(!0),I(fe,null,_e(l.value,(y,M)=>Z((_(),I("li",{class:se(["nav-item flex-center",{active:y.isActive}]),key:M,onClick:w=>p(y)},[m("div",Si,[r(F,{size:i(u)},{default:f(()=>[(_(),x(kt(y.icon)))]),_:2},1032,["size"]),m("span",ki,T(E.$t(y.name)),1)])],10,wi)),[[Ce,y.isShow]])),128))]),m("div",{class:se(["nav-item quick-actions flex-center",{active:c.value}])},[m("div",Bi,[r(F,{size:i(u)},{default:f(()=>[r(S)]),_:1},8,["size"]),m("span",Li,T(E.$t("nav.actions")),1)]),Z(m("div",$i,[r(b,{modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=y=>s.value=y),class:"mb-2","active-text":E.$t("actions.night"),onChange:D},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).watermark.enable,"onUpdate:modelValue":d[1]||(d[1]=y=>i(o).watermark.enable=y),class:"mb-2","active-text":E.$t("actions.watermark"),onChange:v},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).compress.enable,"onUpdate:modelValue":d[2]||(d[2]=y=>i(o).compress.enable=y),class:"mb-2","active-text":E.$t("actions.compress"),onChange:v},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).imageLinkFormat.enable,"onUpdate:modelValue":d[3]||(d[3]=y=>i(o).imageLinkFormat.enable=y),class:"mb-2","active-text":E.$t("actions.transform")+i(o).imageLinkFormat.selected,onChange:v},null,8,["modelValue","active-text"])],512),[[Ce,c.value]])],2)])}}});var Ri=H(xi,[["__scopeId","data-v-76eac6e8"]]);const Ti={class:"main-container"},Ui={class:"top-container"},Oi={class:"bottom-container"},Mi={class:"bottom-content"},Pi={class:"left"},Vi={class:"right"},Ni=G({__name:"main-container",setup(e){return ce(()=>{Fn()}),(t,n)=>{const a=Y("router-view");return _(),I("main",Ti,[m("div",Ui,[r(Ii)]),m("div",Oi,[m("div",Mi,[m("div",Pi,[r(Ri)]),m("div",Vi,[r(a)])])])])}}});var Gi=H(Ni,[["__scopeId","data-v-c5c7351e"]]);const zi=G({__name:"App",setup(e){const t=ee(),n=L("default"),a=o=>{o<=600?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.small}),n.value=J.small):o<=900?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.default}),n.value=J.default):(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.large}),n.value=J.large)};return ce(()=>{Fn(),a(window.innerWidth),window.addEventListener("resize",ha(o=>{a(o.target.innerWidth)},800))}),(o,u)=>(_(),x(i(Qn),{size:n.value,"z-index":3e3,locale:i(Jn)},{default:f(()=>[r(Gi)]),_:1},8,["size","locale"]))}}),ji={notLogin:"\u672A\u767B\u5F55",logout:"\u9000\u51FA\u767B\u5F55"},Hi={config:"\u56FE\u5E8A\u914D\u7F6E",upload:"\u4E0A\u4F20\u56FE\u7247",management:"\u56FE\u5E8A\u7BA1\u7406",settings:"\u6211\u7684\u8BBE\u7F6E",toolbox:"\u5DE5\u5177\u7BB1",feedback:"\u5E2E\u52A9\u53CD\u9988",actions:"\u5FEB\u6377\u64CD\u4F5C"},Xi={night:"\u6697\u591C\u6A21\u5F0F",watermark:"\u6DFB\u52A0\u6C34\u5370",compress:"\u538B\u7F29\u56FE\u7247",transform:"\u8F6C\u6362 "};var Ki={header:ji,nav:Hi,actions:Xi};const qi={notLogin:"Not Login",logout:"Logout"},Wi={config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},Yi={night:"Night Mode",compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "};var Ji={header:qi,nav:Wi,actions:Yi};const Qi=Zn({locale:"zh-CN",messages:{"zh-CN":Ki,"en-US":Ji}}),bn="custom-contextmenu-container";let j=null,mt=!1;const Zi={mounted(e,t){e.addEventListener("contextmenu",n=>{const{dir:a,type:o,img:u}=t.value;n.preventDefault(),n.stopPropagation();const s=$(()=>V.getters.getUserViewDir).value,l=a?`${s==="/"?"":`${s}/`}${a}`:s;j=document.querySelector(`.${bn}`),j||(j=document.createElement("ul"),j.setAttribute("class",bn),j.style.position="fixed",j.style.zIndex="1000",j.innerHTML='<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">\u590D\u5236\u56FE\u7247\u94FE\u63A5</li>',document.body.appendChild(j));const c=j==null?void 0:j.querySelector(".upload-image"),p=j==null?void 0:j.querySelector(".copy-link");o===ye.img?(p.style.display="block",c.innerHTML="\u4ECE\u5F53\u524D\u4F4D\u7F6E\u4E0A\u4F20\u65B0\u56FE\u7247"):(p.style.display="none",c.innerHTML=`\u4E0A\u4F20\u56FE\u7247\u5230 < ${l==="/"?"\u6839\u76EE\u5F55":l} > \u76EE\u5F55`);let g=n.clientX,v=n.clientY;const D=j.clientWidth,E=j.clientHeight,d=document.documentElement.clientWidth,F=document.documentElement.clientHeight,S=6;D+g>d&&(g=d-D-S),E+v>F&&(v=F-E-S),j.style.top=`${v}px`,j.style.left=`${g}px`,mt||(mt=!0,c==null||c.addEventListener("click",async()=>{const y=l==="/"?q.rootDir:q.repoDir,M=l==="/"?[]:l.split("/");await V.dispatch("SET_USER_CONFIG_INFO",{dirMode:y,selectedDir:l,selectedDirList:M}),await Oe.push("/upload")}),p==null||p.addEventListener("click",async()=>{const y=$(()=>V.getters.getUserConfigInfo).value,M=$(()=>V.getters.getUserSettings).value;qe(u,y,M)}));const b=()=>{j&&(document.removeEventListener("click",b),document.body.removeChild(j),j=null,mt=!1)};document.addEventListener("click",b)})}};const pt=ea(zi);pt.directive("contextmenu",Zi);for(const[e,t]of Object.entries(ta))pt.component(e,t);pt.use(Oe).use(V,Qt).use(Qi).mount("#app");
