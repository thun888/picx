var fn=Object.defineProperty,gn=Object.defineProperties;var hn=Object.getOwnPropertyDescriptors;var lt=Object.getOwnPropertySymbols;var En=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable;var rt=(e,t,n)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,be=(e,t)=>{for(var n in t||(t={}))En.call(t,n)&&rt(e,n,t[n]);if(lt)for(var n of lt(t))Fn.call(t,n)&&rt(e,n,t[n]);return e},ct=(e,t)=>gn(e,hn(t));import{a as vn,E as w,b as ve,C as Dn,e as In,d as An,c as Cn,f as bn,u as yn,g as z,h as L,i as Sn,o as m,j as k,n as De,k as i,r as H,l as b,m as c,w as _,p as oe,q as le,s as P,t as ae,v as ye,x as qe,y as Ue,z as Ye,A as dt,B as pt,D as _t,F as mt,G as Te,H as Z,I as C,J as re,K as $,L as G,M as ce,N as de,O as Ln,P as d,Q as kn,R as wn,S as $n,T as pe,U as Ie,V as Se,W as ft,X as gt,Y as ht,Z as Et,_ as Bn,$ as _e,a0 as Ft,a1 as Un,a2 as ge,a3 as he,a4 as Re,a5 as Tn,a6 as Rn,a7 as Pn,a8 as On,a9 as Je,aa as xn,ab as Mn,ac as Nn,ad as Gn,ae as vt,af as Vn,ag as zn,ah as Hn,ai as Xn,aj as Dt,ak as jn,al as It,am as Kn,an as qn,ao as Yn}from"./vendor.a8393986.js";const Jn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerpolicy&&(u.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?u.credentials="include":a.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(a){if(a.ep)return;a.ep=!0;const u=n(a);fetch(a.href,u)}};Jn();const Wn="modulepreload",At={},Zn="./",Qn=function(t,n){return!n||n.length===0?t():Promise.all(n.map(s=>{if(s=`${Zn}${s}`,s in At)return;At[s]=!0;const a=s.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${u}`))return;const o=document.createElement("link");if(o.rel=a?"stylesheet":Wn,a||(o.as="script",o.crossOrigin=""),o.href=s,document.head.appendChild(o),a)return new Promise((l,r)=>{o.addEventListener("load",l),o.addEventListener("error",r)})})).then(()=>t())},es="XPoet/picx",Pe="picx-images-hosting",ts="PicX images hosting repository",Oe="master",ns="Upload image via PicX(https://github.com/XPoet/picx)",ss="Upload images via PicX(https://github.com/XPoet/picx)",os="Delete image via PicX(https://github.com/XPoet/picx)",as="https://api.github.com",us=3e5,xe="PICX_",We=`${xe}CONFIG`,Ct=`${xe}MANAGEMENT`,bt=`${xe}SETTINGS`,yt=`${xe}UPLOADED`,is=as,Me=vn.create({baseURL:is,timeout:us});Me.defaults.headers["Content-Type"]="application/json";Me.interceptors.request.use(e=>{const t=localStorage.getItem(We);if(t){const{token:n}=JSON.parse(t);n&&(e.headers.Authorization=`token ${n}`)}return e},e=>Promise.reject(e));Me.interceptors.response.use(e=>e,e=>((e==null?void 0:e.response)||w.error({duration:6e3,message:`${e}`}),Promise.reject(e.response)));function q(e){const t={};e.method=e.method.toUpperCase();for(const n in e)n==="params"?e.method==="GET"?t.params=e.params:t.data=e.params:t[n]=e[n];return new Promise(n=>{Me.request(t).then(s=>{const{status:a,data:u}=s;n(s&&(a===200||a===201||a===204)?u||"SUCCESS":null)}).catch(s=>{if((t==null?void 0:t.success422)&&(s==null?void 0:s.status)===422)n((s==null?void 0:s.data)||"SUCCESS");else{const a=s.status,u=s.data.message;(t==null?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",s),w.error({duration:6e3,message:`Code: ${a}, Message: ${u}`})),n(null)}})})}const St=e=>q({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),ls=(e=es)=>q({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}),Lt=e=>new Promise(async t=>{const n=await q({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:1}});n&&n.length?t(n.filter(s=>!s.fork&&!s.private).map(s=>({value:s.name,label:s.name}))):t(null)}),kt=async(e,t=!0)=>{const n=`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).
        `,{owner:s,selectedRepo:a,selectedBranch:u}=e;let o=null;t&&(o=ve.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."})),await q({url:`/repos/${s}/${a}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:u,content:window.btoa(n)},noShowErrorMsg:!0})?o==null||o.close():t&&w.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")},rs=e=>q({url:"/user/repos",method:"POST",params:{name:Pe,description:ts,private:!1},headers:{Authorization:`token ${e}`},success422:!0}),Le=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),cs=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},ds=e=>{if(e==="/")return[];const t=e.split("/"),n=[];let s="";return t.forEach((a,u)=>{s+=`${u>0?"/":""}${a}`,n.unshift(s)}),n};function wt(e,t,n){var s;return e?t.length===n?e:wt((s=e.childrenDirs)==null?void 0:s.find(a=>a.dir===t[n]),t,++n):null}const Ne=(e,t)=>{if(e==="/")return t;const n=e.split("/");return wt(t,n,0)},Ge=(e,t,n)=>{var s;return n==="dir"?(s=t.childrenDirs)==null?void 0:s.filter(a=>a.type==="dir"):n==="image"?t.imageList.filter(a=>a.type==="image"):[]},ps=()=>{const e=localStorage.getItem(Ct);return e?JSON.parse(e):Le("/","/")},_s={state:{name:"dirImageListModule",dirObject:ps()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},n){if(n==="/")return;const s=(l,r,f)=>l?(l.childrenDirs.some(g=>g.dir===r)||l.childrenDirs.push(Le(r,f)),l.childrenDirs.find(g=>g.dir===r)||Le(r,f)):Le(r,f),a=n.split("/");let u="",o=e.dirObject;for(let l=0,r=a.length;l<r;l++){const f=a[l];u+=`${l>0?"/":""}${f}`,o=s(o,f,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",f)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},n){if(n==="/")return;const s=(o,l,r)=>{if(l==="/")return e.dirObject;const f=o.childrenDirs.find(h=>h.dir===l);if(!f)return o;if(r){const h=o.childrenDirs.findIndex(g=>g.dir===l);h!==-1&&o.childrenDirs.splice(h,1)}return f},a=n.split("/");let u=e.dirObject;a.forEach((o,l)=>{u=s(u,o,l===a.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",o)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},n){const s=(u,o,l,r,f=!1)=>{var g;if(!u)return e.dirObject;let h=(g=u.childrenDirs)==null?void 0:g.find(p=>p.dir===o);return h||(h={type:"dir",dir:o,dirPath:l,childrenDirs:[],imageList:[]},u.childrenDirs.push(h)),f&&!h.imageList.some(p=>p.name===r.name)&&h.imageList.push(r),h};let a=e.dirObject;if(n.dir==="/")a.imageList.some(u=>u.name===n.name)||a.imageList.push(n);else{const u=n.dir.split("/");let o="";u.forEach((l,r)=>{o+=`${r>0?"/":""}${l}`,a=s(a,l,o,n,r===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},n){const s=(f,h)=>{if(f.length){const g=f.findIndex(p=>p.uuid===h);g!==-1&&f.splice(g,1)}},a=(f,h,g,p)=>{if(!f)return e.dirObject;const v=f.childrenDirs.find(E=>E.dir===h);return v?(v.dir===h&&p&&s(v.imageList,g.uuid),v):e.dirObject},{dir:u,uuid:o}=n;if(u==="/"){s(e.dirObject.imageList,o),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let r=e.dirObject;l.forEach((f,h)=>{r=a(r,f,n,h===l.length-1),!r.imageList.length&&!r.childrenDirs.length&&ds(r.dirPath).forEach(p=>{const v=Ne(p,e.dirObject);if(v&&!v.imageList.length&&!v.childrenDirs.length){const{dirPath:E}=cs(p);t("SET_USER_CONFIG_INFO",{viewDir:E}),t("DIR_IMAGE_LIST_REMOVE_DIR",p)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},n){let s=e.dirObject;if(n==="/"){s.imageList=[],s.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const a=(o,l,r)=>{var h;if(!o)return e.dirObject;const f=(h=o.childrenDirs)==null?void 0:h.find(g=>g.dir===l);return f?(r&&(f.imageList=[],f.childrenDirs=[]),f):e.dirObject},u=n.split("/");u.forEach((o,l)=>{s=a(s,o,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(Ct,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Le("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}},ms={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:n}){e.curImgUuid=t,e.curImgBase64Url=n},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const n=e.list.findIndex(s=>s.uuid===t);if(n!==-1&&e.list.splice(n,1),e.list.length===0)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const s=e.list[0];e.curImgBase64Url=s.imgData.base64Url,e.curImgUuid=s.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter(n=>n.uploadStatus.progress!==100);t.length>0&&(t.forEach(n=>{n.uploadStatus.uploading=!1}),e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImages:e=>e}},fs=()=>{const e=sessionStorage.getItem(yt);return e?JSON.parse(e):[]},gs={state:{uploadedImageList:fs()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},n){e.uploadedImageList.unshift(n),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},n){if(e.uploadedImageList.length>0){const s=e.uploadedImageList.findIndex(a=>a.uuid===n);s!==-1&&(e.uploadedImageList.splice(s,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem(yt,JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e,dispatch:t}){e.uploadedImageList=[],t("UPLOADED_LIST_PERSIST")}},getters:{getUploadedImageList:e=>e.uploadedImageList}};var me;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(me||(me={}));var fe;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(fe||(fe={}));var Ve;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(Ve||(Ve={}));var ne;(function(e){e.newBranch="newBranch",e.repoBranch="repoBranch"})(ne||(ne={}));var K;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.repoDir="repoDir"})(K||(K={}));const $t=5,Bt=30;var J;(function(e){e.large="large",e.default="default",e.small="small"})(J||(J={}));var Ae;(function(e){e[e.parentDir=0]="parentDir",e[e.childDir=1]="childDir",e[e.img=2]="img"})(Ae||(Ae={}));const Ut=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},Ee=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),hs=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Tt=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{t&&t()})},Rt=e=>{for(const t in e)switch(Ut(e[t])){case"object":Rt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},Ze=(e,t)=>{for(const n in t)Ut(t[n])!=="object"?e&&(e[n]=t[n]):Ze(e[n],t[n])},Es=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},ze=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function n(u){return`00${u}`.substr(u.length)}const s=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${s.getFullYear()}`.substr(4-RegExp.$1.length)));const a={"M+":s.getMonth()+1,"d+":s.getDate(),"h+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds()};for(const u in a)if(new RegExp(`(${u})`).test(e)){const o=`${a[u]}`;e=e.replace(RegExp.$1,RegExp.$1.length===1?o:n(o))}return e},Fs=(e,t=500)=>{let n,s;function a(...u){s=u,n||(n=setTimeout(()=>{e(...s),n=void 0},t))}return a},vs=()=>ve.service({target:".upload-area",text:"\u6B63\u5728\u538B\u7F29\u56FE\u7247..."}),Ds=async(e,t)=>new Dn(e,{encoderState:{type:t,options:In[t].meta.defaultOptions},processorState:An,preprocessorState:Cn}).process(),Qe=(e,t,n)=>{var u;const s=n.imageLinkType.selected,a=(u=n.imageLinkType.presetList.find(o=>o.name===s))==null?void 0:u.rule;if(a){const{owner:o,selectedRepo:l,selectedBranch:r}=t;return a.replaceAll("{{owner}}",o).replaceAll("{{repo}}",l).replaceAll("{{branch}}",r).replaceAll("{{path}}",e.path)}return null},Pt=(e,t,n)=>{var s;if(n.enableImageLinkFormat){const a=n.imageLinkFormat.selected,u=(s=n.imageLinkFormat.presetList.find(o=>o.name===a))==null?void 0:s.format;if(u)return u.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},et=(e,t,n,s=!1)=>{const a=Pt(Qe(e,t,n),e.name,n);a?Tt(a,()=>{s?w.success({message:"\u56FE\u7247\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u7CFB\u7EDF\u526A\u8D34\u677F",duration:6e3}):w.success(`${n.imageLinkType.selected} \u56FE\u7247\u94FE\u63A5\u590D\u5236\u6210\u529F`)}):w.error("\u590D\u5236\u5931\u8D25")},Ot=(e,t,n,s=!1)=>{if((e==null?void 0:e.length)>0){let a="";e.forEach((u,o)=>{a+=`${Pt(Qe(u,t,n),u.name,n)}${o<e.length-1?`
`:""}`}),Tt(a,()=>{s?w.success({message:`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5\u5230\u7CFB\u7EDF\u526A\u8D34\u677F`,duration:6e3}):w.success(`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5`)})}else console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},xt=()=>({uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",prefixName:"",final:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1,isPrefix:!1},reUploadInfo:{path:"",dir:"",isReUpload:!1}}),Is=(e,t)=>({type:"image",uuid:Ee(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});async function As(e,t){e.deleting=!0;const{owner:n,selectedRepo:s}=t,{path:a,sha:u}=e;return new Promise(async o=>{const l=await jt(n,s,a,u);e.deleting=!1,l?(o(!0),await M.dispatch("UPLOADED_LIST_REMOVE",e.uuid),await M.dispatch("DIR_IMAGE_LIST_REMOVE",e)):o(!1)})}const ke=(e,t=!1)=>{e.forEach(n=>{n.deleting=t})};async function Cs(e,t){ke(e,!0);const{owner:n,selectedRepo:s,selectedBranch:a}=t,u=await Ht(n,s,a);if(!u)throw ke(e,!1),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const o=await Kt(n,s,e.map(f=>({path:f.path,sha:null})),u);if(!o)throw ke(e,!1),new Error("\u521B\u5EFA tree \u5931\u8D25");const l=await qt(n,s,o,u);if(!l)throw ke(e,!1),new Error("\u521B\u5EFA commit \u5931\u8D25");if(!await Yt(n,s,a,l.sha))throw ke(e,!1),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(f=>{f.deleting=!1,M.dispatch("UPLOADED_LIST_REMOVE",f.uuid),M.dispatch("DIR_IMAGE_LIST_REMOVE",f)})}async function bs(e,t){if(e.length===1)return await As(e[0],t)?fe.deleted:fe.deleteFail;try{return await Cs(e,t),fe.allDeleted}catch(n){return console.error(n),fe.deleteFail}}function ys(e,t){const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;return a.crossOrigin="Anonymous",a.src=e,new Promise(u=>{a.onload=()=>{const{width:o}=a,{height:l}=a;n.width=o,n.height=l,s==null||s.drawImage(a,0,0,o,l);const r=n.toDataURL(`image/${t}`);u(r)}})}const tt=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},Mt=e=>{const t=e.lastIndexOf(".");return e.substr(t+1,e.length)},nt=e=>/(png|jpg|gif|jpeg|webp|awebp|avif|svg\+xml|image\/x-icon)$/.test(e),He=e=>Number((e/1024).toFixed(2)),Nt=e=>({name:e?tt(e):"",hash:e?Ee():"",suffix:e?Mt(e):""}),Ss=async e=>new Promise(async t=>{e||t(null),nt(e.type)||(w.error("\u8BE5\u6587\u4EF6\u683C\u5F0F\u4E0D\u652F\u6301\u4E0A\u4F20\uFF01"),t(null));let n;const{isCompress:s,compressEncoder:a}=M.getters.getUserSettings,u=e.type==="image/gif";!u&&s&&(n=await Ds(e,a));const o=new FileReader;o.readAsDataURL(!u&&s?n:e),o.onload=l=>{var h;const r=(h=l.target)==null?void 0:h.result;He(r.length)>=Bt*1024?(w.error(`\u8BE5\u56FE\u7247\u8D85\u8FC7 ${Bt} MB\uFF0C\u4E0D\u5141\u8BB8\u4E0A\u4F20\uFF01`),t(null)):t({base64:r,originalFile:e,compressFile:!u&&s?n:e})}}),Gt=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:ne.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:K.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(We);return t&&(Ze(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===K.autoDir&&(e.selectedDir=ze("yyyyMMdd"))),e},Ls=e=>{const{selectedDir:t,selectedBranch:n,dirMode:s}=e.userConfigInfo;if(s==="newDir"){const a=t.split("");let u=0,o="";const l=[" ",".","\u3001",",","\uFF0C","!","\uFF1F","?"];for(let r=0;r<a.length&&(l.some(f=>f===a[r])&&(a[r]="-"),a[r]==="/"&&(u+=1),!(u>=$t));r++)o+=a[r];e.userConfigInfo.selectedDir=o}e.userConfigInfo.selectedBranch=n.replace(/\s+/g,"-")},ks={state:{userConfigInfo:Gt()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Gt()},SET_USER_CONFIG_INFO({state:e,dispatch:t},n){for(const s in n)e.userConfigInfo.hasOwnProperty(s)&&(e.userConfigInfo[s]=n[s]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},n){e.userConfigInfo.dirList.some(s=>s.value===n)||(e.userConfigInfo.dirList.push({label:n,value:n}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},n){const{dirList:s}=e.userConfigInfo;if(s.some(a=>a.value===n)){const a=s.findIndex(u=>u.value===n);s.splice(a,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){Ls(e),localStorage.setItem(We,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Rt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},ws={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:n,checked:s}=t;s&&e.imgCardArr.forEach(a=>{a.uuid===n&&(a.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},$s={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},st={defaultHash:!0,enableImageLinkFormat:!1,defaultPrefix:!1,prefixName:"",isCompress:!0,compressEncoder:Ve.webP,themeMode:"light",autoLightThemeTime:["08:00","19:00"],elementPlusSize:J.default,imageLinkType:{selected:"Staticaly",presetList:[{id:Ee(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Ee(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Ee(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Ee(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'}]},starred:!1},Bs=()=>{const e=hs(bt);return e&&Ze(st,e),st},Us={state:{userSettings:Bs()},actions:{SET_USER_SETTINGS({state:e},t){for(const n in t)e.userSettings.hasOwnProperty(n)&&(e.userSettings[n]=t[n])},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){e.userSettings.imageLinkType.presetList.some(a=>a.name===n.name)?w.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u89C4\u5219\u5DF2\u5B58\u5728\uFF01"):n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")?(e.userSettings.imageLinkType.presetList.push(n),t("USER_SETTINGS_PERSIST")):w.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){if(n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")){const s=e.userSettings.imageLinkType.presetList.find(a=>a.id===n.id);s&&(s.rule=n.rule,t("USER_SETTINGS_PERSIST"))}else w.error("\u4FEE\u6539\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){const s=e.userSettings.imageLinkType.presetList;s.splice(s.findIndex(a=>a.id===n),1),t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(bt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=st}},getters:{getUserSettings:e=>e.userSettings}},M=bn({modules:{dirImageListModule:_s,toUploadImageModule:ms,uploadedImageListModule:gs,userConfigInfoModule:ks,imageCardModule:ws,uploadAreaActiveModule:$s,userSettingsModule:Us},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("USER_SETTINGS_LOGOUT"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),Vt=Symbol("vuex-store");function W(){return yn(Vt)}const zt=(e,t="")=>{const{owner:n,selectedRepo:s,selectedBranch:a}=e;return new Promise(async u=>{const o=await q({url:`/repos/${n}/${s}/contents/${t}`,method:"GET",params:{ref:a}});o&&o.length?u(o.filter(l=>l.type==="dir").map(l=>({value:l.name,label:l.name}))):u(null)})},Xe=(e,t="")=>{const{owner:n,selectedRepo:s,selectedBranch:a}=e;return new Promise(async u=>{const o=await q({url:`/repos/${n}/${s}/contents/${t}`,method:"GET",params:{ref:a}});o&&o.length?(o.filter(l=>l.type==="dir").forEach(l=>M.dispatch("DIR_IMAGE_LIST_ADD_DIR",l.path)),setTimeout(()=>{o.filter(l=>l.type==="file"&&nt(Mt(l.name))).forEach(l=>{M.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Is(l,t))})},120),u(!0)):u(null)})},Ht=(e,t,n)=>q({url:`/repos/${e}/${t}/branches/${n}`,method:"GET"}),Xt=(e,t)=>new Promise(async n=>{const s=await q({url:`/repos/${e}/${t}/branches`,method:"GET"});s&&s.length?n(s.filter(a=>!a.protected).map(a=>({value:a.name,label:a.name})).reverse()):n(null)}),Ts=async(e,t,n)=>{const{owner:s,selectedRepo:a,branchList:u}=e,o=ve.service({text:`\u6B63\u5728\u65B0\u5EFA ${t} \u5206\u652F...`});try{let l="";const r=await q({url:`/repos/${s}/${a}/git/refs/heads/${u[0].value}`,method:"GET"});if(r&&(l=r.object.sha),!l){o.close(),w.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}let f="";const h=await q({url:`/repos/${s}/${a}/git/refs`,method:"POST",params:{ref:`refs/heads/${t}`,sha:l}});if(h&&(f=h.object.sha),!f){o.close(),w.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}await q({url:`/repos/${s}/${a}/git/refs/heads/${t}`,method:"PATCH",params:{force:!0,sha:f}})&&n()}catch(l){console.error(l)}},jt=(e,t,n,s)=>q({url:`/repos/${e}/${t}/contents/${n}`,method:"DELETE",data:{owner:e,repo:t,path:n,message:os,sha:s}}),Rs=(e,t)=>q({url:e,method:"PUT",data:t}),Ps=(e,t,n)=>q({url:`/repos/${t}/${n}/git/blobs`,method:"POST",params:{owner:t,repo:n,content:e.imgData.base64Content,encoding:"base64"}}),Kt=(e,t,n,s)=>{var a,u,o;return q({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:n.map(l=>({path:l.path,mode:"100644",type:"blob",sha:l.sha})),base_tree:((o=(u=(a=s==null?void 0:s.commit)==null?void 0:a.commit)==null?void 0:u.tree)==null?void 0:o.sha)||null}})},qt=(e,t,n,s)=>q({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:n.sha,parents:[s.commit.sha],message:ss}}),Yt=(e,t,n,s)=>q({url:`/repos/${e}/${t}/git/refs/heads/${n}`,method:"PATCH",params:{sha:s}}),Jt=z({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:J.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!0}},setup(e){const t=W(),n=L(()=>t.getters.getUserConfigInfo).value,s={lazy:!0,checkStrictly:!0,async lazyLoad(u,o){const{level:l,pathLabels:r}=u;let f;l===0?f=n.dirList:f=await zt(n,r.join("/")),o(f?f.map(h=>({value:h.value,label:h.label,leaf:l>=$t-1})):[])}},a=u=>{n.selectedDirList=u,n.selectedDir=u.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,o)=>{const l=Sn;return m(),k(l,{style:De({width:e.elWidth}),size:e.elSize,debounce:500,props:s,key:e.elKey,modelValue:i(n).selectedDirList,"onUpdate:modelValue":o[0]||(o[0]=r=>i(n).selectedDirList=r),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:e.elClearable,onChange:a},null,8,["style","size","modelValue","clearable"])}}});var Y=(e,t)=>{const n=e.__vccOpts||e;for(const[s,a]of t)n[s]=a;return n};const Os=z({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:""}},setup(e){const t=e,n=W(),s=L(()=>n.getters.getUserConfigInfo).value,a=L(()=>t.dataType==="repo"?"\u4ED3\u5E93":"\u5206\u652F"),u=async()=>{const o=ve.service({lock:!0,text:`\u6B63\u5728\u52A0\u8F7D ${a.value} \u6570\u636E ...`}),{owner:l,selectedRepo:r}=s;if(t.dataType==="repo"){const f=await Lt(l);f&&(s.repoList=f)}else if(t.dataType==="branch"){const f=await Xt(l,r);f&&(s.branchList=f)}o.close(),await n.dispatch("USER_CONFIG_INFO_PERSIST")};return(o,l)=>{const r=H("Refresh"),f=oe,h=le;return m(),b("div",{class:"refresh-config-box",style:De({width:e.boxWidth+"rem"})},[c(h,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(a)+" \u6570\u636E"},{default:_(()=>[c(f,{class:"icon",onClick:u},{default:_(()=>[c(r)]),_:1})]),_:1},8,["content"])],4)}}});var xs=Y(Os,[["__scopeId","data-v-63d47920"]]);const V=L(()=>M.getters.getUserConfigInfo).value,Ms=()=>{M.dispatch("LOGOUT")},ue=()=>{M.dispatch("USER_CONFIG_INFO_PERSIST")};function Wt(e){V.logined=!0,V.owner=e.login,V.name=e.name,V.email=e.email,V.avatarUrl=e.avatar_url,ue()}const Ns=()=>{V.selectedRepo="",V.repoList=[],V.selectedBranch="",V.branchMode=ne.repoBranch,V.branchList=[],V.selectedDir="",V.dirMode=K.repoDir,V.dirList=[]},Gs=async()=>{const{selectedDir:e,dirMode:t}=V;let n="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(e===""){switch(t){case K.newDir:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case K.repoDir:n=`\u8BF7\u9009\u62E9 ${V.selectedRepo} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}w.warning(n)}else await we.push("/upload")},Vs=async()=>{const{token:e}=V;if(!e){w.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}const t=ve.service({lock:!0,text:"\u6B63\u5728\u81EA\u52A8\u914D\u7F6E..."}),n=await St(V.token);if(console.log("getGitHubUserInfo >> ",n),!n){t.close(),w.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}Wt(n);const s=await rs(V.token);if(console.log("createRepo >> ",s),!s){t.close(),w.error("\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01");return}V.repoList=[{value:Pe,label:Pe}],V.selectedRepo=Pe,V.branchList=[{value:Oe,label:Oe}],V.selectedBranch=Oe,V.branchMode=ne.repoBranch,V.selectedDir=ze("yyyyMMdd"),V.dirMode=K.autoDir,V.dirList=[],ue(),await kt(V,!1),t.close(),w.success("\u81EA\u52A8\u914D\u7F6E\u6210\u529F"),await we.push("/upload")};const zs={class:"page-container config-page-container"},Hs=z({__name:"my-config",setup(e){const t=W(),n=P(!1),s=P(!1),a=P(!1),u=P(32),o=L(()=>t.getters.getUserConfigInfo).value,l=L(()=>t.getters.getUserLoginStatus).value,r=L(()=>t.getters.getUserSettings).value,f=L(()=>!o.token||!o.owner),h=L(()=>r.elementPlusSize===J.large?"right":"top"),g=L(()=>n.value||s.value||a.value),p=P(null),v=P(null),E=P(""),S=P("repoDirCascaderKey"),U=B=>{var y;switch(B){case K.rootDir:o.selectedDir="/";break;case K.autoDir:o.selectedDir=ze("yyyyMMdd");break;case K.newDir:o.selectedDir="xxx",(y=p.value)==null||y.focus();break;case K.repoDir:const{dirList:O}=o;O.length?o.selectedDir=O[0].value:o.selectedDir="";break;default:o.selectedDir="/";break}ue()};async function I(B){const y=await Lt(B);console.log("getRepoInfoList >> ",y),n.value=!1,y?(o.repoList=y,ue()):w.error("\u4ED3\u5E93\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}async function D(){s.value=!0;const B=await zt(o);console.log("getDirInfoList >> ",B),s.value=!1,B&&(o.dirList=B),ue()}const T=B=>{var R;const y=o.selectedBranch,O=o.branchList[0].value;switch(B){case ne.newBranch:o.dirMode=K.newDir,o.selectedBranch="",o.selectedDir="",(R=v.value)==null||R.focus();break;case ne.repoBranch:y!==O&&(o.selectedBranch=O,D());break;default:o.selectedBranch="";break}ue()};async function j(B){a.value=!0;const{owner:y,dirMode:O}=o,R=await Xt(y,B);console.log("getBranchInfoList >> ",R),a.value=!1,R?(R.length>0?(o.branchList=R,o.selectedBranch=o.branchList[0].value,o.branchMode=ne.repoBranch,await D()):(o.selectedBranch=Oe,o.branchMode=ne.newBranch,await kt(o)),U(O),ue()):w.error("\u5206\u652F\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")}async function F(){if(!o.token){w.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}f.value||Ns(),n.value=!0;const B=await St(o.token);if(console.log("getGitHubUserInfo >> ",B),!B){w.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}Wt(B),await I(B.login)}function A(B){o.branchList=[],o.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),j(B),ue()}async function N(B){o.selectedBranch=B,await D(),S.value=o.selectedBranch,o.selectedDir=o.dirList[0].value,o.selectedDirList=[o.selectedDir],ue()}const Q=()=>{const B=E.value,y=o.branchList;B?y.find(O=>O.value===B)?w.warning(`${B} \u5206\u652F\u5DF2\u5B58\u5728\uFF0C\u8BF7\u5728\u5206\u652F\u5217\u8868\u4E2D\u9009\u62E9`):Ts(o,B,()=>{w.success(`\u65B0\u5EFA ${B} \u6210\u529F`),o.branchList.push({value:B,label:B})}):w.error("\u65B0\u5EFA\u5206\u652F\u4E0D\u80FD\u4E3A\u7A7A\uFF01")};return ae(()=>l,B=>{B||(n.value=!1,s.value=!1,a.value=!1)}),(B,y)=>{const O=ye,R=qe,te=Ue,ie=le,Fe=Ye,$e=dt,se=pt,it=xs,Be=_t,_n=mt,mn=Jt,je=Te;return m(),b("div",zs,[c(Fe,{"label-width":"70rem","label-position":i(h)},{default:_(()=>[c(R,{label:"Token"},{default:_(()=>[c(O,{modelValue:i(o).token,"onUpdate:modelValue":y[0]||(y[0]=x=>i(o).token=x),clearable:"",autofocus:!i(o).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),c(R,{class:"operation"},{default:_(()=>[c(ie,{placement:"top",content:"\u9009\u62E9\u73B0\u6709\u7684 GitHub \u4ED3\u5E93"},{default:_(()=>[c(te,{disabled:i(g),plain:"",type:"primary","native-type":"submit",onClick:y[1]||(y[1]=re(x=>F(),["prevent"]))},{default:_(()=>[$(G(i(f)?"":"\u91CD\u65B0")+"\u624B\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1}),c(ie,{placement:"top",content:"\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93"},{default:_(()=>[c(te,{plain:"",disabled:i(g),type:"primary",onClick:y[2]||(y[2]=re(x=>i(Vs)(),["prevent"]))},{default:_(()=>[$(G(i(f)?"":"\u91CD\u65B0")+"\u4E00\u952E\u81EA\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["label-position"]),i(o).token&&i(o).owner?Z((m(),k(Fe,{key:0,"label-width":"70rem","label-position":i(h),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F..."},{default:_(()=>[i(o).owner?(m(),k(R,{key:0,label:"\u7528\u6237\u540D"},{default:_(()=>[c(O,{modelValue:i(o).owner,"onUpdate:modelValue":y[3]||(y[3]=x=>i(o).owner=x),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(o).email?(m(),k(R,{key:1,label:"\u90AE\u7BB1"},{default:_(()=>[c(O,{modelValue:i(o).email,"onUpdate:modelValue":y[4]||(y[4]=x=>i(o).email=x),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(o).repoList.length?(m(),k(R,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:_(()=>[c(se,{modelValue:i(o).selectedRepo,"onUpdate:modelValue":y[5]||(y[5]=x=>i(o).selectedRepo=x),filterable:!0,style:De({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:A},{default:_(()=>[(m(!0),b(ce,null,de(i(o).repoList,(x,Ke)=>(m(),k($e,{key:Ke,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),c(it,{"box-width":u.value,"data-type":"repo"},null,8,["box-width"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[je,n.value]]):C("",!0),i(o).token&&i(o).selectedRepo&&i(o).branchList.length?Z((m(),k(Fe,{key:1,"label-width":"70rem","label-position":i(h),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u5206\u652F\u4FE1\u606F..."},{default:_(()=>[(i(o).selectedRepo,C("",!0)),i(o).branchList.length&&i(o).branchMode===i(ne).repoBranch?(m(),k(R,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:_(()=>[c(se,{modelValue:i(o).selectedBranch,"onUpdate:modelValue":y[7]||(y[7]=x=>i(o).selectedBranch=x),filterable:!0,style:De({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:N},{default:_(()=>[(m(!0),b(ce,null,de(i(o).branchList,(x,Ke)=>(m(),k($e,{key:Ke,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),c(it,{"box-width":u.value,"data-type":"branch"},null,8,["box-width"])]),_:1})):C("",!0),i(o).branchMode===i(ne).newBranch?(m(),k(R,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:_(()=>[c(O,{modelValue:E.value,"onUpdate:modelValue":y[8]||(y[8]=x=>E.value=x),onBlur:Q,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F...",ref_key:"newBranchInputRef",ref:v},null,8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[je,a.value]]):C("",!0),i(o).token&&i(o).selectedBranch?Z((m(),k(Fe,{key:2,"label-width":"70rem","label-position":i(h),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u76EE\u5F55\u4FE1\u606F..."},{default:_(()=>[i(o).selectedBranch?(m(),k(R,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:_(()=>[c(_n,{modelValue:i(o).dirMode,"onUpdate:modelValue":y[9]||(y[9]=x=>i(o).dirMode=x),onChange:U},{default:_(()=>[c(ie,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[c(Be,{label:"newDir"},{default:_(()=>[$("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),c(ie,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+i(o).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:_(()=>[c(Be,{label:"rootDir"},{default:_(()=>[$("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),c(ie,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[c(Be,{label:"autoDir"},{default:_(()=>[$("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),i(o).dirList.length&&i(o).branchMode!=="newBranch"?(m(),k(ie,{key:0,content:"\u9009\u62E9 "+i(o).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[c(Be,{label:"repoDir"},{default:_(()=>[$(" \u9009\u62E9 "+G(i(o).selectedRepo)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):C("",!0)]),_:1},8,["modelValue"])]),_:1})):C("",!0),i(o).dirMode==="autoDir"?(m(),k(R,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:_(()=>[c(O,{modelValue:i(o).selectedDir,"onUpdate:modelValue":y[10]||(y[10]=x=>i(o).selectedDir=x),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(o).dirMode==="rootDir"?(m(),k(R,{key:2,label:"\u6839\u76EE\u5F55"},{default:_(()=>[c(O,{modelValue:i(o).selectedDir,"onUpdate:modelValue":y[11]||(y[11]=x=>i(o).selectedDir=x),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(o).dirMode==="newDir"?(m(),k(R,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:_(()=>[c(O,{ref_key:"newDirInputRef",ref:p,modelValue:i(o).selectedDir,"onUpdate:modelValue":y[12]||(y[12]=x=>i(o).selectedDir=x),onInput:y[13]||(y[13]=x=>i(ue)()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):C("",!0),i(o).dirList.length&&i(o).dirMode==="repoDir"&&i(o).branchMode!=="newBranch"?(m(),k(R,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:_(()=>[c(mn,{"el-key":S.value,"el-size":i(r).elementPlusSize},null,8,["el-key","el-size"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[je,s.value]]):C("",!0),i(o).token?(m(),k(Fe,{key:3,"label-width":"70rem","label-position":i(h)},{default:_(()=>[c(R,{class:"operation"},{default:_(()=>[i(o).owner?(m(),k(te,{key:0,plain:"",disabled:i(g),type:"warning",onClick:y[14]||(y[14]=x=>i(Ms)())},{default:_(()=>[$(" \u91CD\u7F6E ")]),_:1},8,["disabled"])):C("",!0),i(o).selectedRepo?(m(),k(te,{key:1,plain:"",disabled:i(g),type:"success",onClick:y[15]||(y[15]=x=>i(Gs)())},{default:_(()=>[$(" \u786E\u8BA4 ")]),_:1},8,["disabled"])):C("",!0)]),_:1})]),_:1},8,["label-position"])):C("",!0)])}}});var Xs=Y(Hs,[["__scopeId","data-v-650ccb2b"]]);const js={class:"copy-image-link-box"},Ks={class:"left"},qs={class:"btn-box right"},Ys=z({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,n=L(()=>M.getters.getUserSettings).value,s=L(()=>M.getters.getUserConfigInfo).value;let a=P(t.imgObj).value;const u=()=>{et(a,s,n)};return Ln(()=>{a=t.imgObj}),(o,l)=>{const r=H("InfoFilled"),f=oe,h=le;return m(),b("div",js,[d("div",Ks,[c(h,{content:"\u8BF7\u5728'\u6211\u7684\u8BBE\u7F6E'\u8FDB\u884C\u56FE\u7247\u94FE\u63A5\u76F8\u5173\u914D\u7F6E",placement:"top"},{default:_(()=>[c(f,null,{default:_(()=>[c(r)]),_:1})]),_:1})]),d("div",qs,[c(h,{content:"\u70B9\u51FB\u590D\u5236 "+i(n).imageLinkType.selected+" \u56FE\u7247\u94FE\u63A5",placement:"top"},{default:_(()=>[d("span",{class:"btn-item flex-center",onClick:u}," \u590D\u5236\u94FE\u63A5 ")]),_:1},8,["content"])])])}}});var Zt=Y(Ys,[["__scopeId","data-v-88d7032a"]]);const Qt=(e,t,n)=>{let s=n.selectedDir;t.reUploadInfo.isReUpload&&(s=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const a={checked:!1,type:"image",uuid:t.uuid,dir:s,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=a,M.dispatch("UPLOADED_LIST_ADD",a),M.dispatch("DIR_IMAGE_LIST_ADD_DIR",s),M.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",a)},Js=(e,t)=>{const{owner:n,selectedRepo:s,selectedDir:a}=e,u=t.filename.final;let o=u;return a!=="/"&&(o=`${a}/${u}`),t.reUploadInfo.isReUpload&&(o=t.reUploadInfo.path),`/repos/${n}/${s}/contents/${o}`};async function Ws(e,t){const{selectedBranch:n,selectedRepo:s,selectedDir:a,owner:u}=e,o=[];for(const p of t){p.uploadStatus.uploading=!0;const v=await Ps(p,u,s);v?(o.push(be({img:p},v)),await M.dispatch("TO_UPLOAD_IMAGE_UPLOADED",p.uuid)):(p.uploadStatus.uploading=!1,w.error(`${p.filename.final} \u4E0A\u4F20\u5931\u8D25`))}const l=await Ht(u,s,n);if(!l)return Promise.resolve(!1);const r=a==="/"?"":`${a}/`,f=await Kt(u,s,o.map(p=>({sha:p.sha,path:`${r}${p.img.filename.final}`})),l);if(!f)return Promise.resolve(!1);const h=await qt(u,s,f,l);return!h||!await Yt(u,s,n,h.sha)?Promise.resolve(!1):(o.forEach(p=>{const v=p.img.filename.final;Qt({name:v,sha:p.sha,path:`${r}${v}`,size:0},p.img,e)}),Promise.resolve(!0))}function en(e,t){const{selectedBranch:n,email:s,owner:a}=e,u={message:ns,branch:n,content:t.imgData.base64Content};return s&&(u.committer={name:a,email:s}),t.uploadStatus.uploading=!0,new Promise(async o=>{const l=await Rs(Js(e,t),u);if(console.log("uploadSingleImage >> ",l),t.uploadStatus.uploading=!1,l){const{name:r,sha:f,path:h,size:g}=l.content;Qt({name:r,sha:f,path:h,size:g},t,e),await M.dispatch("TO_UPLOAD_IMAGE_UPLOADED",t.uuid),o(!0)}else o(!1)})}const Zs={class:"image-box"},Qs={class:"info-box"},eo={class:"image-info"},to={key:1,class:"filename"},no={class:"image-operation"},so={class:"operation-box"},oo={class:"operation-left"},ao={class:"operation-right"},uo={class:"operation-btn"},io=z({__name:"image-card",props:{listing:{type:Boolean,default:!1},imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1},index:{type:Number},modelValue:{type:Number}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,s=W(),a=kn(),u=L(()=>s.getters.getUserConfigInfo).value,o=L(()=>s.getters.getUserSettings).value,l=L(()=>a.path==="/management"),r=L(()=>Qe(n.imageObj,u,o)),f=P(),h=P(!1),g=P(""),p=P(!1),v=(F,A=!1)=>{A||(F.deleting=!0);const{owner:N,selectedRepo:Q}=u,{path:B,sha:y}=F;return new Promise(async O=>{await jt(N,Q,B,y)?(w.success(`${A?"\u66F4\u65B0":"\u5220\u9664"}\u6210\u529F\uFF01`),await s.dispatch("UPLOADED_LIST_REMOVE",F.uuid),await s.dispatch("DIR_IMAGE_LIST_REMOVE",F),O(!0)):O(!1)})},E=F=>{Se.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${F.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{v(F)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},S=F=>{F.checked=!F.checked,s.commit("IMAGE_CARD",{imageObj:F})},U=async F=>{t("update:modelValue",n.index),g.value=tt(F.name),await ft(()=>{const A=setTimeout(()=>{var N;(N=f.value)==null||N.focus(),clearTimeout(A)},150)})},I=()=>{t("update:modelValue",void 0)},D=async()=>{I();const{imageObj:F}=n;if(g.value===tt(F.name)||!g.value)return;const A=async()=>{const N=ve.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),{suffix:Q}=Nt(F.name),B=Ee(),y=`${g.value}.${B}.${Q}`,O=await ys(r.value||"",Q);if(O){const R=xt();R.uuid=B,R.imgData.base64Content=O.split(",")[1],R.filename.final=y,R.reUploadImgPath=`${F.dir}/${y}`,R.reUploadInfo.isReUpload=!0,R.reUploadInfo.dir=F.dir;let te=y;F.dir!=="/"&&(te=`${F.dir}/${y}`),R.reUploadInfo.path=te,await en(u,R)?(g.value="",await v(F,!0),await s.dispatch("UPLOADED_LIST_REMOVE",F.uuid)):w.error("\u91CD\u547D\u540D\u5931\u8D25")}else w.error("\u91CD\u547D\u540D\u5931\u8D25");N.close()};Se.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${g.value} \uFF1F`,"\u63D0\u793A",{type:"warning"}).then(async()=>{await A()}).catch(()=>{console.log("\u53D6\u6D88\u56FE\u7247\u91CD\u547D\u540D")})},T=F=>{p.value=F},j=F=>{Se.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${F.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${He(F.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(F,A)=>{const N=wn,Q=ye,B=Zt,y=H("Check"),O=oe,R=H("MoreFilled"),te=gt,ie=ht,Fe=Et,$e=Te;return Z((m(),b("div",{class:pe(["image-card",{listing:e.listing,checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:A[5]||(A[5]=se=>h.value=!0),onMouseleave:A[6]||(A[6]=se=>h.value=!1)},[d("div",Zs,[c(N,{src:i(r),fit:"cover",loading:"lazy",lazy:"","data-fancybox":"gallery"},null,8,["src"])]),d("div",Qs,[d("div",eo,[g.value&&n.modelValue===n.index?(m(),k(Q,{key:0,size:"small",class:"rename-input",modelValue:g.value,"onUpdate:modelValue":A[0]||(A[0]=se=>g.value=se),onBlur:I,onKeydown:$n(re(D,["prevent"]),["enter"]),ref_key:"renameInputRef",ref:f},null,8,["modelValue","onKeydown"])):(m(),b("div",to,G(e.imageObj.name),1)),d("div",no,[c(B,{"img-obj":e.imageObj},null,8,["img-obj"])])])]),Z(d("div",so,[d("div",oo,[i(l)?(m(),b("div",{key:0,class:pe([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:A[1]||(A[1]=se=>S(e.imageObj))},[e.imageObj.checked?(m(),k(O,{key:0},{default:_(()=>[c(y)]),_:1})):C("",!0)],2)):C("",!0)]),d("div",ao,[c(Fe,{size:"default",trigger:"click",onVisibleChange:T},{dropdown:_(()=>[c(ie,null,{default:_(()=>[c(te,{onClick:A[2]||(A[2]=se=>E(e.imageObj))},{default:_(()=>[$(" \u5220\u9664 ")]),_:1}),c(te,{onClick:A[3]||(A[3]=re(se=>U(e.imageObj),["self"]))},{default:_(()=>[$(" \u91CD\u547D\u540D ")]),_:1}),c(te,{onClick:A[4]||(A[4]=se=>j(e.imageObj))},{default:_(()=>[$(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:_(()=>[d("div",uo,[c(O,null,{default:_(()=>[c(R)]),_:1})])]),_:1})])],512),[[Ie,h.value||p.value||e.imageObj.checked]])],34)),[[$e,e.imageObj.deleting]])}}});var tn=Y(io,[["__scopeId","data-v-24bf299e"]]);const lo={key:0,class:"selected-info-bar-box"},ro={class:"info-item repo"},co={key:0,class:"info-item branch"},po={class:"info-item dir"},_o=z({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=W(),n=L(()=>t.getters.getUserConfigInfo),s=L(()=>t.getters.getUserSettings);return(a,u)=>{const o=Bn,l=Jt;return i(n).selectedRepo?(m(),b("div",lo,[d("span",ro,[$(" \u4ED3\u5E93\uFF1A "),c(o,{"disable-transitions":""},{default:_(()=>[$(G(i(n).selectedRepo),1)]),_:1})]),i(n).selectedBranch?(m(),b("span",co,[$(" \u5206\u652F\uFF1A "),c(o,{"disable-transitions":""},{default:_(()=>[$(G(i(n).selectedBranch),1)]),_:1})])):C("",!0),d("span",po,[$(" \u76EE\u5F55\uFF1A "),i(n).dirMode!==i(K).repoDir||e.barType==="management"?(m(),k(o,{key:0,"disable-transitions":""},{default:_(()=>[$(G(e.barType==="management"?i(n).viewDir:i(n).selectedDir),1)]),_:1})):C("",!0),i(n).dirMode===i(K).repoDir&&e.barType==="upload"?(m(),k(l,{key:1,"el-size":i(s).elementPlusSize===i(J).large?i(J).default:i(s).elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):C("",!0)])])):C("",!0)}}});var nn=Y(_o,[["__scopeId","data-v-dc55c6ba"]]);const mo={key:0,class:"to-upload-image-list-card"},fo={class:"header"},go={key:0},ho={class:"image-uploading-info-box"},Eo={class:"left-image-box"},Fo=["src"],vo={class:"right-operation-box"},Do={class:"top"},Io={class:"image-name"},Ao={class:"image-info"},Co={key:0,class:"file-size original-file-size item"},bo={class:"last-modified item"},yo={key:0,class:"bottom rename-operation"},So={key:1,class:"bottom rename-operation"},Lo=["onClick"],ko=z({__name:"to-upload-image-card",props:{loadingAllImage:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=W(),s=L(()=>n.getters.getUserConfigInfo).value,a=L(()=>n.getters.getUserSettings).value,u=L(()=>n.getters.getToUploadImages).value,o=(g,p)=>{g?p.filename.final=`${p.filename.name}.${p.filename.hash}.${p.filename.suffix}`:p.filename.final=`${p.filename.name}.${p.filename.suffix}`},l=(g,p)=>{g?p.filename.name=`${p.filename.prefixName}${p.filename.initName}`:p.filename.name=`${p.filename.initName}`,p.filename.isHashRename?p.filename.final=`${p.filename.name}.${p.filename.hash}.${p.filename.suffix}`:p.filename.final=`${p.filename.name}.${p.filename.suffix}`},r=(g,p)=>{g?p.filename.name=p.filename.newName.trim().replace(/\s+/g,"-"):l(p.filename.isPrefix,p),p.filename.isHashRename?p.filename.final=`${p.filename.name}.${p.filename.hash}.${p.filename.suffix}`:p.filename.final=`${p.filename.name}.${p.filename.suffix}`},f=async g=>u.list.length===1?await en(g,u.list[0])?me.uploaded:me.uploadFail:await Ws(g,u.list)?me.allUploaded:me.uploadFail,h=g=>{n.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",g.uuid)};return _e(()=>{const{defaultHash:g,defaultPrefix:p,prefixName:v}=a;u.list.forEach(E=>{E.filename.isPrefix=p,E.filename.prefixName=v,l(p,E),E.filename.isHashRename=g,o(g,E)})}),t({goUploadImages:f}),(g,p)=>{const v=Ft,E=ye,S=H("Upload"),U=oe,I=H("Loading"),D=H("Check"),T=H("Delete"),j=le;return i(u).list.length||i(s).selectedRepo?(m(),b("div",mo,[d("div",fo,[d("div",null,[c(nn)]),d("div",null,[i(u).list.length?(m(),b("span",go," \u5DF2\u4E0A\u4F20\uFF1A"+G(i(u).uploadedNumber)+" / "+G(i(u).list.length),1)):C("",!0)])]),i(u).list.length?(m(),b("div",{key:0,class:pe(["body",{"no-border":i(u).list.length===1}])},[d("ul",ho,[(m(!0),b(ce,null,de(i(u).list,(F,A)=>(m(),b("li",{class:pe(["image-uploading-info-item",{disable:e.loadingAllImage}]),key:A},[d("div",Eo,[d("img",{"data-fancybox":"gallery",src:F.imgData.base64Url},null,8,Fo)]),d("div",vo,[d("div",Do,[d("div",Io,G(F.filename.final),1),d("div",Ao,[i(a).isCompress?(m(),b("span",Co,[d("del",null,G(i(He)(F.fileInfo.originSize))+"KB ",1)])):C("",!0),d("span",{class:pe(["file-size item",{compressed:i(a).isCompress}])},G(i(He)(F.fileInfo.size))+" KB ",3),d("span",bo,G(i(ze)("yyyy-MM-dd hh:mm",F.fileInfo.lastModified)),1)])]),!F.uploadStatus.uploading&&F.uploadStatus.progress!==100?(m(),b("div",yo,[c(v,{label:"\u54C8\u5E0C\u5316",modelValue:F.filename.isHashRename,"onUpdate:modelValue":N=>F.filename.isHashRename=N,onChange:N=>o(N,F)},null,8,["modelValue","onUpdate:modelValue","onChange"]),c(v,{label:"\u91CD\u547D\u540D",modelValue:F.filename.isRename,"onUpdate:modelValue":N=>F.filename.isRename=N,onChange:N=>r(N,F)},null,8,["modelValue","onUpdate:modelValue","onChange"]),F.filename.isRename?(m(),k(E,{key:0,class:"rename-input",size:"small",modelValue:F.filename.newName,"onUpdate:modelValue":N=>F.filename.newName=N,onInput:N=>r(N,F),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):C("",!0),!F.filename.isRename&&i(a).defaultPrefix&&i(a).prefixName?(m(),k(v,{key:1,label:"\u547D\u540D\u524D\u7F00",modelValue:F.filename.isPrefix,"onUpdate:modelValue":N=>F.filename.isPrefix=N,onChange:N=>g.prefixName(N,F)},null,8,["modelValue","onUpdate:modelValue","onChange"])):C("",!0)])):C("",!0),!F.uploadStatus.uploading&&F.uploadStatus.progress===100?(m(),b("div",So,[c(Zt,{"img-obj":F.uploadedImg},null,8,["img-obj"])])):C("",!0)]),d("div",{class:pe(["upload-status-box",{"wait-upload":!F.uploadStatus.uploading&&F.uploadStatus.progress!==100,uploading:F.uploadStatus.uploading&&F.uploadStatus.progress!==100,uploaded:!F.uploadStatus.uploading&&F.uploadStatus.progress===100}])},[!F.uploadStatus.uploading&&F.uploadStatus.progress!==100?(m(),k(U,{key:0},{default:_(()=>[c(S)]),_:1})):C("",!0),F.uploadStatus.uploading&&F.uploadStatus.progress!==100?(m(),k(U,{key:1,class:"is-loading"},{default:_(()=>[c(I)]),_:1})):C("",!0),!F.uploadStatus.uploading&&F.uploadStatus.progress===100?(m(),k(U,{key:2},{default:_(()=>[c(D)]),_:1})):C("",!0)],2),F.uploadStatus.progress!==100&&!F.uploadStatus.uploading?(m(),b("div",{key:0,class:"remove-to-upload-image",onClick:N=>h(F)},[c(j,{effect:"dark",content:"\u79FB\u9664",placement:"top"},{default:_(()=>[c(U,null,{default:_(()=>[c(T)]),_:1})]),_:1})],8,Lo)):C("",!0)],2))),128))])],2)):C("",!0)])):C("",!0)}}});const wo=e=>(ge("data-v-8cc65974"),e=e(),he(),e),$o=["onDrop","onPaste"],Bo={key:0,for:"img-file-selecter",class:"active-upload"},Uo={key:1,class:"upload-area-tips"},To=wo(()=>d("div",{class:"text"},"\u62D6\u62FD / \u7C98\u8D34 / \u70B9\u51FB\u6B64\u5904\u9009\u62E9\u56FE\u7247",-1)),Ro=["src"],Po=z({__name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(e){const t=W(),n=L(()=>t.getters.getUserSettings).value,s=L(()=>t.getters.getUploadAreaActive),a=L(()=>t.getters.getToUploadImages).value,u=(h,g,p)=>{a.list.length===a.uploadedNumber&&a.list.length>0&&a.uploadedNumber>0&&(t.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),t.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const{defaultHash:v,isCompress:E,defaultPrefix:S,prefixName:U}=n,I=E?p:g,D=xt();D.imgData.base64Url=h,D.imgData.base64Content=h.split(",")[1];const{name:T,hash:j,suffix:F}=Nt(I==null?void 0:I.name);D.uuid=j,D.fileInfo.compressedSize=p==null?void 0:p.size,D.fileInfo.originSize=g.size,D.fileInfo.size=I==null?void 0:I.size,D.fileInfo.lastModified=I==null?void 0:I.lastModified,D.filename.initName=T,D.filename.name=S?`${U}${T}`:T,D.filename.prefixName=U,D.filename.hash=j,D.filename.suffix=F,D.filename.final=v?`${D.filename.name}.${j}.${F}`:`${D.filename.name}.${F}`,D.filename.isHashRename=v,D.filename.isPrefix=S,t.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(D))),t.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:j,base64Url:h})},o=async h=>{t.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);const{isCompress:g}=n;let p=null;g&&(p=vs());for(const v of h){const E=await Ss(v);E&&u(E.base64,E.originalFile,E.compressFile)}g&&p&&p.close()},l=async h=>{await o(h.target.files)},r=async h=>{await o(h.dataTransfer.files)},f=async h=>{const g=Array.from(h.clipboardData.items).filter(p=>p.kind==="file"&&nt(p.type)).map(p=>p.getAsFile());await o(g)};return _e(()=>{window.addEventListener("paste",f)}),Un(()=>{window.removeEventListener("paste",f)}),(h,g)=>{const p=H("UploadFilled"),v=oe,E=Te;return Z((m(),b("div",{class:pe(["upload-area active-upload",{focus:i(s)}]),onDragover:g[0]||(g[0]=re(()=>{},["prevent"])),onDrop:re(r,["stop","prevent"]),onPaste:re(f,["stop"]),"element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[i(s)?(m(),b("label",Bo)):C("",!0),d("input",{id:"img-file-selecter",type:"file",onChange:l,multiple:"multiple"},null,32),i(a).curImgBase64Url?C("",!0):(m(),b("div",Uo,[c(v,{class:"icon"},{default:_(()=>[c(p)]),_:1}),To])),i(a).curImgBase64Url?(m(),b("img",{key:2,class:"preview-img",src:i(a).curImgBase64Url},null,8,Ro)):C("",!0)],42,$o)),[[E,e.imageLoading]])}}});var Oo=Y(Po,[["__scopeId","data-v-8cc65974"]]);const sn=async e=>{const{starred:t}=e;t||await ls()&&await M.dispatch("SET_USER_SETTINGS",{starred:!0})};const xo={class:"upload-page-container"},Mo={key:0,class:"upload-page-left page-container",style:{width:"280rem"}},No={class:"upload-page-right page-container"},Go={class:"row-item"},Vo={class:"content-box"},zo={class:"row-item"},Ho={class:"content-box"},Xo={key:0,class:"row-item"},jo={class:"content-box",style:{"text-align":"right"}},Ko={class:"shortcut-key"},qo={class:"shortcut-key"},Yo=z({__name:"upload-image",setup(e){const t=W(),n=Re(),s=P(null),a=P(null),u=L(()=>t.getters.getUserConfigInfo).value,o=L(()=>t.getters.getUserSettings).value,l=L(()=>t.getters.getToUploadImages).value,r=L(()=>t.getters.getUserLoginStatus),f=L(()=>t.getters.getUploadedImageList),h=P(!1),g=L(()=>Es()==="mac"?"Command":"Ctrl"),p=()=>{var I;const{token:E,selectedRepo:S,selectedDir:U}=u;if(!E){w.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E\uFF01"),n.push("/config");return}if(!S){w.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),n.push("/config");return}if(!U){w.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),n.push("/config");return}if(l.list.length===0){w.error("\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}if(l.list.length===l.uploadedNumber){w.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247\uFF01");return}h.value=!0,(I=s==null?void 0:s.value)==null||I.goUploadImages(u).then(D=>{switch(h.value=!1,D){case me.uploaded:t.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL"),w.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F"),et(l.list[0].uploadedImg,u,o,!0),sn(o);break;case me.allUploaded:t.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL"),w.success("\u56FE\u7247\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),Ot(l.list.map(T=>T.uploadedImg),u,o,!0),sn(o);break;case me.uploadFail:t.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL"),w.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF01")}})},v=()=>{h.value=!1,t.dispatch("TO_UPLOAD_IMAGE_LOGOUT"),t.dispatch("UPLOADED_LIST_LOGOUT")};return ae(()=>r,E=>{!E&&v()}),_e(()=>{document.addEventListener("keydown",E=>{const S=E.keyCode||E.which||E.charCode,U=E.ctrlKey||E.metaKey;U&&S===65&&l.list.length&&(v(),E.preventDefault()),U&&S===83&&(h.value||(p(),E.preventDefault()))})}),(E,S)=>{const U=tn,I=Ue;return m(),b("div",xo,[i(f).length&&i(o).elementPlusSize===i(J).large?(m(),b("div",Mo,[(m(!0),b(ce,null,de(i(f),(D,T)=>(m(),b("div",{class:"uploaded-item",key:T},[c(U,{"image-obj":D,"is-uploaded":!0},null,8,["image-obj"])]))),128))])):C("",!0),d("div",No,[d("div",Go,[d("div",Vo,[c(Oo,{"image-loading":h.value,ref_key:"uploadAreaRef",ref:a},null,8,["image-loading"])])]),d("div",zo,[d("div",Ho,[c(ko,{ref_key:"toUploadImageCardRef",ref:s,"loading-all-image":h.value},null,8,["loading-all-image"])])]),i(l).list.length?(m(),b("div",Xo,[d("div",jo,[c(I,{disabled:h.value,plain:"",type:"warning",onClick:v},{default:_(()=>[$(" \u91CD\u7F6E "),d("span",Ko,G(i(g))+" + A",1)]),_:1},8,["disabled"]),c(I,{loading:h.value,plain:"",type:"primary",onClick:p},{default:_(()=>[$(" \u4E0A\u4F20 "),d("span",qo,G(i(g))+" + S",1)]),_:1},8,["loading"])])])):C("",!0)])])}}});const on=e=>(ge("data-v-fba37bd4"),e=e(),he(),e),Jo=on(()=>d("div",{class:"icon"},[d("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[d("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),d("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),Wo={key:1,class:"text"},Zo={key:2,class:"icon"},Qo=on(()=>d("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[d("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),ea=[Qo],ta={key:3,class:"text"},na=z({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,n=W(),s=L(()=>n.getters.getUserConfigInfo).value,a=()=>{const{folderObj:u,mode:o}=t;if(o==="back"){const l=s.viewDir;if(l==="/")return;const r=l.split("/");r.length===1?s.viewDir="/":r.length>1&&(r.length-=1,s.viewDir=r.join("/"))}o==="dir"&&(s.viewDir=u.dirPath),n.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,o)=>{const l=le;return m(),b("div",{class:"folder-card",onDblclick:a},[e.mode==="dir"?(m(),k(l,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:_(()=>[Jo]),_:1})):C("",!0),e.mode==="dir"?(m(),b("div",Wo,G(e.folderObj.dir),1)):C("",!0),e.mode==="back"?(m(),b("div",Zo,ea)):C("",!0),e.mode==="back"?(m(),b("div",ta,"\u53CC\u51FB\u540E\u9000")):C("",!0)],32)}}});var an=Y(na,[["__scopeId","data-v-fba37bd4"]]);const sa={key:0,class:"selector-wrapper"},oa={class:"selector-left-box"},aa={class:"item"},ua={class:"selector-right-box"},ia=z({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e,{emit:t}){const n=e,s=W(),a=P(!1),u=L(()=>s.getters.getImageCardCheckedArr),o=L(()=>s.getters.getUserConfigInfo).value,l=L(()=>s.getters.getUserSettings).value,r=L(()=>u.value.length||0);ae(()=>r.value,v=>{const E=n.currentDirImageList.length;a.value=v===E});const f=()=>{Ot(u.value,o,l)},h=()=>{n.currentDirImageList.forEach(v=>{v.checked&&(v.checked=!1)})},g=()=>{var v,E;((v=u.value)==null?void 0:v.length)>0?Se.confirm(`\u5DF2\u9009\u4E2D ${(E=u.value)==null?void 0:E.length} \u5F20\u56FE\u7247\uFF0C\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F`,"\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const S=await bs(u.value,o);S===fe.deleted&&w.success("\u5220\u9664\u6210\u529F\uFF01"),S===fe.allDeleted&&w.success("\u6279\u91CF\u5220\u9664\u6210\u529F\uFF01"),S===fe.deleteFail&&w.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF01")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):w.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},p=()=>{let v=[];n.currentDirImageList.forEach(E=>{E.checked=a.value}),v=n.currentDirImageList,s.commit("REPLACE_IMAGE_CARD",{checkedImgArr:v})};return _e(()=>{p()}),(v,E)=>{const S=Ft,U=H("CopyDocument"),I=oe,D=le,T=H("Delete");return i(r)?(m(),b("div",sa,[d("div",oa,[c(S,{label:a.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:a.value,"onUpdate:modelValue":E[0]||(E[0]=j=>a.value=j),onChange:p},null,8,["label","modelValue"]),d("div",aa,"\u5DF2\u9009\u62E9 "+G(i(r))+" \u5F20\u56FE\u7247",1),d("div",{class:"item cancel-select-btn",onClick:h},"\u53D6\u6D88\u9009\u62E9")]),d("div",ua,[c(D,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u94FE\u63A5"},{default:_(()=>[c(I,{class:"btn-icon",onClick:f},{default:_(()=>[c(U)]),_:1})]),_:1}),c(D,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:_(()=>[c(I,{class:"btn-icon",onClick:g},{default:_(()=>[c(T)]),_:1})]),_:1})])])):C("",!0)}}});var la=Y(ia,[["__scopeId","data-v-5b0d9e34"]]);const ra=e=>(ge("data-v-64588dfd"),e=e(),he(),e),ca={class:"page-container management-page-container"},da={class:"content-container"},pa={class:"top"},_a={class:"left"},ma={class:"right flex-start"},fa={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},ga={key:0,class:"image-management-item"},ha=ra(()=>d("div",{style:{width:"100%"}},null,-1)),Ea=z({__name:"imgs-management",setup(e){const t=W(),n=Re(),s=L(()=>t.getters.getUserConfigInfo).value,a=L(()=>t.getters.getUserLoginStatus).value,u=L(()=>t.getters.getDirObject).value,o=P(new Date().getTime()),l=P(!1),r=P(!1),f=P(),h=P([]),g=P([]),p=P(!1);async function v(I){l.value=!0;const D=Ne(I,u);if(D){const T=Ge(I,D,"dir"),j=Ge(I,D,"image");!T.length&&!j.length?await Xe(s,I):(h.value=T,g.value=j,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:g.value}))}else await Xe(s,I);l.value=!1}async function E(){const{selectedDir:I,viewDir:D,dirMode:T}=s;if(D===""&&((T===K.newDir||T===K.autoDir)&&!Ne(I,u)&&(s.selectedDir="/",s.dirMode="rootDir"),s.selectedDir?s.viewDir=s.selectedDir:s.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await Xe(s,s.viewDir);return}await v(s.viewDir)}function S(){r.value=!r.value}async function U(){const{viewDir:I}=s;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",I),l.value=!0,await Xe(s,I),l.value=!1}return _e(()=>{E()}),ae(()=>a,I=>{I===!1&&n.push("/config")}),ae(()=>s.viewDir,async I=>{await v(I),o.value+=1},{deep:!0}),ae(()=>u,I=>{const{viewDir:D}=s,T=Ne(D,I);T&&(h.value=Ge(D,T,"dir"),g.value=Ge(D,T,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:g.value}))},{deep:!0}),ae(()=>g.value,I=>{p.value=I.filter(D=>D.checked).length>0},{deep:!0}),(I,D)=>{const T=H("Tickets"),j=H("Menu"),F=oe,A=le,N=H("Refresh"),Q=Tn("contextmenu"),B=Te;return m(),b("div",ca,[d("div",da,[d("div",pa,[d("div",_a,[c(nn,{"bar-type":"management"})]),d("div",ma,[c(A,{placement:"top",content:r.value?"\u5207\u6362\u65B9\u5757\u5C55\u793A":"\u5207\u6362\u5217\u8868\u5C55\u793A"},{default:_(()=>[c(F,{class:"btn-icon",onClick:re(S,["stop"])},{default:_(()=>[r.value?(m(),k(T,{key:0})):C("",!0),r.value?C("",!0):(m(),k(j,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"]),c(A,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(s).viewDir+" \u76EE\u5F55\u5185\u5BB9"},{default:_(()=>[c(F,{class:"btn-icon",onClick:re(U,["stop"])},{default:_(()=>[c(N)]),_:1},8,["onClick"])]),_:1},8,["content"])])]),Z((m(),b("div",fa,[g.value.length?(m(),k(la,{currentDirImageList:g.value,"onUpdate:initImageList":g.value,key:o.value},null,8,["currentDirImageList","onUpdate:initImageList"])):C("",!0),Z((m(),b("ul",{class:"image-management-list",style:De({height:p.value?"calc(100% - 50rem)":"100%"})},[i(s).viewDir!=="/"?(m(),b("li",ga,[c(an,{mode:"back"})])):C("",!0),(m(!0),b(ce,null,de(h.value,(y,O)=>Z((m(),b("li",{class:"image-management-item",key:"folder-card-"+y.dir+"-"+O},[c(an,{"folder-obj":y},null,8,["folder-obj"])])),[[Q,{type:i(Ae).childDir,dir:y.dir}]])),128)),ha,(m(!0),b(ce,null,de(g.value,(y,O)=>Z((m(),b("li",{class:"image-management-item",key:"image-card-"+O,style:De({width:r.value?"50%":"230rem",height:r.value?"80rem":"240rem"})},[c(tn,{"image-obj":y,listing:r.value,modelValue:f.value,"onUpdate:modelValue":D[0]||(D[0]=R=>f.value=R),index:O},null,8,["image-obj","listing","modelValue","index"])],4)),[[Q,{type:i(Ae).img,img:y}]])),128))],4)),[[Q,{type:i(Ae).parentDir}]])])),[[B,l.value]])])])}}});var Fa=Y(Ea,[["__scopeId","data-v-64588dfd"]]);const va={class:"tutorials-step-1"},Da=d("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1),Ia=z({__name:"tutorials-step1",setup(e){function t(){window.open("https://github.com/new")}return(n,s)=>(m(),b("div",va,[d("h3",null,[$(" \u521B\u5EFA\u4E00\u4E2A\u7528\u6765\u5B58\u50A8\u56FE\u7247\u7684 "),d("span",{class:"go-create-repo",onClick:t}," GitHub \u4ED3\u5E93")]),Da]))}});const Aa={class:"tutorials-step-2"},Ca=d("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),ba=d("p",null,"\u7136\u540E\u70B9\u51FB Generate token \u6309\u94AE\uFF0C\u5373\u53EF\u751F\u6210\u4E00\u4E2Atoken\uFF0C\u5982\u4E0B\u56FE\uFF1A",-1),ya=d("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),Sa=d("p",{style:{color:"red"}},[d("em",null,"\u65B0\u751F\u6210\u7684 Token \u53EA\u4F1A\u663E\u793A\u4E00\u6B21\uFF0C\u8BF7\u59A5\u5584\u4FDD\u5B58\uFF01\u5982\u6709\u9057\u5931\uFF0C\u91CD\u65B0\u751F\u6210\u5373\u53EF\u3002")],-1),La=z({__name:"tutorials-step2",setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(n,s)=>(m(),b("div",Aa,[d("h3",null,[$(" \u521B\u5EFA\u4E00\u4E2A\u6709 repo \u6743\u9650\u7684 "),d("span",{class:"go-create-token",onClick:t}," GitHub Token")]),Ca,ba,ya,Sa]))}});const ka={},wa={class:"tutorials-step-3"},$a=Rn('<h3>\u8FDB\u884C\u56FE\u5E8A\u914D\u7F6E\uFF08\u7ED1\u5B9A GitHub Token\u3001\u5B58\u50A8\u56FE\u7247\u7684\u4ED3\u5E93\u548C\u76EE\u5F55\uFF09</h3><p>1\u3001\u586B\u5199 Token\uFF0C\u81EA\u52A8\u83B7\u53D6\u8BE5\u7528\u6237\u4E0B\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2\u3001\u5728\u4ED3\u5E93\u7684\u4E0B\u62C9\u5217\u8868\u4E2D\uFF0C\u9009\u62E9\u4E00\u4E2A\u4F5C\u4E3A\u56FE\u5E8A\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3\u3001\u9009\u62E9\u6216\u65B0\u5EFA\u4ED3\u5E93\u5206\u652F</p><p>4\u3001\u9009\u62E9\u4E00\u79CD\u76EE\u5F55\u65B9\u5F0F\uFF08\u76EE\u5F55\u5373\u4ED3\u5E93\u91CC\u5B58\u653E\u56FE\u7247\u7684\u6587\u4EF6\u5939\uFF09</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>\u65B0\u5EFA\u76EE\u5F55\uFF1A\u9700\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\u3002</li><li>\u6839\u76EE\u5F55\uFF1A\u56FE\u7247\u5C06\u76F4\u63A5\u5B58\u50A8\u5728\u4ED3\u5E93\u6839\u76EE\u5F55\u4E0B\u3002</li><li>\u81EA\u52A8\u76EE\u5F55\uFF1A\u81EA\u52A8\u751F\u6210\u65E5\u671F\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55\u3002\u4F8B\u5982\uFF1A20200909</li><li>\u9009\u62E9\u4ED3\u5E93\u76EE\u5F55\uFF1A\u81EA\u52A8\u83B7\u53D6\u4ED3\u5E93\u4E0B\u6240\u6709\u76EE\u5F55\uFF0C\u9009\u62E9\u4E00\u4E2A\u5373\u53EF\u3002</li></ul></div>',11),Ba=[$a];function Ua(e,t){return m(),b("div",wa,Ba)}var Ta=Y(ka,[["render",Ua]]);const Ra=z({name:"use-tutorials",components:{Step1:Ia,Step2:La,Step3:Ta},setup(){const e=P(0);return{stepNum:e,step:n=>{n==="prev"&&(e.value<0?e.value=0:e.value-=1),n==="next"&&(e.value>3?e.value=3:e.value+=1)}}}}),un=e=>(ge("data-v-47504f00"),e=e(),he(),e),Pa={class:"page-container tutorials-page-container"},Oa={class:"step-content"},xa={key:3},Ma=un(()=>d("h2",null,"\u{1F44D} \u606D\u559C\u4F60\u5B8C\u6210\u56FE\u5E8A\u4F7F\u7528\u6559\u7A0B \u{1F31F} \u5FEB\u53BB\u8BD5\u8BD5\u5427~",-1)),Na=un(()=>d("h2",null,"https://github.com/XPoet/picx",-1)),Ga=[Ma,Na],Va={class:"btn-next-prev"};function za(e,t,n,s,a,u){const o=Pn,l=On,r=H("Step1"),f=H("Step2"),h=H("Step3"),g=Ue;return m(),b("div",Pa,[c(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:_(()=>[c(o,{title:"\u521B\u5EFA GitHub \u4ED3\u5E93"}),c(o,{title:"\u83B7\u53D6 GitHub Token"}),c(o,{title:"\u914D\u7F6E\u56FE\u5E8A"})]),_:1},8,["active"]),d("div",Oa,[e.stepNum===0?(m(),k(r,{key:0})):C("",!0),e.stepNum===1?(m(),k(f,{key:1})):C("",!0),e.stepNum===2?(m(),k(h,{key:2})):C("",!0),e.stepNum===3?(m(),b("div",xa,Ga)):C("",!0)]),d("div",Va,[e.stepNum>0?(m(),k(g,{key:0,type:"primary",onClick:t[0]||(t[0]=p=>e.step("prev"))},{default:_(()=>[$("\u4E0A\u4E00\u6B65 ")]),_:1})):C("",!0),e.stepNum<3?(m(),k(g,{key:1,type:"primary",onClick:t[1]||(t[1]=p=>e.step("next"))},{default:_(()=>[$("\u4E0B\u4E00\u6B65 ")]),_:1})):C("",!0)])])}var Ha=Y(Ra,[["render",za],["__scopeId","data-v-47504f00"]]);const Xa=["contenteditable","onFocusout"],ja={style:{"margin-top":"20px"}},Ka=z({__name:"image-link-rule-config",setup(e){const t=L(()=>M.getters.getUserSettings).value,n=P(),s=Je({id:"",name:"",rule:"",editable:!0}),a=(l,r)=>{M.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:l,id:r})},u=l=>{Se.confirm(`<span>\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A</span><strong>${l.name}</strong>`,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{M.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l.id)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},o=l=>{!l||l.validate(r=>{if(r)s.id=Ee(),M.dispatch("ADD_IMAGE_LINK_TYPE_RULE",s);else return!1})};return(l,r)=>{const f=xn,h=Ue,g=Mn,p=Nn,v=ye,E=qe,S=Ye,U=Gn;return m(),k(U,null,{default:_(()=>[c(g,{data:i(t).imageLinkType.presetList,style:{width:"100%"}},{default:_(()=>[c(f,{prop:"name",label:"\u7C7B\u578B",width:"100"}),c(f,{label:"CDN \u89C4\u5219"},{default:_(I=>[d("div",{contenteditable:I.row.editable,onFocusout:D=>a(D.target.innerHTML,I.row.id)},G(I.row.rule),41,Xa)]),_:1}),c(f,{label:"\u64CD\u4F5C",width:"80"},{default:_(I=>[c(h,{link:"",type:"danger",size:"small",disabled:!I.row.editable,onClick:D=>u(I.row)},{default:_(()=>[$(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),c(p),d("div",ja,[c(S,{ref_key:"formRef",ref:n,"label-position":"left",model:s,"label-width":"120px",size:"default"},{default:_(()=>[c(E,{label:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B",prop:"name",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[c(v,{modelValue:s.name,"onUpdate:modelValue":r[0]||(r[0]=I=>s.name=I),type:"text"},null,8,["modelValue"])]),_:1}),c(E,{label:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219",prop:"rule",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[c(v,{modelValue:s.rule,"onUpdate:modelValue":r[1]||(r[1]=I=>s.rule=I),type:"text"},null,8,["modelValue"])]),_:1}),c(E,null,{default:_(()=>[c(h,{type:"primary",disabled:!s.name||!s.rule,onClick:r[2]||(r[2]=I=>o(n.value))},{default:_(()=>[$(" \u6DFB\u52A0\u56FE\u7247\u94FE\u63A5\u89C4\u5219 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])]),_:1})}}});var qa=Y(Ka,[["__scopeId","data-v-7b06738a"]]);const ee=e=>(ge("data-v-9d3c6a0a"),e=e(),he(),e),Ya={class:"page-container settings-page-container"},Ja=ee(()=>d("div",{class:"setting-title"},"\u4E0A\u4F20\u8BBE\u7F6E\uFF1A",-1)),Wa={class:"setting-list"},Za={class:"setting-item upload-settings"},Qa=ee(()=>d("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u54C8\u5E0C\u7801\uFF0C\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),eu={class:"setting-item upload-settings"},tu=ee(()=>d("span",{class:"desc"},"\u4E0A\u4F20\u524D\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u914D\u7F6E\u7684\u524D\u7F00\uFF0C\u793A\u4F8B\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00",-1)),nu={key:0,class:"setting-item upload-settings"},su={class:"setting-item upload-settings"},ou={class:"desc"},au=ee(()=>d("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u914D\u7F6E\uFF1A",-1)),uu={class:"setting-list"},iu={class:"setting-item cdn"},lu={class:"left"},ru={class:"right"},cu={key:0,class:"setting-item"},du=ee(()=>d("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\u8BBE\u7F6E\uFF1A\uFF08\u4F8B\u5982\uFF1AMarkdown\u3001HTML\uFF09",-1)),pu={class:"setting-list"},_u={class:"setting-item"},mu={class:"left"},fu={class:"right"},gu=ee(()=>d("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),hu={class:"setting-list"},Eu={class:"setting-item"},Fu={class:"setting-item"},vu=ee(()=>d("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u50CF\u7F16\u7801\u5668\uFF08\u538B\u7F29\u7B97\u6CD5\uFF09\uFF1A",-1)),Du=ee(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u538B\u7F29\u7387\u8F83\u9AD8\uFF0C\u5927\u591A\u6570\u6D4F\u89C8\u5668\u652F\u6301",-1)),Iu=ee(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D",-1)),Au=ee(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u7387\u6700\u9AD8\uFF0C\u76EE\u524D\u4EC5\u8C37\u6B4C\u6D4F\u89C8\u5668\u652F\u6301",-1)),Cu=ee(()=>d("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),bu={class:"setting-list"},yu={class:"setting-item"},Su={key:0,class:"setting-title"},Lu={key:1,class:"setting-list"},ku={class:"setting-item"},wu=ee(()=>d("span",{class:"time-middle-space"}," ~ ",-1)),$u=z({__name:"my-settings",setup(e){const t=L(()=>M.getters.getUserSettings).value,n=P(!1),s=()=>{M.dispatch("USER_SETTINGS_PERSIST")},a=Ve,u=()=>{M.dispatch("SET_USER_SETTINGS",be({},t)),s()},o=()=>{n.value=!n.value};return(l,r)=>{const f=vt,h=ye,g=dt,p=pt,v=H("Remove"),E=H("CirclePlus"),S=oe,U=le,I=_t,D=mt,T=Vn,j=qe,F=Ye;return m(),b("div",Ya,[Ja,d("ul",Wa,[d("li",Za,[c(f,{modelValue:i(t).defaultHash,"onUpdate:modelValue":r[0]||(r[0]=A=>i(t).defaultHash=A),onChange:s,"active-text":"\u56FE\u7247\u540D\u81EA\u52A8\u54C8\u5E0C\u5316"},null,8,["modelValue"]),Qa]),d("li",eu,[c(f,{modelValue:i(t).defaultPrefix,"onUpdate:modelValue":r[1]||(r[1]=A=>i(t).defaultPrefix=A),onChange:s,"active-text":"\u6DFB\u52A0\u56FE\u7247\u540D\u524D\u7F00"},null,8,["modelValue"]),tu]),i(t).defaultPrefix?(m(),b("li",nu,[c(h,{class:"prefix-input",modelValue:i(t).prefixName,"onUpdate:modelValue":r[2]||(r[2]=A=>i(t).prefixName=A),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:s,clearable:"",autofocus:""},null,8,["modelValue"])])):C("",!0),d("li",su,[c(f,{modelValue:i(t).enableImageLinkFormat,"onUpdate:modelValue":r[3]||(r[3]=A=>i(t).enableImageLinkFormat=A),onChange:s,"active-text":"\u8F6C\u6362\u56FE\u7247\u94FE\u63A5\u683C\u5F0F"},null,8,["modelValue"]),d("span",ou," \u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u94FE\u63A5\u65F6\u542F\u7528 "+G(i(t).imageLinkFormat.selected)+" \u683C\u5F0F ",1)])]),au,d("ul",uu,[d("li",iu,[c(p,{modelValue:i(t).imageLinkType.selected,"onUpdate:modelValue":r[4]||(r[4]=A=>i(t).imageLinkType.selected=A),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u89C4\u5219",onChange:u},{default:_(()=>[(m(!0),b(ce,null,de(i(t).imageLinkType.presetList,A=>(m(),k(g,{key:A.name+"-"+A.id,label:A.name,value:A.name,class:"image-link-type-rule-option"},{default:_(()=>[d("span",lu,G(A.name),1),d("span",ru,G(A.rule),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),c(U,{content:(n.value?"\u5173\u95ED":"\u65B0\u589E")+"\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219",placement:"top"},{default:_(()=>[c(S,{class:"add-image-link-type-rule",onClick:o},{default:_(()=>[n.value?(m(),k(v,{key:0})):(m(),k(E,{key:1}))]),_:1})]),_:1},8,["content"])]),n.value?(m(),b("li",cu,[c(qa)])):C("",!0)]),du,d("ul",pu,[d("li",_u,[c(p,{modelValue:i(t).imageLinkFormat.selected,"onUpdate:modelValue":r[5]||(r[5]=A=>i(t).imageLinkFormat.selected=A),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u683C\u5F0F",onChange:u},{default:_(()=>[(m(!0),b(ce,null,de(i(t).imageLinkFormat.presetList,A=>(m(),k(g,{key:A.name,label:A.name,value:A.name,class:"image-link-type-rule-option"},{default:_(()=>[d("span",mu,G(A.name),1),d("span",fu,G(A.format),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),gu,d("ul",hu,[d("li",Eu,[c(f,{modelValue:i(t).isCompress,"onUpdate:modelValue":r[6]||(r[6]=A=>i(t).isCompress=A),onChange:s,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"])]),d("li",Fu,[vu,c(D,{class:"img-encoder-group",disabled:!i(t).isCompress,modelValue:i(t).compressEncoder,"onUpdate:modelValue":r[7]||(r[7]=A=>i(t).compressEncoder=A),onChange:s},{default:_(()=>[c(I,{label:i(a).webP},{default:_(()=>[$(G(i(a).webP)+" ",1),Du]),_:1},8,["label"]),c(I,{label:i(a).mozJPEG},{default:_(()=>[$(G(i(a).mozJPEG)+" ",1),Iu]),_:1},8,["label"]),c(I,{label:i(a).avif},{default:_(()=>[$(G(i(a).avif)+" ",1),Au]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])])]),Cu,d("ul",bu,[d("li",yu,[c(p,{modelValue:i(t).themeMode,"onUpdate:modelValue":r[8]||(r[8]=A=>i(t).themeMode=A),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:u},{default:_(()=>[c(g,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:"auto"}),c(g,{label:"\u6697\u591C\u4E3B\u9898",value:"dark"}),c(g,{label:"\u767D\u663C\u4E3B\u9898",value:"light"})]),_:1},8,["modelValue"])])]),i(t).themeMode==="auto"?(m(),b("div",Su,"\u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A")):C("",!0),i(t).themeMode==="auto"?(m(),b("ul",Lu,[d("li",ku,[c(F,{ref:"form"},{default:_(()=>[c(j,null,{default:_(()=>[c(T,{modelValue:i(t).autoLightThemeTime[0],"onUpdate:modelValue":r[9]||(r[9]=A=>i(t).autoLightThemeTime[0]=A),start:"00:00",step:"00:30",end:"23:59",onChange:u},null,8,["modelValue"]),wu,c(T,{modelValue:i(t).autoLightThemeTime[1],"onUpdate:modelValue":r[10]||(r[10]=A=>i(t).autoLightThemeTime[1]=A),start:i(t).autoLightThemeTime[0],step:"00:30",end:"23:59",onChange:u},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):C("",!0)])}}});var Bu=Y($u,[["__scopeId","data-v-9d3c6a0a"]]);const Uu={},ot=e=>(ge("data-v-5b70c12d"),e=e(),he(),e),Tu={class:"page-container feedback-page-container"},Ru=ot(()=>d("div",{class:"help-info-item description"},[$(" \u{1F3DE}\uFE0F PicX \u662F\u4E00\u6B3E\u57FA\u4E8E GitHub API \u5F00\u53D1\u7684\u56FE\u5E8A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u56FE\u7247\u4E0A\u4F20\u6258\u7BA1\u548C\u751F\u6210\u56FE\u7247\u94FE\u63A5\u670D\u52A1\u3002 "),d("br"),$(" \u{1F31F} \u65E0\u9700\u4E0B\u8F7D\uFF01\u65E0\u9700\u5B89\u88C5\uFF01\u7F51\u9875\u7AEF\u5728\u7EBF\u4F7F\u7528\uFF01\u514D\u8D39\uFF01\u7A33\u5B9A\uFF01\u4FBF\u6377\uFF01\u6781\u901F\uFF01 ")],-1)),Pu=ot(()=>d("div",{class:"help-info-item"},"\u{1F30D} \u5EFA\u8BAE\u5C06\u672C\u7AD9\u6DFB\u52A0\u81F3\u6D4F\u89C8\u5668\u6536\u85CF\u5939\uFF0C\u65B9\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002",-1)),Ou={class:"help-info-item"},xu={class:"help-info-item"},Mu={class:"help-info-item"},Nu={class:"help-info-item"},Gu={class:"help-info-item"},Vu=ot(()=>d("div",{class:"help-info-item red-text"},[d("strong",null," \u26A0\uFE0F \u90D1\u91CD\u58F0\u660E\uFF1A\u8BF7\u52FF\u901A\u8FC7\u672C\u7AD9\u4E0A\u4F20\u8FDD\u53CD\u4F60\u5F53\u5730\u6CD5\u5F8B\u7684\u56FE\u7247\uFF0C\u6240\u9020\u6210\u7684\u4E00\u5207\u540E\u679C\u4E0E\u672C\u7AD9\u65E0\u5173\u3002 ")],-1));function zu(e,t){const n=zn;return m(),b("div",Tu,[Ru,Pu,d("div",Ou,[$(" \u{1F929} \u4F5C\u8005\uFF1A "),c(n,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:_(()=>[$("@XPoet")]),_:1})]),d("div",xu,[$(" \u{1F381} \u4ED3\u5E93\uFF1A "),c(n,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:_(()=>[$(" https://github.com/XPoet/picx ")]),_:1})]),d("div",Mu,[$(" \u{1F4D6} \u6587\u6863\uFF1A "),c(n,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:_(()=>[$(" https://picx-docs.xpoet.cn ")]),_:1})]),d("div",Nu,[$(" \u{1F4A1} \u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u95EE\u9898\uFF0C\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u6587\u6863\uFF0C\u6216\u8005\u7ED9\u4F5C\u8005\u63D0\xA0 "),c(n,{type:"primary",style:{"font-size":"16rem"},href:"https://github.com/XPoet/picx/issues",target:"_blank"},{default:_(()=>[$(" Issue ")]),_:1}),$(" \xA0\u3002 ")]),d("div",Gu,[$(" \u{1F6A5} \u56FE\u7247\u4E0A\u4F20\u7F13\u6162\u6216\u52A0\u8F7D\u4E0D\u51FA\u6765\u7B49\u60C5\u51B5\uFF0C\u53EF\u501F\u52A9\xA0 "),c(n,{type:"primary",style:{"font-size":"16rem"},href:"https://xiyou4you.us/r/?s=24156134",target:"_blank"},{default:_(()=>[$(" VPN ")]),_:1}),$(" \xA0\u3002 ")]),Vu])}var Hu=Y(Uu,[["render",zu],["__scopeId","data-v-5b70c12d"]]);const Ce=" | PicX \u56FE\u5E8A\u795E\u5668",Xu=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Xs,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${Ce}`}},{path:"/upload",name:"upload",component:Yo,meta:{title:`\u56FE\u7247\u4E0A\u4F20${Ce}`}},{path:"/management",name:"Management",component:Fa,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${Ce}`}},{path:"/tutorials",name:"tutorials",component:Ha,meta:{title:`\u4F7F\u7528\u6559\u7A0B${Ce}`}},{path:"/help",name:"help",component:Hu,meta:{title:`\u5E2E\u52A9\u53CD\u9988${Ce}`}},{path:"/settings",name:"settings",component:Bu,meta:{title:`\u6211\u7684\u8BBE\u7F6E${Ce}`}}],we=Hn({history:Xn(),routes:Xu});we.beforeEach((e,t,n)=>{e.meta.title&&(window.document.title=e.meta.title),n()});const ju={id:"busuanzi_value_site_uv",class:"uv"},Ku={id:"busuanzi_value_site_pv",class:"pv"},ln=z({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,n=P(null),s=P(!1),a=L(()=>!0),u=(o,l)=>o.querySelector(`.${l?"u":"p"}v`).innerText;return _e(()=>{const o=document.createElement("script");o.async=!0,o.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",n.value.appendChild(o),o.onload=()=>{const l=setTimeout(()=>{u(n.value,t.isuv)&&(s.value=!0),clearTimeout(l)},1500)}}),(o,l)=>Z((m(),b("span",{class:"site-count",ref_key:"siteCountDom",ref:n},[$(" \u8D85\u8FC7 "),Z(d("span",ju,null,512),[[Ie,e.isuv]]),Z(d("span",Ku,null,512),[[Ie,!e.isuv]]),$(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[Ie,s.value&&i(a)]])}});var qu="./assets/logo.206d082d.png";const Yu=z({name:"header-content",components:{siteCount:ln},setup(){const e=Re(),t=W(),n=Je({defaultUsername:"\u672A\u767B\u5F55",userConfigInfo:L(()=>t.state.userConfigInfoModule.userConfigInfo)}),s=()=>{!n.userConfigInfo.logined&&e.currentRoute.value.path!=="/config"&&e.push("/config")},a=()=>{t.dispatch("LOGOUT"),e.push("/config")},u=l=>{switch(l){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":a();break}},o=()=>{window.open("https://github.com/XPoet/picx")};return ct(be({},Dt(n)),{router:e,onUserInfoClick:s,handleCommand:u,goGitHubRepo:o})}}),rn=e=>(ge("data-v-6b9f8420"),e=e(),he(),e),Ju={class:"header"},Wu={class:"header-left"},Zu=rn(()=>d("div",{class:"logo"},[d("img",{src:qu,alt:"PicX"})],-1)),Qu=rn(()=>d("div",{class:"title"},"PicX",-1)),ei=[Zu,Qu],ti={class:"header-right"},ni={class:"username"},si={key:0,class:"avatar"},oi={class:"el-dropdown-link"},ai={class:"avatar"},ui=["src","alt"];function ii(e,t,n,s,a,u){var v,E;const o=ln,l=le,r=H("UserFilled"),f=oe,h=gt,g=ht,p=Et;return m(),b("header",Ju,[d("div",Wu,[d("div",{class:"brand",onClick:t[0]||(t[0]=S=>e.router.push("/"))},ei),d("div",{class:"website-count",onClick:t[1]||(t[1]=(...S)=>e.goGitHubRepo&&e.goGitHubRepo(...S))},[c(l,{content:"\u611F\u89C9\u597D\u7528\uFF0C\u70B9 Star \u652F\u6301\u4F5C\u8005(*\uFFE3\uFE36\uFFE3)",placement:"bottom"},{default:_(()=>[c(o,{isuv:!1})]),_:1})])]),d("div",ti,[d("div",{class:"user-info",onClick:t[2]||(t[2]=(...S)=>e.onUserInfoClick&&e.onUserInfoClick(...S))},[d("div",ni,G(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),((v=e.userConfigInfo)==null?void 0:v.avatarUrl)?C("",!0):(m(),b("div",si,[c(f,{size:22},{default:_(()=>[c(r)]),_:1})])),((E=e.userConfigInfo)==null?void 0:E.avatarUrl)?(m(),k(p,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:_(()=>[c(g,null,{default:_(()=>[c(h,{command:"logout"},{default:_(()=>[$(" \u9000\u51FA\u767B\u5F55 ")]),_:1})]),_:1})]),default:_(()=>{var S,U;return[d("span",oi,[d("span",ai,[d("img",{src:(S=e.userConfigInfo)==null?void 0:S.avatarUrl,alt:(U=e.userConfigInfo)==null?void 0:U.owner},null,8,ui)])])]}),_:1},8,["onCommand"])):C("",!0)])])])}var li=Y(Yu,[["render",ii],["__scopeId","data-v-6b9f8420"]]);const ri=e=>(ge("data-v-49c29144"),e=e(),he(),e),ci={class:"nav"},di={class:"nav-list"},pi=["onClick"],_i={class:"nav-content"},mi={class:"nav-name"},fi={class:"nav-content"},gi=ri(()=>d("span",{class:"nav-name"},"\u5FEB\u6377\u64CD\u4F5C",-1)),hi={class:"quick-actions-box"},Ei=z({__name:"nav-content",setup(e){const t=Re(),n=W(),s=L(()=>n.getters.getUserConfigInfo).value,a=L(()=>n.getters.getUserSettings).value,u=L(()=>{switch(a.elementPlusSize){case J.small:return 22;case J.large:return 30;default:return 26}}),o=P(a.themeMode==="dark"),l=P([{name:"\u56FE\u5E8A\u914D\u7F6E",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"\u4E0A\u4F20\u56FE\u7247",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"\u56FE\u5E8A\u7BA1\u7406",icon:"box",isActive:!1,path:"/management",isShow:!0},{name:"\u6211\u7684\u8BBE\u7F6E",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"\u4F7F\u7528\u6559\u7A0B",icon:"magic-stick",isActive:!1,path:"/tutorials",isShow:!0},{name:"\u5E2E\u52A9\u53CD\u9988",icon:"chat-dot-round",isActive:!1,path:"/help",isShow:!0}]),r=P(!1),f=v=>{const{path:E}=v;if(E==="/management"){if(s.selectedRepo===""){w.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),t.push("/config");return}if(s.selectedDir===""){w.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),t.push("/config");return}}t.push(E)},h=v=>{l.value.forEach(E=>{const S=E;return S.isActive=E.path===v,S})},g=()=>{n.dispatch("USER_SETTINGS_PERSIST")},p=()=>{a.themeMode==="dark"?a.themeMode="light":a.themeMode="dark",g()};return ae(()=>t.currentRoute.value,v=>{h(v.path)}),ae(()=>s.logined,v=>{l.value.forEach(E=>{switch(E.path){case"/management":case"/settings":E.isShow=v}})},{deep:!0,immediate:!0}),_e(()=>{var v,E;t.isReady().then(()=>{h(t.currentRoute.value.path)}),(v=document.querySelector(".quick-actions .quick-actions-box"))==null||v.addEventListener("click",S=>{r.value=!0,S.stopPropagation()}),(E=document.querySelector(".quick-actions"))==null||E.addEventListener("click",S=>{r.value=!r.value,S.stopPropagation()}),document.addEventListener("click",()=>{r.value&&(r.value=!1)})}),(v,E)=>{const S=oe,U=H("Operation"),I=vt;return m(),b("aside",ci,[d("ul",di,[(m(!0),b(ce,null,de(l.value,(D,T)=>Z((m(),b("li",{class:pe(["nav-item flex-center",{active:D.isActive}]),key:T,onClick:j=>f(D)},[d("div",_i,[c(S,{size:i(u)},{default:_(()=>[(m(),k(jn(D.icon)))]),_:2},1032,["size"]),d("span",mi,G(D.name),1)])],10,pi)),[[Ie,D.isShow]])),128))]),d("div",{class:pe(["nav-item quick-actions flex-center",{active:r.value}])},[d("div",fi,[c(S,{size:i(u)},{default:_(()=>[c(U)]),_:1},8,["size"]),gi]),Z(d("div",hi,[c(I,{modelValue:o.value,"onUpdate:modelValue":E[0]||(E[0]=D=>o.value=D),class:"mb-2","active-text":"\u6697\u591C\u6A21\u5F0F",onChange:p},null,8,["modelValue"]),c(I,{modelValue:i(a).isCompress,"onUpdate:modelValue":E[1]||(E[1]=D=>i(a).isCompress=D),class:"mb-2","active-text":"\u538B\u7F29\u56FE\u7247",onChange:g},null,8,["modelValue"]),c(I,{modelValue:i(a).enableImageLinkFormat,"onUpdate:modelValue":E[2]||(E[2]=D=>i(a).enableImageLinkFormat=D),class:"mb-2","active-text":"\u8F6C\u6362 "+i(a).imageLinkFormat.selected,onChange:g},null,8,["modelValue","active-text"])],512),[[Ie,r.value]])],2)])}}});var Fi=Y(Ei,[["__scopeId","data-v-49c29144"]]);const cn=()=>{const e=W(),t=async a=>{await ft(()=>{const u=document.getElementsByTagName("html")[0];a==="dark"?(u.classList.remove("light"),u.classList.add("dark")):(u.classList.remove("dark"),u.classList.add("light"))})},n=a=>{const u=l=>{const r=new Date,f=r.getFullYear(),h=r.getMonth()+1,g=r.getDate();return new Date(`${f}/${h}/${g} ${a[l]}:00`).getTime()},o=Date.now();return u(0)<=o&&o<=u(1)},s=a=>{const{themeMode:u,autoLightThemeTime:o}=a;t(u==="auto"?n(o)?"light":"dark":u)};ae(()=>e.getters.getUserSettings,a=>{s(a)},{deep:!0,immediate:!0})};const vi={class:"top-container"},Di={class:"bottom-container"},Ii={class:"bottom-content"},Ai={class:"left"},Ci={class:"right"},bi={class:"content"},yi=z({__name:"main-container",setup(e){const t=W(),n=s=>{t.commit("CHANGE_UPLOAD_AREA_ACTIVE",s.target.classList.contains("active-upload"))};return _e(()=>{cn()}),(s,a)=>{const u=H("router-view");return m(),b("main",{class:"main-container",onClick:n},[d("div",vi,[c(li)]),d("div",Di,[d("div",Ii,[d("div",Ai,[c(Fi)]),d("div",Ci,[d("div",bi,[c(u)])])])])])}}});var dn=Y(yi,[["__scopeId","data-v-3e97363e"]]);const Si=z({name:"App",components:{ElConfigProvider:It,mainContainer:dn},setup(){const e=W(),t=Je({zIndex:3e3,size:"small",locale:Kn}),n=s=>{s<=600?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.small}),t.size=J.small):s<=800?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.default}),t.size=J.default):(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.large}),t.size=J.large)};return _e(()=>{cn(),n(window.innerWidth),window.addEventListener("resize",Fs(s=>{n(s.target.innerWidth)},800))}),be({},Dt(t))}});function Li(e,t,n,s,a,u){const o=dn,l=It;return m(),k(l,{size:e.size,"z-index":e.zIndex,locale:e.locale},{default:_(()=>[c(o)]),_:1},8,["size","z-index","locale"])}var ki=Y(Si,[["render",Li]]);const pn="custom-contextmenu-container";let X=null,at=!1;const wi={mounted(e,t){e.addEventListener("contextmenu",n=>{const{dir:s,type:a,img:u}=t.value;n.preventDefault(),n.stopPropagation();const o=L(()=>M.getters.getUserViewDir).value,l=s?`${o==="/"?"":`${o}/`}${s}`:o;X=document.querySelector(`.${pn}`),X||(X=document.createElement("ul"),X.setAttribute("class",pn),X.style.position="fixed",X.style.zIndex="1000",X.innerHTML='<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">\u590D\u5236\u56FE\u7247\u94FE\u63A5</li>',document.body.appendChild(X));const r=X==null?void 0:X.querySelector(".upload-image"),f=X==null?void 0:X.querySelector(".copy-link");a===Ae.img?(f.style.display="block",r.innerHTML="\u4ECE\u5F53\u524D\u4F4D\u7F6E\u4E0A\u4F20\u65B0\u56FE\u7247"):(f.style.display="none",r.innerHTML=`\u4E0A\u4F20\u56FE\u7247\u5230 < ${l==="/"?"\u6839\u76EE\u5F55":l} > \u76EE\u5F55`);let h=n.clientX,g=n.clientY;const p=X.clientWidth,v=X.clientHeight,E=document.documentElement.clientWidth,S=document.documentElement.clientHeight,U=6;p+h>E&&(h=E-p-U),v+g>S&&(g=S-v-U),X.style.top=`${g}px`,X.style.left=`${h}px`,at||(at=!0,r==null||r.addEventListener("click",async()=>{const D=l==="/"?K.rootDir:K.repoDir,T=l==="/"?[]:l.split("/");await M.dispatch("SET_USER_CONFIG_INFO",{dirMode:D,selectedDir:l,selectedDirList:T}),await we.push("/upload")}),f==null||f.addEventListener("click",async()=>{const D=L(()=>M.getters.getUserConfigInfo).value,T=L(()=>M.getters.getUserSettings).value;et(u,D,T)}));const I=()=>{X&&(document.removeEventListener("click",I),document.body.removeChild(X),X=null,at=!1)};document.addEventListener("click",I)})}};Qn(()=>import("./register-sw.215decb5.js"),[]);const ut=qn(ki);ut.directive("contextmenu",wi);for(const[e,t]of Object.entries(Yn))ut.component(e,t);ut.use(we).use(M,Vt).mount("#app");
