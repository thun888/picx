var Dn=Object.defineProperty;var ft=Object.getOwnPropertySymbols;var In=Object.prototype.hasOwnProperty,Cn=Object.prototype.propertyIsEnumerable;var gt=(e,t,n)=>t in e?Dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t)=>{for(var n in t||(t={}))In.call(t,n)&&gt(e,n,t[n]);if(ft)for(var n of ft(t))Cn.call(t,n)&&gt(e,n,t[n]);return e};import{A as yn,E as B,a as Se,C as An,e as wn,d as Sn,b as kn,c as Bn,u as Ln,f as G,g as $,h as $n,o as f,i as x,n as ke,j as i,r as Y,k as I,l as r,w as _,m as re,p as ve,q as L,s as ne,t as Be,v as Ze,x as Le,y as et,z as ht,B as Et,D as tt,F as nt,G as $e,H as Z,I as C,J as be,K as k,L as T,M as _e,N as fe,O as xn,P as m,Q as ce,R as Rn,S as se,T as De,U as Ie,V as Ft,W as Ve,X as vt,Y as xe,Z as bt,_ as Tn,$ as Dt,a0 as It,a1 as Ct,a2 as Un,a3 as yt,a4 as Ce,a5 as Re,a6 as On,a7 as Mn,a8 as Pn,a9 as Vn,aa as At,ab as wt,ac as St,ad as Nn,ae as Gn,af as zn,ag as jn,ah as kt,ai as Hn,aj as Xn,ak as Kn,al as qn,am as Wn,an as Yn,ao as Jn,ap as Qn,aq as Zn}from"./vendor.70dcc70f.js";const ea=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const a of u.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}};ea();const ta="XPoet/picx",Ne="picx-images-hosting",na="PicX images hosting repository",Ge="master",aa="Upload image via PicX(https://github.com/XPoet/picx)",sa="Upload images via PicX(https://github.com/XPoet/picx)",oa="Delete image via PicX(https://github.com/XPoet/picx)",ua="https://api.github.com",ia=3e5,at="PICX_",st=`${at}CONFIG`,Bt=`${at}MANAGEMENT`,Lt=`${at}SETTINGS`,$t=5,xt=30,Rt=18,la=ua,ze=yn.create({baseURL:la,timeout:ia});ze.defaults.headers["Content-Type"]="application/json";ze.interceptors.request.use(e=>{const t=localStorage.getItem(st);if(t){const{token:n}=JSON.parse(t);n&&(e.headers.Authorization=`token ${n}`)}return e},e=>Promise.reject(e));ze.interceptors.response.use(e=>e,e=>((e==null?void 0:e.response)||B.error({duration:6e3,message:`${e}`}),Promise.reject(e.response)));function q(e){const t={};e.method=e.method.toUpperCase();for(const n in e)n==="params"?e.method==="GET"?t.params=e.params:t.data=e.params:t[n]=e[n];return new Promise(n=>{ze.request(t).then(s=>{const{status:o,data:u}=s;n(s&&(o===200||o===201||o===204)?u||"SUCCESS":null)}).catch(s=>{var o;if((t==null?void 0:t.success422)&&(s==null?void 0:s.status)===422)n((s==null?void 0:s.data)||"SUCCESS");else{const u=s==null?void 0:s.status,a=(o=s==null?void 0:s.data)==null?void 0:o.message;(t==null?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",s),u!==void 0&&a!==void 0&&B.error({duration:6e3,message:`Code: ${u}, Message: ${a}`})),n(null)}})})}const Tt=e=>q({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),ra=(e=ta)=>q({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}),ca=(e,t=1)=>new Promise(async n=>{const s=await q({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:t}});s&&s.length?n(s.filter(o=>!o.fork&&!o.private).map(o=>({value:o.name,label:o.name}))):n(null)}),Ut=async e=>{const t=[];for(let n=1;n<=3;n++){const s=await ca(e,n);s&&t.push(...s)}return Promise.resolve(t.length?t:null)},Ot=async(e,t=!0)=>{const n=`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).
        `,{owner:s,selectedRepo:o,selectedBranch:u}=e;let a=null;t&&(a=Se.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."})),await q({url:`/repos/${s}/${o}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:u,content:window.btoa(n)},noShowErrorMsg:!0})?a==null||a.close():t&&B.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")},da=e=>q({url:"/user/repos",method:"POST",params:{name:Ne,description:na,private:!1},headers:{Authorization:`token ${e}`},success422:!0}),Te=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),ma=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},pa=e=>{if(e==="/")return[];const t=e.split("/"),n=[];let s="";return t.forEach((o,u)=>{s+=`${u>0?"/":""}${o}`,n.unshift(s)}),n};function Mt(e,t,n){var s;return e?t.length===n?e:Mt((s=e.childrenDirs)==null?void 0:s.find(o=>o.dir===t[n]),t,++n):null}const je=(e,t)=>{if(e==="/")return t;const n=e.split("/");return Mt(t,n,0)},He=(e,t,n)=>{var s;return n==="dir"?(s=t.childrenDirs)==null?void 0:s.filter(o=>o.type==="dir"):n==="image"?t.imageList.filter(o=>o.type==="image"):[]},_a=()=>{const e=localStorage.getItem(Bt);return e?JSON.parse(e):Te("/","/")},fa={state:{name:"dirImageListModule",dirObject:_a()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},n){if(n==="/")return;const s=(l,c,p)=>l?(l.childrenDirs.some(v=>v.dir===c)||l.childrenDirs.push(Te(c,p)),l.childrenDirs.find(v=>v.dir===c)||Te(c,p)):Te(c,p),o=n.split("/");let u="",a=e.dirObject;for(let l=0,c=o.length;l<c;l++){const p=o[l];u+=`${l>0?"/":""}${p}`,a=s(a,p,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",p)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},n){if(n==="/")return;const s=(a,l,c)=>{if(l==="/")return e.dirObject;const p=a.childrenDirs.find(g=>g.dir===l);if(!p)return a;if(c){const g=a.childrenDirs.findIndex(v=>v.dir===l);g!==-1&&a.childrenDirs.splice(g,1)}return p},o=n.split("/");let u=e.dirObject;o.forEach((a,l)=>{u=s(u,a,l===o.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",a)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},n){const s=(u,a,l,c,p=!1)=>{var v;if(!u)return e.dirObject;let g=(v=u.childrenDirs)==null?void 0:v.find(D=>D.dir===a);return g||(g={type:"dir",dir:a,dirPath:l,childrenDirs:[],imageList:[]},u.childrenDirs.push(g)),p&&!g.imageList.some(D=>D.name===c.name)&&g.imageList.push(c),g};let o=e.dirObject;if(n.dir==="/")o.imageList.some(u=>u.name===n.name)||o.imageList.push(n);else{const u=n.dir.split("/");let a="";u.forEach((l,c)=>{a+=`${c>0?"/":""}${l}`,o=s(o,l,a,n,c===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},n){const s=(p,g)=>{if(p.length){const v=p.findIndex(D=>D.uuid===g);v!==-1&&p.splice(v,1)}},o=(p,g,v,D)=>{if(!p)return e.dirObject;const E=p.childrenDirs.find(d=>d.dir===g);return E?(E.dir===g&&D&&s(E.imageList,v.uuid),E):e.dirObject},{dir:u,uuid:a}=n;if(u==="/"){s(e.dirObject.imageList,a),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let c=e.dirObject;l.forEach((p,g)=>{c=o(c,p,n,g===l.length-1),!c.imageList.length&&!c.childrenDirs.length&&pa(c.dirPath).forEach(D=>{const E=je(D,e.dirObject);if(E&&!E.imageList.length&&!E.childrenDirs.length){const{dirPath:d}=ma(D);t("SET_USER_CONFIG_INFO",{viewDir:d}),t("DIR_IMAGE_LIST_REMOVE_DIR",D)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},n){let s=e.dirObject;if(n==="/"){s.imageList=[],s.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const o=(a,l,c)=>{var g;if(!a)return e.dirObject;const p=(g=a.childrenDirs)==null?void 0:g.find(v=>v.dir===l);return p?(c&&(p.imageList=[],p.childrenDirs=[]),p):e.dirObject},u=n.split("/");u.forEach((a,l)=>{s=o(s,a,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(Bt,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Te("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var he;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(he||(he={}));var Ee;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(Ee||(Ee={}));var ue;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(ue||(ue={}));var de;(function(e){e.newBranch="newBranch",e.repoBranch="repoBranch"})(de||(de={}));var K;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.repoDir="repoDir"})(K||(K={}));var J;(function(e){e.large="large",e.default="default",e.small="small"})(J||(J={}));var me;(function(e){e.leftTop="leftTop",e.leftBottom="leftBottom",e.rightTop="rightTop",e.rightBottom="rightBottom"})(me||(me={}));var Q;(function(e){e.auto="auto",e.light="light",e.dark="dark"})(Q||(Q={}));var ye;(function(e){e[e.parentDir=0]="parentDir",e[e.childDir=1]="childDir",e[e.img=2]="img"})(ye||(ye={}));const Pt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},Fe=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Vt=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{t&&t()})},Nt=e=>{for(const t in e)switch(Pt(e[t])){case"object":Nt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},ot=(e,t)=>{for(const n in t)Pt(t[n])!=="object"?e&&(e[n]=t[n]):ot(e[n],t[n])},Gt=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},Xe=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function n(u){return`00${u}`.substr(u.length)}const s=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${s.getFullYear()}`.substr(4-RegExp.$1.length)));const o={"M+":s.getMonth()+1,"d+":s.getDate(),"h+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds()};for(const u in o)if(new RegExp(`(${u})`).test(e)){const a=`${o[u]}`;e=e.replace(RegExp.$1,RegExp.$1.length===1?a:n(a))}return e},ga=(e,t=500)=>{let n,s;function o(...u){s=u,n||(n=setTimeout(()=>{e(...s),n=void 0},t))}return o};function ha(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{const o=new Image;o.setAttribute("crossOrigin","Anonymous"),o.onload=()=>t(o),o.onerror=n,o.src=s.result},s.onerror=n,s.readAsDataURL(e)})}async function Ea(e,t){const{text:n,fontSize:s,position:o,opacity:u}=t,a=await ha(e),l=document.createElement("canvas"),c=l.getContext("2d");l.width=a.width,l.height=a.height,c.drawImage(a,0,0),c.font=`bold ${s}px Arial`,c.strokeStyle=`rgba(0, 0, 0, ${u})`,c.lineWidth=3,c.fillStyle=`rgba(255, 255, 255, ${u})`;let p=0,g=0;switch(o){case me.leftTop:p=10,g=s+5;break;case me.rightTop:p=l.width-c.measureText(n).width-10,g=s+5;break;case me.leftBottom:p=10,g=l.height-15;break;case me.rightBottom:p=l.width-c.measureText(n).width-10,g=l.height-15;break}return c.strokeText(n,p,g),c.fillText(n,p,g),new Promise(v=>{l.toBlob(D=>{if(!D)v(null);else{const E=new File([D],e.name,{type:e.type});v(E)}},e.type)})}const zt=()=>({uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isHashRename:!0,isRename:!1,isPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}}),Fa=(e,t)=>({type:"image",uuid:Fe(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});async function va(e,t){e.deleting=!0;const{owner:n,selectedRepo:s}=t,{path:o,sha:u}=e;return new Promise(async a=>{const l=await en(n,s,o,u);e.deleting=!1,l?(a(!0),await V.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await V.dispatch("DIR_IMAGE_LIST_REMOVE",e)):a(!1)})}const Ue=(e,t=!1)=>{e.forEach(n=>{n.deleting=t})};async function ba(e,t){Ue(e,!0);const{owner:n,selectedRepo:s,selectedBranch:o}=t,u=await Qt(n,s,o);if(!u)throw Ue(e,!1),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const a=await tn(n,s,e.map(p=>({path:p.path,sha:null})),u);if(!a)throw Ue(e,!1),new Error("\u521B\u5EFA tree \u5931\u8D25");const l=await nn(n,s,a,u);if(!l)throw Ue(e,!1),new Error("\u521B\u5EFA commit \u5931\u8D25");if(!await an(n,s,o,l.sha))throw Ue(e,!1),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(p=>{p.deleting=!1,V.dispatch("UPLOAD_IMG_LIST_REMOVE",p.uuid),V.dispatch("DIR_IMAGE_LIST_REMOVE",p)})}async function Da(e,t){if(e.length===1)return await va(e[0],t)?Ee.deleted:Ee.deleteFail;try{return await ba(e,t),Ee.allDeleted}catch(n){return console.error(n),Ee.deleteFail}}function Ia(e,t){const n=document.createElement("canvas"),s=n.getContext("2d"),o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(u=>{o.onload=()=>{const{width:a}=o,{height:l}=o;n.width=a,n.height=l,s==null||s.drawImage(o,0,0,a,l);const c=n.toDataURL(`image/${t}`);u(c)}})}function Ke(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{const s=n.result;t(s)},n.onerror=()=>t(null)})}function jt(e){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}const Ht=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},ut=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},it=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|x-icon|vnd.microsoft.icon)$/.test(e),Ca=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),ya=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),Ae=e=>e&&Number((e/1024).toFixed(0)),Aa=e=>new Promise(async t=>{e||t(null),it(e.type)||(B.error(`${e.name} \u4E0D\u662F\u56FE\u7247\u683C\u5F0F`),t(null));const n=await Ke(e)||"";Ae(n.length)>=xt*1024&&(B.error(`${e.name} \u8D85\u8FC7 ${xt} MB\uFF0C\u8DF3\u8FC7\u9009\u62E9`),t(null)),t({uuid:Fe(),base64:n,file:e})}),Xt=async(e,t)=>Ca(e.type)?new An(e,{encoderState:{type:t,options:wn[t].meta.defaultOptions},processorState:Sn,preprocessorState:kn}).process():e,lt=(e,t,n)=>{var u;const s=n.imageLinkType.selected,o=(u=n.imageLinkType.presetList.find(a=>a.name===s))==null?void 0:u.rule;if(o){const{owner:a,selectedRepo:l,selectedBranch:c}=t;return o.replaceAll("{{owner}}",a).replaceAll("{{repo}}",l).replaceAll("{{branch}}",c).replaceAll("{{path}}",e.path)}return null},Kt=(e,t,n)=>{var s;if(n.imageLinkFormat.enable){const o=n.imageLinkFormat.selected,u=(s=n.imageLinkFormat.presetList.find(a=>a.name===o))==null?void 0:s.format;if(u)return u.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},qe=(e,t,n,s=!1)=>{const o=Kt(lt(e,t,n),e.name,n);o?Vt(o,()=>{s?B.success({message:"\u56FE\u7247\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u7CFB\u7EDF\u526A\u8D34\u677F",duration:6e3}):B.success(`${n.imageLinkType.selected} \u56FE\u7247\u94FE\u63A5\u590D\u5236\u6210\u529F`)}):B.error("\u590D\u5236\u5931\u8D25")},qt=(e,t,n,s=!1)=>{if((e==null?void 0:e.length)>0){let o="";e.forEach((u,a)=>{o+=`${Kt(lt(u,t,n),u.name,n)}${a<e.length-1?`
`:""}`}),Vt(o,()=>{s?B.success({message:`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5\u5230\u7CFB\u7EDF\u526A\u8D34\u677F`,duration:6e3}):B.success(`\u6210\u529F\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5`)})}else console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},wa=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Wt=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:de.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:K.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(st);return t&&(ot(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===K.autoDir&&(e.selectedDir=Xe("yyyyMMdd"))),e},Sa=e=>{const{selectedDir:t,selectedBranch:n,dirMode:s}=e.userConfigInfo;if(s==="newDir"){const o=t.split("");let u=0,a="";const l=[" ",".","\u3001",",","\uFF0C","!","\uFF1F","?"];for(let c=0;c<o.length&&(l.some(p=>p===o[c])&&(o[c]="-"),o[c]==="/"&&(u+=1),!(u>=$t));c++)a+=o[c];e.userConfigInfo.selectedDir=a}e.userConfigInfo.selectedBranch=n.replace(/\s+/g,"-")},ka={state:{userConfigInfo:Wt()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Wt()},SET_USER_CONFIG_INFO({state:e,dispatch:t},n){for(const s in n)e.userConfigInfo.hasOwnProperty(s)&&(e.userConfigInfo[s]=n[s]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},n){e.userConfigInfo.dirList.some(s=>s.value===n)||(e.userConfigInfo.dirList.push({label:n,value:n}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},n){const{dirList:s}=e.userConfigInfo;if(s.some(o=>o.value===n)){const o=s.findIndex(u=>u.value===n);s.splice(o,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){Sa(e),localStorage.setItem(st,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Nt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},Ba={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:n,checked:s}=t;s&&e.imgCardArr.forEach(o=>{o.uuid===n&&(o.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},La={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},rt={defaultHash:!0,prefixNaming:{enable:!1,prefix:""},compress:{enable:!0,encoder:ue.webP},theme:{mode:Q.light,autoLightTime:["08:00","19:00"]},elementPlusSize:J.default,imageLinkType:{selected:"Staticaly",presetList:[{id:Fe(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Fe(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Fe(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:Fe(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:me.rightBottom,opacity:.5}},$a=()=>{const e=wa(Lt);return e&&ot(rt,e),rt},xa={state:{userSettings:$a()},actions:{SET_USER_SETTINGS({state:e},t){for(const n in t)e.userSettings.hasOwnProperty(n)&&(e.userSettings[n]=t[n])},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){e.userSettings.imageLinkType.presetList.some(o=>o.name===n.name)?B.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u89C4\u5219\u5DF2\u5B58\u5728\uFF01"):n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")?(e.userSettings.imageLinkType.presetList.push(n),t("USER_SETTINGS_PERSIST")):B.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){if(n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")){const s=e.userSettings.imageLinkType.presetList.find(o=>o.id===n.id);s&&(s.rule=n.rule,t("USER_SETTINGS_PERSIST"))}else B.error("\u4FEE\u6539\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5\uFF01")},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){const s=e.userSettings.imageLinkType.presetList;s.splice(s.findIndex(o=>o.id===n),1),t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Lt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=rt}},getters:{getUserSettings:e=>e.userSettings}},Ra={state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const n=e.toolboxImageList.findIndex(s=>s.uuid===t);n!==-1&&e.toolboxImageList.splice(n,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},Ta={state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const n=e.uploadImageList.findIndex(s=>s.uuid===t);n!==-1&&e.uploadImageList[n].uploadStatus.progress===0&&e.uploadImageList.splice(n,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},V=Bn({modules:{dirImageListModule:fa,userConfigInfoModule:ka,imageCardModule:Ba,uploadAreaActiveModule:La,userSettingsModule:xa,toolboxImageListModule:Ra,uploadImageListModule:Ta},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),Yt=Symbol("vuex-store");function ee(){return Ln(Yt)}const Jt=(e,t="")=>{const{owner:n,selectedRepo:s,selectedBranch:o}=e;return new Promise(async u=>{const a=await q({url:`/repos/${n}/${s}/contents/${t}`,method:"GET",params:{ref:o}});a&&a.length?u(a.filter(l=>l.type==="dir").map(l=>({value:l.name,label:l.name}))):u(null)})},We=(e,t="")=>{const{owner:n,selectedRepo:s,selectedBranch:o}=e;return new Promise(async u=>{const a=await q({url:`/repos/${n}/${s}/contents/${t}`,method:"GET",params:{ref:o}});a&&a.length?(a.filter(l=>l.type==="dir").forEach(l=>V.dispatch("DIR_IMAGE_LIST_ADD_DIR",l.path)),setTimeout(()=>{a.filter(l=>l.type==="file"&&it(ut(l.name))).forEach(l=>{V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Fa(l,t))})},120),u(!0)):u(null)})},Qt=(e,t,n)=>q({url:`/repos/${e}/${t}/branches/${n}`,method:"GET"}),Zt=(e,t)=>new Promise(async n=>{const s=await q({url:`/repos/${e}/${t}/branches`,method:"GET"});s&&s.length?n(s.filter(o=>!o.protected).map(o=>({value:o.name,label:o.name})).reverse()):n(null)}),Ua=async(e,t,n)=>{const{owner:s,selectedRepo:o,branchList:u}=e,a=Se.service({text:`\u6B63\u5728\u65B0\u5EFA ${t} \u5206\u652F...`});try{let l="";const c=await q({url:`/repos/${s}/${o}/git/refs/heads/${u[0].value}`,method:"GET"});if(c&&(l=c.object.sha),!l){a.close(),B.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}let p="";const g=await q({url:`/repos/${s}/${o}/git/refs`,method:"POST",params:{ref:`refs/heads/${t}`,sha:l}});if(g&&(p=g.object.sha),!p){a.close(),B.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}await q({url:`/repos/${s}/${o}/git/refs/heads/${t}`,method:"PATCH",params:{force:!0,sha:p}})&&n()}catch(l){console.error(l)}},en=(e,t,n,s)=>q({url:`/repos/${e}/${t}/contents/${n}`,method:"DELETE",data:{owner:e,repo:t,path:n,message:oa,sha:s}}),Oa=(e,t)=>q({url:e,method:"PUT",data:t}),Ma=(e,t,n)=>q({url:`/repos/${t}/${n}/git/blobs`,method:"POST",params:{owner:t,repo:n,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),tn=(e,t,n,s)=>{var o,u,a;return q({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:n.map(l=>({path:l.path,mode:"100644",type:"blob",sha:l.sha})),base_tree:((a=(u=(o=s==null?void 0:s.commit)==null?void 0:o.commit)==null?void 0:u.tree)==null?void 0:a.sha)||null}})},nn=(e,t,n,s)=>q({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:n.sha,parents:[s.commit.sha],message:sa}}),an=(e,t,n,s)=>q({url:`/repos/${e}/${t}/git/refs/heads/${n}`,method:"PATCH",params:{sha:s}}),sn=G({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:J.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!0}},setup(e){const t=ee(),n=$(()=>t.getters.getUserConfigInfo).value,s={lazy:!0,checkStrictly:!0,async lazyLoad(u,a){const{level:l,pathLabels:c}=u;let p;l===0?p=n.dirList:p=await Jt(n,c.join("/")),a(p?p.map(g=>({value:g.value,label:g.label,leaf:l>=$t-1})):[])}},o=u=>{n.selectedDirList=u,n.selectedDir=u.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,a)=>{const l=$n;return f(),x(l,{style:ke({width:e.elWidth}),size:e.elSize,debounce:500,props:s,key:e.elKey,modelValue:i(n).selectedDirList,"onUpdate:modelValue":a[0]||(a[0]=c=>i(n).selectedDirList=c),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:e.elClearable,onChange:o},null,8,["style","size","modelValue","clearable"])}}});var H=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n};const Pa=G({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:""}},setup(e){const t=e,n=ee(),s=$(()=>n.getters.getUserConfigInfo).value,o=$(()=>t.dataType==="repo"?"\u4ED3\u5E93":"\u5206\u652F"),u=async()=>{const a=Se.service({lock:!0,text:`\u6B63\u5728\u52A0\u8F7D ${o.value} \u6570\u636E ...`}),{owner:l,selectedRepo:c}=s;if(t.dataType==="repo"){const p=await Ut(l);p&&(s.repoList=p)}else if(t.dataType==="branch"){const p=await Zt(l,c);p&&(s.branchList=p)}a.close(),await n.dispatch("USER_CONFIG_INFO_PERSIST")};return(a,l)=>{const c=Y("Refresh"),p=re,g=ve;return f(),I("div",{class:"refresh-config-box",style:ke({width:e.boxWidth+"rem"})},[r(g,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(o)+" \u6570\u636E"},{default:_(()=>[r(p,{class:"icon",onClick:u},{default:_(()=>[r(c)]),_:1})]),_:1},8,["content"])],4)}}});var Va=H(Pa,[["__scopeId","data-v-9acb8ba8"]]);const N=$(()=>V.getters.getUserConfigInfo).value,Na=()=>{V.dispatch("LOGOUT")},ge=()=>{V.dispatch("USER_CONFIG_INFO_PERSIST")};function on(e){N.logined=!0,N.owner=e.login,N.name=e.name,N.email=e.email,N.avatarUrl=e.avatar_url,ge()}const Ga=()=>{N.selectedRepo="",N.repoList=[],N.selectedBranch="",N.branchMode=de.repoBranch,N.branchList=[],N.selectedDir="",N.dirMode=K.repoDir,N.dirList=[]},za=async()=>{const{selectedDir:e,dirMode:t}=N;let n="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(e===""){switch(t){case K.newDir:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case K.repoDir:n=`\u8BF7\u9009\u62E9 ${N.selectedRepo} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}B.warning(n)}else await Oe.push("/upload")},ja=async()=>{const{token:e}=N;if(!e){B.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}const t=Se.service({lock:!0,text:"\u6B63\u5728\u81EA\u52A8\u914D\u7F6E..."}),n=await Tt(N.token);if(console.log("getGitHubUserInfo >> ",n),!n){t.close(),B.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}on(n);const s=await da(N.token);if(console.log("createRepo >> ",s),!s){t.close(),B.error("\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01");return}N.repoList=[{value:Ne,label:Ne}],N.selectedRepo=Ne,N.branchList=[{value:Ge,label:Ge}],N.selectedBranch=Ge,N.branchMode=de.repoBranch,N.selectedDir=Xe("yyyyMMdd"),N.dirMode=K.autoDir,N.dirList=[],ge(),await Ot(N,!1),t.close(),B.success("\u81EA\u52A8\u914D\u7F6E\u6210\u529F"),await Oe.push("/upload")};const Ha={class:"page-container config-page-container"},Xa=G({__name:"my-config",setup(e){const t=ee(),n=L(!1),s=L(!1),o=L(!1),u=L(32),a=$(()=>t.getters.getUserConfigInfo).value,l=$(()=>t.getters.getUserLoginStatus).value,c=$(()=>t.getters.getUserSettings).value,p=$(()=>!a.token||!a.owner),g=$(()=>c.elementPlusSize===J.large?"right":"top"),v=$(()=>n.value||s.value||o.value),D=L(null),E=L(null),d=L(""),F=L("repoDirCascaderKey"),S=R=>{var A;switch(R){case K.rootDir:a.selectedDir="/";break;case K.autoDir:a.selectedDir=Xe("yyyyMMdd");break;case K.newDir:a.selectedDir="xxx",(A=D.value)==null||A.focus();break;case K.repoDir:const{dirList:P}=a;P.length?(a.selectedDir=P[0].value,a.selectedDirList=[P[0].value]):a.selectedDir="";break;default:a.selectedDir="/";break}ge()};async function b(R){const A=await Ut(R);console.log("getAllRepoList >> ",A),n.value=!1,A?(a.repoList=A,ge()):B.error("\u4ED3\u5E93\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}async function y(){s.value=!0;const R=await Jt(a);console.log("getDirInfoList >> ",R),s.value=!1,R&&(a.dirList=R),ge()}const M=R=>{var U;const A=a.selectedBranch,P=a.branchList[0].value;switch(R){case de.newBranch:a.dirMode=K.newDir,a.selectedBranch="",a.selectedDir="",(U=E.value)==null||U.focus();break;case de.repoBranch:A!==P&&(a.selectedBranch=P,y());break;default:a.selectedBranch="";break}ge()};async function w(R){o.value=!0;const{owner:A,dirMode:P}=a,U=await Zt(A,R);console.log("getBranchInfoList >> ",U),o.value=!1,U?(U.length>0?(a.branchList=U,a.selectedBranch=a.branchList[0].value,a.branchMode=de.repoBranch,await y()):(a.selectedBranch=Ge,a.branchMode=de.newBranch,await Ot(a)),S(P),ge()):B.error("\u5206\u652F\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")}async function h(){if(!a.token){B.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}p.value||Ga(),n.value=!0;const R=await Tt(a.token);if(console.log("getGitHubUserInfo >> ",R),!R){B.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}on(R),await b(R.login)}function z(R){a.branchList=[],a.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),w(R),ge()}async function W(R){a.selectedBranch=R,await y(),F.value=a.selectedBranch,a.selectedDir=a.dirList[0].value,a.selectedDirList=[a.selectedDir],ge()}const ae=()=>{const R=d.value,A=a.branchList;R?A.find(P=>P.value===R)?B.warning(`${R} \u5206\u652F\u5DF2\u5B58\u5728\uFF0C\u8BF7\u5728\u5206\u652F\u5217\u8868\u4E2D\u9009\u62E9`):Ua(a,R,()=>{B.success(`\u65B0\u5EFA ${R} \u6210\u529F`),a.branchList.push({value:R,label:R})}):B.error("\u65B0\u5EFA\u5206\u652F\u4E0D\u80FD\u4E3A\u7A7A\uFF01")};return ne(()=>l,R=>{R||(n.value=!1,s.value=!1,o.value=!1)}),(R,A)=>{const P=Be,U=Ze,te=Le,oe=ve,pe=et,X=ht,le=Et,_t=Va,Me=tt,vn=nt,bn=sn,Je=$e;return f(),I("div",Ha,[r(pe,{"label-width":"70rem","label-position":i(g)},{default:_(()=>[r(U,{label:"Token"},{default:_(()=>[r(P,{modelValue:i(a).token,"onUpdate:modelValue":A[0]||(A[0]=O=>i(a).token=O),clearable:"",autofocus:!i(a).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),r(U,{class:"operation"},{default:_(()=>[r(oe,{placement:"top",content:"\u9009\u62E9\u5DF2\u6709\u7684 GitHub \u4ED3\u5E93"},{default:_(()=>[r(te,{disabled:i(v),plain:"",type:"primary","native-type":"submit",onClick:A[1]||(A[1]=be(O=>h(),["prevent"]))},{default:_(()=>[k(T(i(p)?"":"\u91CD\u65B0")+"\u624B\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1}),r(oe,{placement:"top",content:"\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\uFF08\u9002\u5408\u65B0\u7528\u6237\uFF09"},{default:_(()=>[r(te,{plain:"",disabled:i(v),type:"primary",onClick:A[2]||(A[2]=be(O=>i(ja)(),["prevent"]))},{default:_(()=>[k(T(i(p)?"":"\u91CD\u65B0")+"\u4E00\u952E\u81EA\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["label-position"]),i(a).token&&i(a).owner?Z((f(),x(pe,{key:0,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F..."},{default:_(()=>[i(a).owner?(f(),x(U,{key:0,label:"\u7528\u6237\u540D"},{default:_(()=>[r(P,{modelValue:i(a).owner,"onUpdate:modelValue":A[3]||(A[3]=O=>i(a).owner=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(a).email?(f(),x(U,{key:1,label:"\u90AE\u7BB1"},{default:_(()=>[r(P,{modelValue:i(a).email,"onUpdate:modelValue":A[4]||(A[4]=O=>i(a).email=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(a).repoList.length?(f(),x(U,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:_(()=>[r(le,{modelValue:i(a).selectedRepo,"onUpdate:modelValue":A[5]||(A[5]=O=>i(a).selectedRepo=O),filterable:!0,style:ke({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:z},{default:_(()=>[(f(!0),I(_e,null,fe(i(a).repoList,(O,Qe)=>(f(),x(X,{key:Qe,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(_t,{"box-width":u.value,"data-type":"repo"},null,8,["box-width"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,n.value]]):C("",!0),i(a).token&&i(a).selectedRepo&&i(a).branchList.length?Z((f(),x(pe,{key:1,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u5206\u652F\u4FE1\u606F..."},{default:_(()=>[(i(a).selectedRepo,C("",!0)),i(a).branchList.length&&i(a).branchMode===i(de).repoBranch?(f(),x(U,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:_(()=>[r(le,{modelValue:i(a).selectedBranch,"onUpdate:modelValue":A[7]||(A[7]=O=>i(a).selectedBranch=O),filterable:!0,style:ke({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:W},{default:_(()=>[(f(!0),I(_e,null,fe(i(a).branchList,(O,Qe)=>(f(),x(X,{key:Qe,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(_t,{"box-width":u.value,"data-type":"branch"},null,8,["box-width"])]),_:1})):C("",!0),i(a).branchMode===i(de).newBranch?(f(),x(U,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:_(()=>[r(P,{modelValue:d.value,"onUpdate:modelValue":A[8]||(A[8]=O=>d.value=O),onBlur:ae,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F...",ref_key:"newBranchInputRef",ref:E},null,8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,o.value]]):C("",!0),i(a).token&&i(a).selectedBranch?Z((f(),x(pe,{key:2,"label-width":"70rem","label-position":i(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u76EE\u5F55\u4FE1\u606F..."},{default:_(()=>[i(a).selectedBranch?(f(),x(U,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:_(()=>[r(vn,{modelValue:i(a).dirMode,"onUpdate:modelValue":A[9]||(A[9]=O=>i(a).dirMode=O),onChange:S},{default:_(()=>[r(oe,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"newDir"},{default:_(()=>[k("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),r(oe,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+i(a).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"rootDir"},{default:_(()=>[k("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),r(oe,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"autoDir"},{default:_(()=>[k("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),i(a).dirList.length&&i(a).branchMode!=="newBranch"?(f(),x(oe,{key:0,content:"\u9009\u62E9 "+i(a).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"repoDir"},{default:_(()=>[k(" \u9009\u62E9 "+T(i(a).selectedRepo)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):C("",!0)]),_:1},8,["modelValue"])]),_:1})):C("",!0),i(a).dirMode==="autoDir"?(f(),x(U,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:_(()=>[r(P,{modelValue:i(a).selectedDir,"onUpdate:modelValue":A[10]||(A[10]=O=>i(a).selectedDir=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(a).dirMode==="rootDir"?(f(),x(U,{key:2,label:"\u6839\u76EE\u5F55"},{default:_(()=>[r(P,{modelValue:i(a).selectedDir,"onUpdate:modelValue":A[11]||(A[11]=O=>i(a).selectedDir=O),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),i(a).dirMode==="newDir"?(f(),x(U,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:_(()=>[r(P,{ref_key:"newDirInputRef",ref:D,modelValue:i(a).selectedDir,"onUpdate:modelValue":A[12]||(A[12]=O=>i(a).selectedDir=O),onInput:A[13]||(A[13]=O=>i(ge)()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):C("",!0),i(a).dirList.length&&i(a).dirMode==="repoDir"&&i(a).branchMode!=="newBranch"?(f(),x(U,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:_(()=>[r(bn,{"el-key":F.value,"el-size":i(c).elementPlusSize},null,8,["el-key","el-size"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,s.value]]):C("",!0),i(a).token?(f(),x(pe,{key:3,"label-width":"70rem","label-position":i(g)},{default:_(()=>[r(U,{class:"operation"},{default:_(()=>[i(a).owner?(f(),x(te,{key:0,plain:"",disabled:i(v),type:"warning",onClick:A[14]||(A[14]=O=>i(Na)())},{default:_(()=>[k(" \u91CD\u7F6E ")]),_:1},8,["disabled"])):C("",!0),i(a).selectedRepo?(f(),x(te,{key:1,plain:"",disabled:i(v),type:"success",onClick:A[15]||(A[15]=O=>i(za)())},{default:_(()=>[k(" \u786E\u8BA4 ")]),_:1},8,["disabled"])):C("",!0)]),_:1})]),_:1},8,["label-position"])):C("",!0)])}}});var Ka=H(Xa,[["__scopeId","data-v-2e44335c"]]);const qa={key:0,class:"selected-info-bar-box"},Wa={class:"info-item repo"},Ya={key:0,class:"info-item branch"},Ja={class:"info-item dir"},Qa=G({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=ee(),n=$(()=>t.getters.getUserConfigInfo),s=$(()=>t.getters.getUserSettings);return(o,u)=>{const a=xn,l=sn;return i(n).selectedRepo?(f(),I("div",qa,[m("span",Wa,[k(" \u4ED3\u5E93\uFF1A "),r(a,{"disable-transitions":""},{default:_(()=>[k(T(i(n).selectedRepo),1)]),_:1})]),i(n).selectedBranch?(f(),I("span",Ya,[k(" \u5206\u652F\uFF1A "),r(a,{"disable-transitions":""},{default:_(()=>[k(T(i(n).selectedBranch),1)]),_:1})])):C("",!0),m("span",Ja,[k(" \u76EE\u5F55\uFF1A "),i(n).dirMode!==i(K).repoDir||e.barType==="management"?(f(),x(a,{key:0,"disable-transitions":""},{default:_(()=>[k(T(e.barType==="management"?i(n).viewDir:i(n).selectedDir),1)]),_:1})):C("",!0),i(n).dirMode===i(K).repoDir&&e.barType==="upload"?(f(),x(l,{key:1,"el-size":i(s).elementPlusSize===i(J).large?i(J).default:i(s).elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):C("",!0)])])):C("",!0)}}});var un=H(Qa,[["__scopeId","data-v-dc55c6ba"]]);const ln=e=>(De("data-v-e7b81042"),e=e(),Ie(),e),Za=["onDrop","onPaste"],es=ln(()=>m("label",{for:"input-file-selector"},null,-1)),ts={key:0,class:"upload-area-tips"},ns=ln(()=>m("div",{class:"text"},"\u62D6\u62FD / \u7C98\u8D34 / \u70B9\u51FB\u6B64\u5904\u9009\u62E9\u56FE\u7247",-1)),as=["src"],ss=G({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:n}){const s=ee(),o=$(()=>s.getters.getUploadAreaActive),u=L({uuid:"",base64:""}),a=L([]),l=()=>{const d=a.value.length,F=d>0?a.value[d-1]:{uuid:"",base64:""};u.value={uuid:F.uuid,base64:F.base64}},c=async d=>{if(!!d.length){a.value=[];for(const F of d){const S=await Aa(F);S&&a.value.push(S)}l(),s.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),n("getImgList",a.value)}},p=async d=>{const F=d.target;await c(F.files),F.value="",F.value=F.defaultValue},g=async d=>{await c(d.dataTransfer.files)},v=async d=>{const F=Array.from(d.clipboardData.items).filter(S=>S.kind==="file"&&it(S.type)).map(S=>S.getAsFile());await c(F)},D=()=>{a.value=[],u.value.uuid="",u.value.base64=""},E=d=>{const F=a.value.findIndex(S=>S.uuid===d);F!==-1&&a.value.splice(F,1),d===u.value.uuid&&l()};return ce(()=>{window.addEventListener("paste",v)}),Rn(()=>{window.removeEventListener("paste",v)}),t({reset:D,remove:E}),(d,F)=>{const S=Y("UploadFilled"),b=re;return f(),I("div",{class:se(["getting-images-container",{focus:i(o)&&u.value.base64,disabled:e.disabled}]),onDragover:F[0]||(F[0]=be(()=>{},["prevent"])),onDrop:be(g,["stop","prevent"]),onPaste:be(v,["stop"])},[es,m("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:p,multiple:"multiple"},null,32),u.value.base64?C("",!0):(f(),I("div",ts,[r(b,{class:"icon"},{default:_(()=>[r(S)]),_:1}),ns])),u.value.base64?(f(),I("img",{key:1,class:"preview-img",src:u.value.base64},null,8,as)):C("",!0)],42,Za)}}});var rn=H(ss,[["__scopeId","data-v-e7b81042"]]);const os=$(()=>V.getters.getUserSettings).value,cn=async e=>{const{starred:t}=e;t||await ra()&&await V.dispatch("SET_USER_SETTINGS",{starred:!0})},us=e=>{const t=zt();t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{prefixNaming:n,defaultHash:s}=os,o=e.uuid,u=e.file.name.lastIndexOf("."),a=e.file.name.slice(0,u),l=e.file.name.slice(u+1);return t.filename.initName=a,t.filename.name=n.enable?`${n.prefix}${a}`:a,t.filename.prefixName=n.prefix,t.filename.hash=o,t.filename.suffix=l,t.filename.final=s?`${t.filename.name}.${o}.${l}`:`${t.filename.name}.${l}`,t.filename.isHashRename=s,t.filename.isPrefix=n.enable,t},dn=(e,t,n)=>{var u;let s=n.selectedDir;((u=t==null?void 0:t.reUploadInfo)==null?void 0:u.isReUpload)&&(s=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const o={checked:!1,type:"image",uuid:t.uuid,dir:s,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=o,V.dispatch("DIR_IMAGE_LIST_ADD_DIR",s),V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)},is=(e,t)=>{var l;const{owner:n,selectedRepo:s,selectedDir:o}=e,u=t.filename.final;let a=u;return o!=="/"&&(a=`${o}/${u}`),((l=t==null?void 0:t.reUploadInfo)==null?void 0:l.isReUpload)&&(a=t.reUploadInfo.path),`/repos/${n}/${s}/contents/${a}`};async function ls(e,t){const{selectedBranch:n,selectedRepo:s,selectedDir:o,owner:u}=e,a=[];for(const D of t){D.uploadStatus.uploading=!0;const E=await Ma(D,u,s);E?a.push(Pe({img:D},E)):(D.uploadStatus.uploading=!1,B.error(`${D.filename.final} \u4E0A\u4F20\u5931\u8D25`))}const l=await Qt(u,s,n);if(!l)return Promise.resolve(!1);const c=o==="/"?"":`${o}/`,p=await tn(u,s,a.map(D=>({sha:D.sha,path:`${c}${D.img.filename.final}`})),l);if(!p)return Promise.resolve(!1);const g=await nn(u,s,p,l);return!g||!await an(u,s,n,g.sha)?Promise.resolve(!1):(a.forEach(D=>{const E=D.img.filename.final;dn({name:E,sha:D.sha,path:`${c}${E}`,size:0},D.img,e)}),Promise.resolve(!0))}function mn(e,t){const{selectedBranch:n,email:s,owner:o}=e,u={message:aa,branch:n,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return s&&(u.committer={name:o,email:s}),t.uploadStatus.uploading=!0,new Promise(async a=>{const l=await Oa(is(e,t),u);if(console.log("uploadSingleImage >> ",l),t.uploadStatus.uploading=!1,l){const{name:c,sha:p,path:g,size:v}=l.content;dn({name:c,sha:p,path:g,size:v},t,e),a(!0)}else a(!1)})}const ct=(e,t)=>{e?t.filename.name=`${t.filename.prefixName}${t.filename.initName}`:t.filename.name=`${t.filename.initName}`,t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},pn=(e,t)=>{e?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},rs=(e,t)=>{t.filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):ct(t.filename.isPrefix,t),t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},cs=async(e,t)=>{const{watermark:n,compress:s}=t;let o=e.fileInfo.originalFile;n.enable&&n.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=ya(e.fileInfo.originalFile.type)?await Ea(e.fileInfo.originalFile,n):e.fileInfo.originalFile,o=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Ke(o),e.beforeUploadStatus.watermarking=!1),s.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await Xt(o,s.encoder),o=e.fileInfo.compressFile,e.base64.compressBase64=await Ke(o),e.filename.suffix=ut(o.name),e.beforeUploadStatus.compressing=!1)};const ds=["element-loading-text"],ms={class:"before-upload-handle-container"},ps={class:"img-name-box"},_s={class:"img-name text-ellipsis"},fs={class:"operate-item"},gs={class:"operate-item"},hs={key:0,class:"operate-item"},Es={key:1,class:"img-info-box"},Fs={class:"file-size-box"},vs={key:0,class:"finial-file-size file-size-item"},bs={class:"last-modified"},Ds=G({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=e,s=ee(),o=L(null),u=$(()=>s.getters.getUserSettings).value,a=$(()=>s.getters.getUserConfigInfo).value,l=L(""),c=Ft({isHash:!1,prefixNaming:!1,isRename:!1,newName:""}),p=L(!0),g=E=>{t("remove",E)},v=()=>{n.imgObj.filename.newName=c.newName,setTimeout(()=>{var E;(E=o.value)==null||E.focus()},100),rs(c.isRename,n.imgObj)},D=()=>{const{defaultHash:E,prefixNaming:d}=u;n.imgObj.uploadStatus.progress===0&&(n.imgObj.filename.isHashRename=E,n.imgObj.filename.isPrefix=d.enable,n.imgObj.filename.prefixName=d.prefix,ct(d.enable,n.imgObj),pn(E,n.imgObj),c.isHash=n.imgObj.filename.isHashRename,c.prefixNaming=n.imgObj.filename.isPrefix,c.isRename=n.imgObj.filename.isRename,c.newName=n.imgObj.filename.newName)};return ne(()=>n.imgObj.uploadStatus,E=>{E.uploading&&(l.value="\u6B63\u5728\u4E0A\u4F20...")},{deep:!0,immediate:!0}),ce(async()=>{await cs(n.imgObj,u),D()}),(E,d)=>{var A,P,U,te,oe,pe;const F=Ve,S=Y("CaretBottom"),b=Y("CaretLeft"),y=re,M=ve,w=vt,h=Be,z=Y("Remove"),W=Y("Upload"),ae=Y("Check"),R=$e;return f(),I("div",{class:se(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploading:e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress!==100,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[Z((f(),I("div",{class:"img-show-container","element-loading-text":l.value},[r(F,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])],8,ds)),[[R,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),m("div",ms,[m("div",ps,[m("span",_s,T(e.imgObj.filename.final||e.imgObj.filename.name),1),e.imgObj.uploadStatus.progress===0?(f(),x(M,{key:0,placement:"top",offset:8,content:p.value?"\u5C55\u5F00":"\u6298\u53E0"},{default:_(()=>[r(y,{class:"fold-btn",onClick:d[0]||(d[0]=X=>p.value=!p.value)},{default:_(()=>[p.value?C("",!0):(f(),x(S,{key:0})),p.value?(f(),x(b,{key:1})):C("",!0)]),_:1})]),_:1},8,["content"])):C("",!0)]),e.imgObj.uploadStatus.progress===0?(f(),I("div",{key:0,class:se(["img-name-operate-box",{folded:p.value}])},[m("div",fs,[r(w,{label:"\u54C8\u5E0C\u5316",modelValue:c.isHash,"onUpdate:modelValue":d[1]||(d[1]=X=>c.isHash=X),onChange:d[2]||(d[2]=X=>i(pn)(X,e.imgObj))},null,8,["modelValue"])]),m("div",gs,[r(w,{label:"\u91CD\u547D\u540D",modelValue:c.isRename,"onUpdate:modelValue":d[3]||(d[3]=X=>c.isRename=X),onChange:v},null,8,["modelValue"]),e.imgObj.filename.isRename?(f(),x(h,{key:0,class:"rename-input",size:"small",modelValue:c.newName,"onUpdate:modelValue":d[4]||(d[4]=X=>c.newName=X),onInput:v,maxlength:i(Rt),ref_key:"renameInputRef",ref:o,clearable:""},null,8,["modelValue","maxlength"])):C("",!0)]),!e.imgObj.filename.isRename&&i(u).prefixNaming.enable&&i(u).prefixNaming.prefix?(f(),I("div",hs,[r(w,{label:"\u547D\u540D\u524D\u7F00",modelValue:c.prefixNaming,"onUpdate:modelValue":d[5]||(d[5]=X=>c.prefixNaming=X),onChange:d[6]||(d[6]=X=>i(ct)(X,e.imgObj))},null,8,["modelValue"])])):C("",!0)],2)):C("",!0),e.imgObj.uploadStatus.progress===0?(f(),I("div",Es,[m("div",Fs,[m("span",{class:se(["original-file-size file-size-item",{"del-line":(P=(A=e.imgObj.fileInfo)==null?void 0:A.compressFile)==null?void 0:P.size}])},T(i(Ae)(e.imgObj.fileInfo.originalFile.size))+" KB ",3),((te=(U=e.imgObj.fileInfo)==null?void 0:U.compressFile)==null?void 0:te.size)?(f(),I("span",vs,T(i(Ae)((pe=(oe=e.imgObj.fileInfo)==null?void 0:oe.compressFile)==null?void 0:pe.size))+" KB ",1)):C("",!0)]),m("span",bs,T(i(Xe)("yyyy-MM-dd hh:mm",e.imgObj.fileInfo.originalFile.lastModified)),1)])):C("",!0)]),e.imgObj.uploadStatus.progress===100?(f(),I("div",{key:0,class:"after-upload-handle-container flex-center",onClick:d[7]||(d[7]=X=>i(qe)(e.imgObj.uploadedImg,i(a),i(u)))}," \u70B9\u51FB\u590D\u5236\u56FE\u7247\u94FE\u63A5 ")):C("",!0),e.imgObj.uploadStatus.progress===0?(f(),x(M,{key:1,placement:"top",offset:8,content:"\u5220\u9664"},{default:_(()=>[r(y,{class:"del-img-btn",onClick:d[8]||(d[8]=X=>g(e.imgObj.uuid))},{default:_(()=>[r(z)]),_:1})]),_:1})):C("",!0),m("div",{class:se(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[r(y,null,{default:_(()=>[!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0?(f(),x(W,{key:0})):C("",!0),!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100?(f(),x(ae,{key:1})):C("",!0)]),_:1})],2)],2)}}});var Is=H(Ds,[["__scopeId","data-v-2a6b23a0"]]);const Cs={class:"upload-page-container"},ys={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},As={class:"row-item"},ws={class:"content-box"},Ss={class:"row-item"},ks={class:"content-box upload-area-status"},Bs={key:0},Ls={key:0,class:"row-item"},$s={class:"content-box",style:{"text-align":"right"}},xs={class:"shortcut-key"},Rs={class:"shortcut-key"},Ts=G({__name:"upload-image",setup(e){const t=ee(),n=xe(),s=L(null),o=$(()=>t.getters.getUserConfigInfo).value,u=$(()=>t.getters.getUserSettings).value,a=$(()=>t.getters.getUserLoginStatus),l=L([]),c=L(!1),p=$(()=>Gt()==="mac"?"Command":"Ctrl"),g=b=>{b.forEach(y=>{t.dispatch("UPLOAD_IMG_LIST_ADD",us(y))})},v=()=>{var b;(b=s.value)==null||b.reset()},D=async b=>{if(b.length===1)return await mn(o,b[0])?he.uploaded:he.uploadFail;if(b.length>1)return await ls(o,b)?he.allUploaded:he.uploadFail},E=async()=>{const{token:b,selectedRepo:y,selectedDir:M}=o;if(!b){B.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E"),await n.push("/config");return}if(!y){B.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),await n.push("/config");return}if(!M){B.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),await n.push("/config");return}const w=l.value.filter(W=>W.uploadStatus.progress===0);if(w.length===0){B.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247");return}c.value=!0;const h=await D(w);c.value=!1;const z=w.filter(W=>W.uploadStatus.progress===100).map(W=>W.uploadedImg);switch(h){case he.uploaded:v(),B.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F"),qe(z[0],o,u,!0),await cn(u);break;case he.allUploaded:v(),B.success("\u56FE\u7247\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),qt(z,o,u,!0),await cn(u);break;case he.uploadFail:B.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF01")}},d=()=>{c.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),v()},F=b=>{var y;t.dispatch("UPLOAD_IMG_LIST_REMOVE",b),(y=s.value)==null||y.remove(b)};ne(()=>a,b=>{!b&&d()}),ne(()=>t.state.uploadImageListModule.uploadImageList,b=>{l.value=b},{immediate:!0,deep:!0});const S=()=>{document.addEventListener("keydown",b=>{const y=b.keyCode||b.which||b.charCode,M=b.ctrlKey||b.metaKey;M&&y===65&&l.value.length&&(d(),b.preventDefault()),M&&y===83&&(c.value||(E(),b.preventDefault()))})};return ce(()=>{S()}),(b,y)=>{const M=rn,w=un,h=Le;return f(),I("div",Cs,[l.value.length&&(i(u).elementPlusSize===i(J).large||i(u).elementPlusSize===i(J).default)?(f(),I("div",ys,[(f(!0),I(_e,null,fe(l.value,(z,W)=>(f(),I("div",{class:"uploaded-item",key:W+z.uuid},[r(Is,{"img-obj":z,onRemove:y[0]||(y[0]=ae=>F(ae))},null,8,["img-obj"])]))),128))])):C("",!0),m("div",{class:se(["upload-page-right page-container",{"has-left":l.value.length}])},[m("div",As,[m("div",ws,[r(M,{disabled:c.value,ref_key:"gettingImagesRef",ref:s,onGetImgList:g},null,8,["disabled"])])]),m("div",Ss,[m("div",ks,[r(w),l.value.length?(f(),I("div",Bs," \u5DF2\u4E0A\u4F20\uFF1A"+T(l.value.filter(z=>z.uploadStatus.progress===100).length)+" / "+T(l.value.length),1)):C("",!0)])]),l.value.length?(f(),I("div",Ls,[m("div",$s,[r(h,{disabled:c.value,plain:"",type:"warning",onClick:d},{default:_(()=>[k(" \u91CD\u7F6E "),m("span",xs,T(i(p))+" + A",1)]),_:1},8,["disabled"]),r(h,{disabled:c.value,plain:"",type:"primary",onClick:E},{default:_(()=>[k(" \u4E0A\u4F20 "),m("span",Rs,T(i(p))+" + S",1)]),_:1},8,["disabled"])])])):C("",!0)],2)])}}});const Us={class:"copy-image-link-box"},Os={class:"left"},Ms={class:"btn-box right"},Ps=G({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,n=$(()=>V.getters.getUserSettings).value,s=$(()=>V.getters.getUserConfigInfo).value;let o=L(t.imgObj).value;const u=()=>{qe(o,s,n)};return bt(()=>{o=t.imgObj}),(a,l)=>{const c=Y("InfoFilled"),p=re,g=ve;return f(),I("div",Us,[m("div",Os,[r(g,{content:"\u8BF7\u5728'\u6211\u7684\u8BBE\u7F6E'\u8FDB\u884C\u56FE\u7247\u94FE\u63A5\u76F8\u5173\u914D\u7F6E",placement:"top"},{default:_(()=>[r(p,null,{default:_(()=>[r(c)]),_:1})]),_:1})]),m("div",Ms,[r(g,{content:"\u70B9\u51FB\u590D\u5236 "+i(n).imageLinkType.selected+" \u56FE\u7247\u94FE\u63A5",placement:"top"},{default:_(()=>[m("span",{class:"btn-item flex-center",onClick:u}," \u590D\u5236\u94FE\u63A5 ")]),_:1},8,["content"])])])}}});var Vs=H(Ps,[["__scopeId","data-v-88d7032a"]]);const Ns={class:"image-box"},Gs={class:"info-box"},zs={class:"image-info"},js={key:0,class:"rename-operate"},Hs={key:1,class:"filename"},Xs={class:"copy-link-box"},Ks={class:"operation-box"},qs={class:"operation-left"},Ws={class:"operation-right"},Ys={class:"operation-btn"},Js=G({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,n=ee(),s=Tn(),o=$(()=>n.getters.getUserConfigInfo).value,u=$(()=>n.getters.getUserSettings).value,a=$(()=>s.path==="/management"),l=$(()=>lt(t.imageObj,o,u)),c=L(),p=L(""),g=L(!1),v=L(!1),D=L(!1),E=(w,h=!1)=>{h||(w.deleting=!0);const{owner:z,selectedRepo:W}=o,{path:ae,sha:R}=w;return new Promise(async A=>{await en(z,W,ae,R)?(h?(g.value=!1,B.success("\u66F4\u65B0\u6210\u529F")):B.success("\u5220\u9664\u6210\u529F"),await n.dispatch("DIR_IMAGE_LIST_REMOVE",w),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid),A(!0)):A(!1)})},d=w=>{Re.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${w.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{E(w)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},F=w=>{w.checked=!w.checked,n.commit("IMAGE_CARD",{imageObj:w})},S=async w=>{g.value=!0,p.value=Ht(w.name),setTimeout(()=>{var h;(h=c.value)==null||h.focus()},150)},b=async()=>{var z;const{imageObj:w}=t;if(!p.value){B.error("\u56FE\u7247\u540D\u4E0D\u80FD\u4E3A\u7A7A"),(z=c.value)==null||z.focus();return}if(p.value===Ht(w.name)){B.error("\u56FE\u7247\u540D\u65E0\u6539\u53D8"),g.value=!1;return}const h=async()=>{const W=Se.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),ae=ut(w.name),R=Fe(),A=`${p.value}.${R}.${ae}`,P=await Ia(l.value||"",ae);if(P){const U=zt();U.uuid=R,U.base64.originalBase64=P,U.filename.final=A,U.reUploadInfo.isReUpload=!0,U.reUploadInfo.dir=w.dir;let te=A;w.dir!=="/"&&(te=`${w.dir}/${A}`),U.reUploadInfo.path=te,await mn(o,U)?(p.value="",await E(w,!0),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid)):B.error("\u91CD\u547D\u540D\u5931\u8D25")}else B.error("\u91CD\u547D\u540D\u5931\u8D25");W.close(),g.value=!1};Re.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${p.value} \uFF1F`,"\u63D0\u793A",{type:"info"}).then(()=>{h()}).catch(()=>{console.log("\u53D6\u6D88\u91CD\u547D\u540D"),g.value=!1})},y=w=>{D.value=w},M=w=>{Re.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${w.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Ae(w.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(w,h)=>{const z=Ve,W=Be,ae=Le,R=On,A=Vs,P=re,U=Y("MoreFilled"),te=Dt,oe=It,pe=Ct,X=$e;return Z((f(),I("div",{class:se(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:h[6]||(h[6]=le=>v.value=!0),onMouseleave:h[7]||(h[7]=le=>v.value=!1)},[m("div",Ns,[r(z,{src:i(l),fit:"cover",loading:"lazy",lazy:"","data-fancybox":"gallery"},null,8,["src"])]),m("div",Gs,[m("div",zs,[g.value?(f(),I("div",js,[r(W,{size:"small",class:"rename-input",modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=le=>p.value=le),clearable:"",ref_key:"renameInputRef",ref:c,maxlength:i(Rt)},null,8,["modelValue","maxlength"]),r(R,{size:"small"},{default:_(()=>[r(ae,{icon:i(Un),onClick:h[1]||(h[1]=le=>g.value=!1)},null,8,["icon"]),r(ae,{icon:i(yt),onClick:be(b,["prevent"])},null,8,["icon","onClick"])]),_:1})])):(f(),I("div",Hs,T(e.imageObj.name),1))])]),m("div",Xs,[r(A,{"img-obj":e.imageObj},null,8,["img-obj"])]),Z(m("div",Ks,[m("div",qs,[i(a)?(f(),I("div",{key:0,class:se([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:h[2]||(h[2]=le=>F(e.imageObj))},[e.imageObj.checked?(f(),x(P,{key:0},{default:_(()=>[r(i(yt))]),_:1})):C("",!0)],2)):C("",!0)]),m("div",Ws,[r(pe,{size:"default",trigger:"click",onVisibleChange:y},{dropdown:_(()=>[r(oe,null,{default:_(()=>[r(te,{onClick:h[3]||(h[3]=le=>d(e.imageObj))},{default:_(()=>[k(" \u5220\u9664 ")]),_:1}),r(te,{onClick:h[4]||(h[4]=be(le=>S(e.imageObj),["self"]))},{default:_(()=>[k(" \u91CD\u547D\u540D ")]),_:1}),r(te,{onClick:h[5]||(h[5]=le=>M(e.imageObj))},{default:_(()=>[k(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:_(()=>[m("div",Ys,[r(P,null,{default:_(()=>[r(U)]),_:1})])]),_:1})])],512),[[Ce,v.value||D.value||e.imageObj.checked]])],34)),[[X,e.imageObj.deleting]])}}});var Qs=H(Js,[["__scopeId","data-v-baf0610e"]]);const _n=e=>(De("data-v-fba37bd4"),e=e(),Ie(),e),Zs=_n(()=>m("div",{class:"icon"},[m("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[m("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),m("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),eo={key:1,class:"text"},to={key:2,class:"icon"},no=_n(()=>m("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[m("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),ao=[no],so={key:3,class:"text"},oo=G({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,n=ee(),s=$(()=>n.getters.getUserConfigInfo).value,o=()=>{const{folderObj:u,mode:a}=t;if(a==="back"){const l=s.viewDir;if(l==="/")return;const c=l.split("/");c.length===1?s.viewDir="/":c.length>1&&(c.length-=1,s.viewDir=c.join("/"))}a==="dir"&&(s.viewDir=u.dirPath),n.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,a)=>{const l=ve;return f(),I("div",{class:"folder-card",onDblclick:o},[e.mode==="dir"?(f(),x(l,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:_(()=>[Zs]),_:1})):C("",!0),e.mode==="dir"?(f(),I("div",eo,T(e.folderObj.dir),1)):C("",!0),e.mode==="back"?(f(),I("div",to,ao)):C("",!0),e.mode==="back"?(f(),I("div",so,"\u53CC\u51FB\u540E\u9000")):C("",!0)],32)}}});var fn=H(oo,[["__scopeId","data-v-fba37bd4"]]);const uo={key:0,class:"selector-wrapper"},io={class:"selector-left-box"},lo={class:"item"},ro={class:"selector-right-box"},co=G({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,n=ee(),s=L(!1),o=$(()=>n.getters.getImageCardCheckedArr),u=$(()=>n.getters.getUserConfigInfo).value,a=$(()=>n.getters.getUserSettings).value,l=$(()=>o.value.length||0);ne(()=>l.value,D=>{const E=t.currentDirImageList.length;s.value=D===E});const c=()=>{qt(o.value,u,a)},p=()=>{t.currentDirImageList.forEach(D=>{D.checked&&(D.checked=!1)})},g=()=>{var D,E;((D=o.value)==null?void 0:D.length)>0?Re.confirm(`\u5DF2\u9009\u4E2D ${(E=o.value)==null?void 0:E.length} \u5F20\u56FE\u7247\uFF0C\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F`,"\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const d=await Da(o.value,u);d===Ee.deleted&&B.success("\u5220\u9664\u6210\u529F"),d===Ee.allDeleted&&B.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),d===Ee.deleteFail&&B.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):B.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},v=()=>{let D=[];t.currentDirImageList.forEach(E=>{E.checked=s.value}),D=t.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:D})};return ce(()=>{v()}),(D,E)=>{const d=vt,F=Y("CopyDocument"),S=re,b=ve,y=Y("Delete");return i(l)?(f(),I("div",uo,[m("div",io,[r(d,{label:s.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:s.value,"onUpdate:modelValue":E[0]||(E[0]=M=>s.value=M),onChange:v},null,8,["label","modelValue"]),m("div",lo,"\u5DF2\u9009\u62E9 "+T(i(l))+" \u5F20\u56FE\u7247",1),m("div",{class:"item cancel-select-btn",onClick:p},"\u53D6\u6D88\u9009\u62E9")]),m("div",ro,[r(b,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u94FE\u63A5"},{default:_(()=>[r(S,{class:"btn-icon",onClick:c},{default:_(()=>[r(F)]),_:1})]),_:1}),r(b,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:_(()=>[r(S,{class:"btn-icon",onClick:g},{default:_(()=>[r(y)]),_:1})]),_:1})])])):C("",!0)}}});var mo=H(co,[["__scopeId","data-v-fb405f6a"]]);const po=e=>(De("data-v-45520a6c"),e=e(),Ie(),e),_o={class:"page-container management-page-container"},fo={class:"content-container"},go={class:"top"},ho={class:"left"},Eo={class:"right flex-start"},Fo={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},vo={key:0,class:"image-management-item"},bo=po(()=>m("div",{style:{width:"100%"}},null,-1)),Do=G({__name:"imgs-management",setup(e){const t=ee(),n=xe(),s=$(()=>t.getters.getUserConfigInfo).value,o=$(()=>t.getters.getUserLoginStatus).value,u=$(()=>t.getters.getDirObject).value,a=L(new Date().getTime()),l=L(!1),c=L([]),p=L([]),g=L(!1);async function v(d){l.value=!0;const F=je(d,u);if(F){const S=He(d,F,"dir"),b=He(d,F,"image");!S.length&&!b.length?await We(s,d):(c.value=S,p.value=b,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:p.value}))}else await We(s,d);l.value=!1}async function D(){const{selectedDir:d,viewDir:F,dirMode:S}=s;if(F===""&&((S===K.newDir||S===K.autoDir)&&!je(d,u)&&(s.selectedDir="/",s.dirMode="rootDir"),s.selectedDir?s.viewDir=s.selectedDir:s.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await We(s,s.viewDir);return}await v(s.viewDir)}async function E(){const{viewDir:d}=s;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",d),l.value=!0,await We(s,d),l.value=!1}return ce(()=>{D()}),ne(()=>o,d=>{d===!1&&n.push("/config")}),ne(()=>s.viewDir,async d=>{await v(d),a.value+=1},{deep:!0}),ne(()=>u,d=>{const{viewDir:F}=s,S=je(F,d);S&&(c.value=He(F,S,"dir"),p.value=He(F,S,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:p.value}))},{deep:!0}),ne(()=>p.value,d=>{g.value=d.filter(F=>F.checked).length>0},{deep:!0}),(d,F)=>{const S=Y("Refresh"),b=re,y=ve,M=Mn("contextmenu"),w=$e;return f(),I("div",_o,[m("div",fo,[m("div",go,[m("div",ho,[r(un,{"bar-type":"management"})]),m("div",Eo,[r(y,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+i(s).viewDir+" \u76EE\u5F55\u5185\u5BB9"},{default:_(()=>[r(b,{class:"btn-icon",onClick:be(E,["stop"])},{default:_(()=>[r(S)]),_:1},8,["onClick"])]),_:1},8,["content"])])]),Z((f(),I("div",Fo,[p.value.length?(f(),x(mo,{currentDirImageList:p.value,"onUpdate:initImageList":p.value,key:a.value},null,8,["currentDirImageList","onUpdate:initImageList"])):C("",!0),Z((f(),I("ul",{class:"image-management-list",style:ke({height:g.value?"calc(100% - 50rem)":"100%"})},[i(s).viewDir!=="/"?(f(),I("li",vo,[r(fn,{mode:"back"})])):C("",!0),(f(!0),I(_e,null,fe(c.value,(h,z)=>Z((f(),I("li",{class:"image-management-item",key:"folder-card-"+h.dir+"-"+z},[r(fn,{"folder-obj":h},null,8,["folder-obj"])])),[[M,{type:i(ye).childDir,dir:h.dir}]])),128)),bo,(f(!0),I(_e,null,fe(p.value,(h,z)=>Z((f(),I("li",{class:"image-management-item image",key:"image-card-"+z},[r(Qs,{"image-obj":h},null,8,["image-obj"])])),[[M,{type:i(ye).img,img:h}]])),128))],4)),[[M,{type:i(ye).parentDir}]])])),[[w,l.value]])])])}}});var Io=H(Do,[["__scopeId","data-v-45520a6c"]]);const Co=["contenteditable","onFocusout"],yo={style:{"margin-top":"20px"}},Ao=G({__name:"image-link-rule-config",setup(e){const t=$(()=>V.getters.getUserSettings).value,n=L(),s=Ft({id:"",name:"",rule:"",editable:!0}),o=(l,c)=>{V.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:l,id:c})},u=l=>{Re.confirm(`<span>\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A</span><strong>${l.name}</strong>`,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{V.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l.id)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},a=l=>{!l||l.validate(c=>{if(c)s.id=Fe(),V.dispatch("ADD_IMAGE_LINK_TYPE_RULE",s);else return!1})};return(l,c)=>{const p=Pn,g=Le,v=Vn,D=At,E=Be,d=Ze,F=et,S=wt;return f(),x(S,null,{default:_(()=>[r(v,{data:i(t).imageLinkType.presetList,style:{width:"100%"}},{default:_(()=>[r(p,{prop:"name",label:"\u7C7B\u578B",width:"120"}),r(p,{label:"CDN \u89C4\u5219"},{default:_(b=>[m("div",{contenteditable:b.row.editable,onFocusout:y=>o(y.target.innerHTML,b.row.id)},T(b.row.rule),41,Co)]),_:1}),r(p,{label:"\u64CD\u4F5C",width:"80"},{default:_(b=>[r(g,{link:"",type:"danger",size:"small",disabled:!b.row.editable,onClick:y=>u(b.row)},{default:_(()=>[k(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),r(D),m("div",yo,[r(F,{ref_key:"formRef",ref:n,"label-position":"left",model:s,"label-width":"120px",size:"default"},{default:_(()=>[r(d,{label:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B",prop:"name",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[r(E,{modelValue:s.name,"onUpdate:modelValue":c[0]||(c[0]=b=>s.name=b),type:"text"},null,8,["modelValue"])]),_:1}),r(d,{label:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219",prop:"rule",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[r(E,{modelValue:s.rule,"onUpdate:modelValue":c[1]||(c[1]=b=>s.rule=b),type:"text"},null,8,["modelValue"])]),_:1}),r(d,null,{default:_(()=>[r(g,{type:"primary",disabled:!s.name||!s.rule,onClick:c[2]||(c[2]=b=>a(n.value))},{default:_(()=>[k(" \u6DFB\u52A0\u56FE\u7247\u94FE\u63A5\u89C4\u5219 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])]),_:1})}}});var wo=H(Ao,[["__scopeId","data-v-3fcb9f0e"]]);const Ye=e=>(De("data-v-d876ad10"),e=e(),Ie(),e),So={class:"compress-config-box"},ko=Ye(()=>m("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u7247\u538B\u7F29\u7B97\u6CD5\uFF1A",-1)),Bo=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u538B\u7F29\u7387\u8F83\u9AD8\uFF0C\u5927\u591A\u6570\u6D4F\u89C8\u5668\u652F\u6301",-1)),Lo=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF0C\u6240\u6709\u6D4F\u89C8\u5668\u652F\u6301",-1)),$o=Ye(()=>m("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u7387\u6781\u9AD8\uFF0C\u90E8\u5206\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301",-1)),xo=G({__name:"compress-config-box",emits:["encoder"],setup(e,{expose:t,emit:n}){const s=L(ue.webP),o=a=>{n("encoder",a)},u=()=>{s.value=ue.webP};return ce(()=>{n("encoder",s.value)}),t({reset:u}),(a,l)=>{const c=tt,p=nt;return f(),I("div",So,[ko,r(p,{class:"img-encoder-group",modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=g=>s.value=g),onChange:o},{default:_(()=>[r(c,{label:i(ue).webP},{default:_(()=>[k(T(i(ue).webP)+" ",1),Bo]),_:1},8,["label"]),r(c,{label:i(ue).mozJPEG},{default:_(()=>[k(T(i(ue).mozJPEG)+" ",1),Lo]),_:1},8,["label"]),r(c,{label:i(ue).avif},{default:_(()=>[k(T(i(ue).avif)+" ",1),$o]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}});var gn=H(xo,[["__scopeId","data-v-d876ad10"]]);const ie=e=>(De("data-v-92d0dcc8"),e=e(),Ie(),e),Ro={class:"page-container settings-page-container"},To=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u540D\u79F0\u8BBE\u7F6E\uFF1A",-1)),Uo={class:"setting-list"},Oo={class:"setting-item has-desc"},Mo=ie(()=>m("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u54C8\u5E0C\u7801\uFF0C\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),Po={class:"setting-item has-desc"},Vo=ie(()=>m("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u524D\u7F00\uFF0C\u4F8B\u5982\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00",-1)),No={key:0,class:"setting-item has-desc"},Go=ie(()=>m("div",{class:"setting-title"},"\u6C34\u5370\u8BBE\u7F6E\uFF1A",-1)),zo={class:"setting-list"},jo={class:"setting-item has-desc"},Ho=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6C34\u5370\u6587\u5B57\u3001\u5B57\u4F53\u5927\u5C0F\u3001\u4F4D\u7F6E\u548C\u900F\u660E\u5EA6",-1)),Xo={key:0,class:"setting-item"},Ko=ie(()=>m("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),qo={class:"setting-list"},Wo={class:"setting-item has-desc"},Yo=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u4E0A\u4F20\u524D\u4F1A\u81EA\u52A8\u538B\u7F29\u56FE\u7247\uFF0C\u6709\u6548\u7F29\u77ED\u56FE\u7247\u52A0\u8F7D\u65F6\u95F4\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),Jo={key:0,class:"setting-item"},Qo=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u914D\u7F6E\uFF1A",-1)),Zo={class:"setting-list"},eu={class:"setting-item cdn"},tu={class:"left"},nu={class:"right"},au={class:"setting-item has-desc"},su=ie(()=>m("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u65B0\u589E\u548C\u7BA1\u7406\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219",-1)),ou={key:0,class:"setting-item"},uu=ie(()=>m("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\u8BBE\u7F6E\uFF1A",-1)),iu={class:"setting-list"},lu={class:"setting-item has-desc"},ru={class:"desc"},cu={class:"setting-item"},du={class:"left"},mu={class:"right"},pu=ie(()=>m("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),_u={class:"setting-list"},fu={class:"setting-item"},gu={key:0,class:"setting-title"},hu={key:1,class:"setting-list"},Eu={class:"setting-item"},Fu=ie(()=>m("span",{class:"time-middle-space"}," ~ ",-1)),vu=G({__name:"my-settings",setup(e){const t=$(()=>V.getters.getUserSettings).value,n=L(!1),s=()=>{V.dispatch("USER_SETTINGS_PERSIST")},o=()=>{V.dispatch("SET_USER_SETTINGS",Pe({},t)),s()};return(u,a)=>{const l=St,c=Be,p=At,g=Ze,v=Nn,D=tt,E=nt,d=et,F=wt,S=gn,b=ht,y=Et,M=wo,w=Gn;return f(),I("div",Ro,[To,m("ul",Uo,[m("li",Oo,[r(l,{modelValue:i(t).defaultHash,"onUpdate:modelValue":a[0]||(a[0]=h=>i(t).defaultHash=h),onChange:s,"active-text":"\u81EA\u52A8\u54C8\u5E0C\u5316"},null,8,["modelValue"]),Mo]),m("li",Po,[r(l,{modelValue:i(t).prefixNaming.enable,"onUpdate:modelValue":a[1]||(a[1]=h=>i(t).prefixNaming.enable=h),onChange:s,"active-text":"\u6DFB\u52A0\u524D\u7F00\u547D\u540D"},null,8,["modelValue"]),Vo]),i(t).prefixNaming.enable?(f(),I("li",No,[r(c,{class:"prefix-input",modelValue:i(t).prefixNaming.prefix,"onUpdate:modelValue":a[2]||(a[2]=h=>i(t).prefixNaming.prefix=h),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:s,clearable:"",autofocus:""},null,8,["modelValue"])])):C("",!0)]),r(p),Go,m("ul",zo,[m("li",jo,[r(l,{modelValue:i(t).watermark.enable,"onUpdate:modelValue":a[3]||(a[3]=h=>i(t).watermark.enable=h),onChange:s,"active-text":"\u662F\u5426\u6DFB\u52A0\u6C34\u5370"},null,8,["modelValue"]),Ho]),i(t).watermark.enable?(f(),I("li",Xo,[r(F,null,{default:_(()=>[r(d,{"label-position":"left","label-width":"120rem"},{default:_(()=>[r(g,{label:"\u6C34\u5370\u6587\u5B57"},{default:_(()=>[r(c,{modelValue:i(t).watermark.text,"onUpdate:modelValue":a[4]||(a[4]=h=>i(t).watermark.text=h),clearable:"",maxlength:"10",onInput:s},null,8,["modelValue"])]),_:1}),r(g,{label:"\u5B57\u4F53\u5927\u5C0F"},{default:_(()=>[r(v,{modelValue:i(t).watermark.fontSize,"onUpdate:modelValue":a[5]||(a[5]=h=>i(t).watermark.fontSize=h),min:40,max:60,step:2,onChange:s},null,8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u4F4D\u7F6E"},{default:_(()=>[r(E,{modelValue:i(t).watermark.position,"onUpdate:modelValue":a[6]||(a[6]=h=>i(t).watermark.position=h),onChange:s},{default:_(()=>[r(D,{label:i(me).leftTop},{default:_(()=>[k("\u5DE6\u4E0A\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).leftBottom},{default:_(()=>[k("\u5DE6\u4E0B\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).rightTop},{default:_(()=>[k("\u53F3\u4E0A\u89D2")]),_:1},8,["label"]),r(D,{label:i(me).rightBottom},{default:_(()=>[k("\u53F3\u4E0B\u89D2")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u900F\u660E\u5EA6"},{default:_(()=>[r(v,{modelValue:i(t).watermark.opacity,"onUpdate:modelValue":a[7]||(a[7]=h=>i(t).watermark.opacity=h),precision:1,step:.1,min:.1,max:.9,onChange:s},null,8,["modelValue","step","min","max"])]),_:1})]),_:1})]),_:1})])):C("",!0)]),r(p),Ko,m("ul",qo,[m("li",Wo,[r(l,{modelValue:i(t).compress.enable,"onUpdate:modelValue":a[8]||(a[8]=h=>i(t).compress.enable=h),onChange:s,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"]),Yo]),i(t).compress.enable?(f(),I("li",Jo,[r(F,null,{default:_(()=>[r(S,{ref:"compressConfigBoxRef",style:{"margin-top":"10rem"},onEncoder:a[9]||(a[9]=h=>{i(t).compress.encoder=h,s()})},null,512)]),_:1})])):C("",!0)]),r(p),Qo,m("ul",Zo,[m("li",eu,[k(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A "),r(y,{modelValue:i(t).imageLinkType.selected,"onUpdate:modelValue":a[10]||(a[10]=h=>i(t).imageLinkType.selected=h),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u89C4\u5219",onChange:o},{default:_(()=>[(f(!0),I(_e,null,fe(i(t).imageLinkType.presetList,h=>(f(),x(b,{key:h.name+"-"+h.id,label:h.name,value:h.name,class:"image-link-type-rule-option"},{default:_(()=>[m("span",tu,T(h.name),1),m("span",nu,T(h.rule),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),m("li",au,[r(l,{modelValue:n.value,"onUpdate:modelValue":a[11]||(a[11]=h=>n.value=h),"active-text":"\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219"},null,8,["modelValue"]),su]),n.value?(f(),I("li",ou,[r(M)])):C("",!0)]),r(p),uu,m("ul",iu,[m("li",lu,[r(l,{modelValue:i(t).imageLinkFormat.enable,"onUpdate:modelValue":a[12]||(a[12]=h=>i(t).imageLinkFormat.enable=h),onChange:s,"active-text":"\u81EA\u52A8\u8F6C\u6362\u56FE\u7247\u94FE\u63A5\u683C\u5F0F"},null,8,["modelValue"]),m("span",ru," \u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u94FE\u63A5\u65F6\u4F7F\u7528 "+T(i(t).imageLinkFormat.selected)+" \u683C\u5F0F ",1)]),m("li",cu,[k(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\uFF1A "),r(y,{modelValue:i(t).imageLinkFormat.selected,"onUpdate:modelValue":a[13]||(a[13]=h=>i(t).imageLinkFormat.selected=h),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u683C\u5F0F",onChange:o},{default:_(()=>[(f(!0),I(_e,null,fe(i(t).imageLinkFormat.presetList,h=>(f(),x(b,{key:h.name,label:h.name,value:h.name,class:"image-link-type-rule-option"},{default:_(()=>[m("span",du,T(h.name),1),m("span",mu,T(h.format),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),r(p),pu,m("ul",_u,[m("li",fu,[k(" \u9009\u62E9\u4E3B\u9898\u6A21\u5F0F\uFF1A "),r(y,{modelValue:i(t).theme.mode,"onUpdate:modelValue":a[14]||(a[14]=h=>i(t).theme.mode=h),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:o},{default:_(()=>[r(b,{label:"\u6697\u591C\u4E3B\u9898",value:i(Q).dark},null,8,["value"]),r(b,{label:"\u767D\u663C\u4E3B\u9898",value:i(Q).light},null,8,["value"]),r(b,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:i(Q).auto},null,8,["value"])]),_:1},8,["modelValue"])])]),i(t).theme.mode===i(Q).auto?(f(),I("div",gu," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):C("",!0),i(t).theme.mode===i(Q).auto?(f(),I("ul",hu,[m("li",Eu,[r(d,{ref:"form"},{default:_(()=>[r(g,null,{default:_(()=>[r(w,{modelValue:i(t).theme.autoLightTime[0],"onUpdate:modelValue":a[15]||(a[15]=h=>i(t).theme.autoLightTime[0]=h),start:"00:00",step:"00:30",end:"23:59",onChange:o},null,8,["modelValue"]),Fu,r(w,{modelValue:i(t).theme.autoLightTime[1],"onUpdate:modelValue":a[16]||(a[16]=h=>i(t).theme.autoLightTime[1]=h),start:i(t).theme.autoLightTime[0],step:"00:30",end:"23:59",onChange:o},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):C("",!0)])}}});var bu=H(vu,[["__scopeId","data-v-92d0dcc8"]]);const Du={class:"page-container"},Iu={key:0,class:"tool-panel"},Cu={class:"panel-header"},yu={class:"panel-body"},Au={key:1,class:"toolbox"},wu=["onClick"],Su={class:"top"},ku={class:"left flex-center"},Bu={class:"right"},Lu={class:"bottom"},$u=G({__name:"picx-toolbox",setup(e){const t=xe(),n=L("/toolbox"),s=L(!1),o=L({path:"",icon:"",name:"",desc:"",uuid:""}),u=L([{name:"\u56FE\u7247\u538B\u7F29",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u4E0D\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\u7684\u79BB\u7EBF\u6781\u81F4\u538B\u7F29",icon:"MagicStick",uuid:Fe(),path:"/compress"}]),a=c=>{s.value=!0,o.value=Pe({},c),t.push(`${n.value}${c.path}`)};ne(()=>t.currentRoute.value,c=>{c.path===n.value&&(s.value=!1)},{deep:!0});const l=()=>{t.isReady().then(()=>{const c=t.currentRoute.value.path;if(n.value!==c){const p=c.substring(c.lastIndexOf("/")),g=u.value.find(v=>v.path===p);g&&a(g)}})};return ce(()=>{l()}),(c,p)=>{const g=zn,v=jn,D=Y("router-view"),E=re;return f(),I("div",Du,[s.value?(f(),I("div",Iu,[m("div",Cu,[r(v,{"separator-icon":"ArrowRight"},{default:_(()=>[r(g,{to:{path:n.value}},{default:_(()=>[k("\u5DE5\u5177\u7BB1")]),_:1},8,["to"]),r(g,null,{default:_(()=>[k(T(o.value.name),1)]),_:1})]),_:1})]),m("div",yu,[r(D)])])):(f(),I("ul",Au,[(f(!0),I(_e,null,fe(u.value,d=>(f(),I("li",{class:"tool-item",key:d.uuid,onClick:F=>a(d)},[m("div",Su,[m("div",ku,[r(E,{size:30},{default:_(()=>[(f(),x(kt(d.icon)))]),_:2},1024)]),m("div",Bu,T(d.name),1)]),m("div",Lu,T(d.desc),1)],8,wu))),128))]))])}}});var xu=H($u,[["__scopeId","data-v-1dd2822d"]]);const dt=e=>(De("data-v-5ae8a8cc"),e=e(),Ie(),e),Ru={class:"page-container feedback-page-container"},Tu=dt(()=>m("div",{class:"help-info-item description"}," \u{1F3DE}\uFE0F PicX \u662F\u4E00\u6B3E\u57FA\u4E8E GitHub API \u5F00\u53D1\u7684\u56FE\u5E8A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u56FE\u7247\u4E0A\u4F20\u6258\u7BA1\u3001\u751F\u6210\u56FE\u7247\u94FE\u63A5\u548C\u5E38\u7528\u56FE\u7247\u5DE5\u5177\u7BB1\u670D\u52A1\u3002 ",-1)),Uu={class:"help-info-item"},Ou={class:"help-info-item"},Mu={class:"help-info-item"},Pu={class:"help-info-item"},Vu={class:"help-info-item"},Nu=dt(()=>m("div",{class:"help-info-item",style:{"margin-bottom":"2rem"}}," \u{1F381} \u5982\u679C PicX \u5BF9\u4F60\u6709\u5E2E\u52A9\uFF0C\u6B22\u8FCE\u8D5E\u8D4F\u4F5C\u8005\uFF0C\u652F\u6301\u5F00\u6E90\u3002 ",-1)),Gu={class:"help-info-item img"},zu=dt(()=>m("div",{class:"help-info-item red-text"},[m("strong",null," \u26A0\uFE0F \u90D1\u91CD\u58F0\u660E\uFF1A\u8BF7\u52FF\u901A\u8FC7\u672C\u7AD9\u4E0A\u4F20\u8FDD\u53CD\u4F60\u5F53\u5730\u6CD5\u5F8B\u7684\u56FE\u7247\uFF0C\u6240\u9020\u6210\u7684\u4E00\u5207\u540E\u679C\u4E0E\u672C\u7AD9\u65E0\u5173\u3002 ")],-1)),ju=G({__name:"feedback-info",setup(e){const t=$(()=>Gt()==="win"?"Ctrl + D":"Command + D");return(n,s)=>{const o=Hn,u=Ve;return f(),I("div",Ru,[Tu,m("div",Uu,[k(" \u{1F30D} \u5EFA\u8BAE\u5C06\u672C\u7AD9\u6DFB\u52A0\u5230\u6D4F\u89C8\u5668\u6536\u85CF\u5939\uFF0C\u65B9\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002\u5FEB\u6377\u952E\uFF1A"),m("code",null,T(i(t)),1)]),m("div",Ou,[k(" \u{1F981} \u4F5C\u8005\uFF1A "),r(o,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:_(()=>[k("@XPoet")]),_:1})]),m("div",Mu,[k(" \u{1F300} \u4ED3\u5E93\uFF1A "),r(o,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:_(()=>[k(" https://github.com/XPoet/picx ")]),_:1})]),m("div",Pu,[k(" \u{1F4D6} \u6587\u6863\uFF1A "),r(o,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:_(()=>[k(" https://picx-docs.xpoet.cn ")]),_:1})]),m("div",Vu,[k(" \u{1F4A1} \u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u5982\u9047\u5230\u95EE\u9898\uFF0C\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u6587\u6863\uFF0C\u6216\u8005\u7ED9\u4F5C\u8005\u63D0\xA0 "),r(o,{type:"primary",style:{"font-size":"16rem"},href:"https://github.com/XPoet/picx/issues",target:"_blank"},{default:_(()=>[k(" Issue ")]),_:1}),k(" \xA0\u3002 ")]),Nu,m("div",Gu,[r(u,{style:{width:"300rem"},src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/common/appreciation.webp"})]),zu])}}});var Hu=H(ju,[["__scopeId","data-v-5ae8a8cc"]]);const Xu={class:"img-process-state-card-container"},Ku={class:"img-container","element-loading-text":"\u6B63\u5728\u538B\u7F29..."},qu={class:"info-container"},Wu={class:"img-name text-ellipsis"},Yu={class:"img-size"},Ju={key:0,class:"finial-file-size file-size-item"},Qu=G({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=o=>{jt(o)},s=o=>{t("remove",o)};return(o,u)=>{const a=Ve,l=Y("Remove"),c=re,p=ve,g=$e;return f(),I("div",Xu,[Z((f(),I("div",Ku,[r(a,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])])),[[g,e.imgObj.processing]]),m("div",qu,[m("div",Wu,T(e.imgObj.finialName||e.imgObj.originalName),1),m("div",Yu,[m("div",{class:se(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize}])},T(i(Ae)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize?(f(),I("div",Ju,T(i(Ae)(e.imgObj.finialSize))+" KB ",1)):C("",!0)])]),e.imgObj.finialFile?(f(),I("div",{key:0,class:"operate-container flex-center",onClick:u[0]||(u[0]=v=>n(e.imgObj.finialFile))}," \u70B9\u51FB\u4E0B\u8F7D ")):C("",!0),r(p,{placement:"top",offset:8,content:"\u5220\u9664"},{default:_(()=>[r(c,{class:"del-btn",onClick:u[1]||(u[1]=v=>s(e.imgObj.uuid))},{default:_(()=>[r(l)]),_:1})]),_:1})])}}});var Zu=H(Qu,[["__scopeId","data-v-42d0a1eb"]]);const ei={class:"compress-tool-container"},ti={key:0,class:"compress-tool-left"},ni=G({__name:"compress-tool",setup(e){const t=ee(),n=L(null),s=L(null),o=L([]),u=L(ue.webP),a=L(!1),l=L(!1),c=d=>{l.value=!1,a.value=!1,d.forEach(F=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:F.uuid,originalName:F.file.name,originalSize:F.file.size,originalBase64:F.base64,originalFile:F.file})})},p=d=>{l.value=!1,u.value=d},g=()=>{var d,F;t.dispatch("TOOLBOX_IMG_LIST_RESET"),l.value=!1,(d=n.value)==null||d.reset(),(F=s.value)==null||F.reset()},v=async()=>{a.value=!0;for(const d of o.value)d.processing=!0,d.finialFile=await Xt(d.originalFile,u.value),d.finialBase64=await Ke(d.finialFile)||"",d.finialSize=d.finialFile.size,d.finialName=d.finialFile.name,d.processing=!1;l.value=!0,a.value=!1},D=()=>{o.value.forEach(d=>{jt(d.finialFile)})},E=d=>{var F;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",d),(F=n.value)==null||F.remove(d)};return ne(()=>t.state.toolboxImageListModule.toolboxImageList,d=>{o.value=d},{immediate:!0,deep:!0}),(d,F)=>{const S=Zu,b=rn,y=gn,M=Le;return f(),I("div",ei,[o.value.length?(f(),I("div",ti,[(f(!0),I(_e,null,fe(o.value,w=>(f(),x(S,{"img-obj":w,key:w.uuid,onRemove:E},null,8,["img-obj"]))),128))])):C("",!0),m("div",{class:se(["compress-tool-right",{"no-img":!o.value.length}])},[r(b,{ref_key:"gettingImagesRef",ref:n,onGetImgList:c},null,512),r(y,{ref_key:"compressConfigBoxRef",ref:s,style:{"margin-top":"18rem"},onEncoder:F[0]||(F[0]=w=>p(w))},null,512),m("div",{class:se(["user-operate",{compressed:l.value&&o.value.length>1}])},[l.value&&o.value.length>1?(f(),x(M,{key:0,plain:"",type:"success",onClick:D},{default:_(()=>[k(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1})):C("",!0),m("div",null,[o.value.length?(f(),x(M,{key:0,plain:"",type:"warning",onClick:g},{default:_(()=>[k(" \u91CD\u7F6E ")]),_:1})):C("",!0),o.value.length?(f(),x(M,{key:1,disabled:a.value||l.value,plain:"",type:"primary",onClick:v},{default:_(()=>[k(" \u538B\u7F29 ")]),_:1},8,["disabled"])):C("",!0)])],2)],2)])}}});var ai=H(ni,[["__scopeId","data-v-3e4ce208"]]);const we=" | PicX \u56FE\u5E8A",si=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Ka,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${we}`}},{path:"/upload",name:"upload",component:Ts,meta:{title:`\u56FE\u7247\u4E0A\u4F20${we}`}},{path:"/management",name:"Management",component:Io,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${we}`}},{path:"/settings",name:"settings",component:bu,meta:{title:`\u6211\u7684\u8BBE\u7F6E${we}`}},{path:"/toolbox",name:"toolbox",component:xu,meta:{title:`\u5DE5\u5177\u7BB1${we}`},children:[{path:"/toolbox/compress",name:"compress",component:ai}]},{path:"/feedback",name:"feedback",component:Hu,meta:{title:`\u5E2E\u52A9\u53CD\u9988${we}`}}],Oe=Xn({history:Kn(),routes:si});Oe.beforeEach((e,t,n)=>{e.meta.title&&(window.document.title=e.meta.title),n()});const hn=()=>{const e=ee(),t=async o=>{await qn(()=>{const u=document.getElementsByTagName("html")[0];o===Q.dark&&(u.classList.remove("light"),u.classList.add("dark")),o===Q.light&&(u.classList.remove("dark"),u.classList.add("light"))})},n=o=>{const u=l=>{const c=new Date,p=c.getFullYear(),g=c.getMonth()+1,v=c.getDate();return new Date(`${p}/${g}/${v} ${o[l]}:00`).getTime()},a=Date.now();return u(0)<=a&&a<=u(1)},s=async o=>{const{theme:u}=o;u.mode===Q.auto?await t(n(u.autoLightTime)?Q.light:Q.dark):await t(u.mode)};ne(()=>e.getters.getUserSettings,async o=>{await s(o)},{deep:!0,immediate:!0})};const oi={id:"busuanzi_value_site_uv",class:"uv"},ui={id:"busuanzi_value_site_pv",class:"pv"},ii=G({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,n=L(null),s=L(!1),o=$(()=>!0),u=(a,l)=>a.querySelector(`.${l?"u":"p"}v`).innerText;return ce(()=>{const a=document.createElement("script");a.async=!0,a.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",n.value.appendChild(a),a.onload=()=>{const l=setTimeout(()=>{u(n.value,t.isuv)&&(s.value=!0),clearTimeout(l)},1500)}}),(a,l)=>Z((f(),I("span",{class:"site-count",ref_key:"siteCountDom",ref:n},[k(" \u8D85\u8FC7 "),Z(m("span",oi,null,512),[[Ce,e.isuv]]),Z(m("span",ui,null,512),[[Ce,!e.isuv]]),k(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[Ce,s.value&&i(o)]])}});var li="./assets/logo.206d082d.png";const En=e=>(De("data-v-1f5f4d49"),e=e(),Ie(),e),ri={class:"header"},ci={class:"header-left"},di=En(()=>m("div",{class:"logo"},[m("img",{src:li,alt:"PicX"})],-1)),mi=En(()=>m("div",{class:"title"},"PicX",-1)),pi=[di,mi],_i={class:"website-count"},fi={class:"header-right"},gi={class:"username"},hi={key:0,class:"avatar"},Ei={class:"el-dropdown-link"},Fi={class:"avatar"},vi=["src","alt"],bi=G({__name:"header-content",setup(e){const t=xe(),n=ee(),s=$(()=>n.getters.getUserConfigInfo).value,o=()=>{!s.logined&&t.currentRoute.value.path!=="/config"&&t.push("/config")},u=()=>{n.dispatch("LOGOUT"),t.push("/config")},a=l=>{switch(l){case"upload":t.push("/");break;case"config":t.push("/config");break;case"management":t.push("/management");break;case"logout":u();break}};return(l,c)=>{var F,S;const p=ii,g=Y("UserFilled"),v=re,D=Dt,E=It,d=Ct;return f(),I("header",ri,[m("div",ci,[m("div",{class:"brand",onClick:c[0]||(c[0]=b=>i(t).push("/"))},pi),m("div",_i,[r(p,{isuv:!1})])]),m("div",fi,[m("div",{class:"user-info",onClick:o},[m("div",gi,T(i(s).owner?i(s).owner:l.$t("header.notLogin")),1),((F=i(s))==null?void 0:F.avatarUrl)?C("",!0):(f(),I("div",hi,[r(v,{size:22},{default:_(()=>[r(g)]),_:1})])),((S=i(s))==null?void 0:S.avatarUrl)?(f(),x(d,{key:1,trigger:"click",onCommand:a},{dropdown:_(()=>[r(E,null,{default:_(()=>[r(D,{command:"logout"},{default:_(()=>[k(T(l.$t("header.logout")),1)]),_:1})]),_:1})]),default:_(()=>{var b,y;return[m("span",Ei,[m("span",Fi,[m("img",{src:(b=i(s))==null?void 0:b.avatarUrl,alt:(y=i(s))==null?void 0:y.owner},null,8,vi)])])]}),_:1})):C("",!0)])])])}}});var Di=H(bi,[["__scopeId","data-v-1f5f4d49"]]);const Ii=[{name:"nav.config",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"nav.upload",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"nav.management",icon:"picture",isActive:!1,path:"/management",isShow:!0},{name:"nav.settings",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"nav.toolbox",icon:"files",isActive:!1,path:"/toolbox",isShow:!0},{name:"nav.feedback",icon:"chat-dot-round",isActive:!1,path:"/feedback",isShow:!0}];const Ci={class:"nav"},yi={class:"nav-list"},Ai=["onClick"],wi={class:"nav-content"},Si={class:"nav-name"},ki={class:"nav-content"},Bi={class:"nav-name"},Li={class:"quick-actions-box"},$i=G({__name:"nav-content",setup(e){const t=xe(),n=ee(),s=$(()=>n.getters.getUserConfigInfo).value,o=$(()=>n.getters.getUserSettings).value,u=$(()=>{switch(o.elementPlusSize){case J.small:return 22;case J.large:return 30;default:return 26}}),a=L(o.theme.mode===Q.dark),l=L(Ii),c=L(!1),p=E=>{const{path:d}=E;if(d==="/management"){if(s.selectedRepo===""){B.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),t.push("/config");return}if(s.selectedDir===""){B.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),t.push("/config");return}}t.push(d)},g=E=>{l.value.forEach(d=>{const F=d;return F.isActive=d.path===E||E.includes(d.path),F})},v=()=>{n.dispatch("USER_SETTINGS_PERSIST")},D=()=>{o.theme.mode===Q.dark?o.theme.mode=Q.light:o.theme.mode=Q.dark,v()};return ne(()=>t.currentRoute.value,E=>{g(E.path)}),ne(()=>s.logined,E=>{l.value.forEach(d=>{switch(d.path){case"/management":case"/settings":d.isShow=E}})},{deep:!0,immediate:!0}),bt(()=>{t.isReady().then(()=>{const E=`/${t.currentRoute.value.path.split("/")[1]}`;g(E)})}),ce(()=>{var E,d;t.isReady().then(()=>{g(t.currentRoute.value.path)}),(E=document.querySelector(".quick-actions .quick-actions-box"))==null||E.addEventListener("click",F=>{c.value=!0,F.stopPropagation()}),(d=document.querySelector(".quick-actions"))==null||d.addEventListener("click",F=>{c.value=!c.value,F.stopPropagation()}),document.addEventListener("click",()=>{c.value&&(c.value=!1)})}),(E,d)=>{const F=re,S=Y("Operation"),b=St;return f(),I("aside",Ci,[m("ul",yi,[(f(!0),I(_e,null,fe(l.value,(y,M)=>Z((f(),I("li",{class:se(["nav-item flex-center",{active:y.isActive}]),key:M,onClick:w=>p(y)},[m("div",wi,[r(F,{size:i(u)},{default:_(()=>[(f(),x(kt(y.icon)))]),_:2},1032,["size"]),m("span",Si,T(E.$t(y.name)),1)])],10,Ai)),[[Ce,y.isShow]])),128))]),m("div",{class:se(["nav-item quick-actions flex-center",{active:c.value}])},[m("div",ki,[r(F,{size:i(u)},{default:_(()=>[r(S)]),_:1},8,["size"]),m("span",Bi,T(E.$t("nav.actions")),1)]),Z(m("div",Li,[r(b,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=y=>a.value=y),class:"mb-2","active-text":E.$t("actions.night"),onChange:D},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).watermark.enable,"onUpdate:modelValue":d[1]||(d[1]=y=>i(o).watermark.enable=y),class:"mb-2","active-text":E.$t("actions.watermark"),onChange:v},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).compress.enable,"onUpdate:modelValue":d[2]||(d[2]=y=>i(o).compress.enable=y),class:"mb-2","active-text":E.$t("actions.compress"),onChange:v},null,8,["modelValue","active-text"]),r(b,{modelValue:i(o).imageLinkFormat.enable,"onUpdate:modelValue":d[3]||(d[3]=y=>i(o).imageLinkFormat.enable=y),class:"mb-2","active-text":E.$t("actions.transform")+i(o).imageLinkFormat.selected,onChange:v},null,8,["modelValue","active-text"])],512),[[Ce,c.value]])],2)])}}});var xi=H($i,[["__scopeId","data-v-76eac6e8"]]);const Ri={class:"main-container"},Ti={class:"top-container"},Ui={class:"bottom-container"},Oi={class:"bottom-content"},Mi={class:"left"},Pi={class:"right"},Vi=G({__name:"main-container",setup(e){return ce(()=>{hn()}),(t,n)=>{const s=Y("router-view");return f(),I("main",Ri,[m("div",Ti,[r(Di)]),m("div",Ui,[m("div",Oi,[m("div",Mi,[r(xi)]),m("div",Pi,[r(s)])])])])}}});var Ni=H(Vi,[["__scopeId","data-v-c5c7351e"]]);const Gi=G({__name:"App",setup(e){const t=ee(),n=L("default"),s=o=>{o<=600?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.small}),n.value=J.small):o<=900?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.default}),n.value=J.default):(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:J.large}),n.value=J.large)};return ce(()=>{hn(),s(window.innerWidth),window.addEventListener("resize",ga(o=>{s(o.target.innerWidth)},800))}),(o,u)=>(f(),x(i(Yn),{size:n.value,"z-index":3e3,locale:i(Wn)},{default:_(()=>[r(Ni)]),_:1},8,["size","locale"]))}}),zi={notLogin:"\u672A\u767B\u5F55",logout:"\u9000\u51FA\u767B\u5F55"},ji={config:"\u56FE\u5E8A\u914D\u7F6E",upload:"\u4E0A\u4F20\u56FE\u7247",management:"\u56FE\u5E8A\u7BA1\u7406",settings:"\u6211\u7684\u8BBE\u7F6E",toolbox:"\u5DE5\u5177\u7BB1",feedback:"\u5E2E\u52A9\u53CD\u9988",actions:"\u5FEB\u6377\u64CD\u4F5C"},Hi={night:"\u6697\u591C\u6A21\u5F0F",watermark:"\u6DFB\u52A0\u6C34\u5370",compress:"\u538B\u7F29\u56FE\u7247",transform:"\u8F6C\u6362 "};var Xi={header:zi,nav:ji,actions:Hi};const Ki={notLogin:"Not Login",logout:"Logout"},qi={config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},Wi={night:"Night Mode",compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "};var Yi={header:Ki,nav:qi,actions:Wi};const Ji=Jn({locale:"zh-CN",messages:{"zh-CN":Xi,"en-US":Yi}}),Fn="custom-contextmenu-container";let j=null,mt=!1;const Qi={mounted(e,t){e.addEventListener("contextmenu",n=>{const{dir:s,type:o,img:u}=t.value;n.preventDefault(),n.stopPropagation();const a=$(()=>V.getters.getUserViewDir).value,l=s?`${a==="/"?"":`${a}/`}${s}`:a;j=document.querySelector(`.${Fn}`),j||(j=document.createElement("ul"),j.setAttribute("class",Fn),j.style.position="fixed",j.style.zIndex="1000",j.innerHTML='<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">\u590D\u5236\u56FE\u7247\u94FE\u63A5</li>',document.body.appendChild(j));const c=j==null?void 0:j.querySelector(".upload-image"),p=j==null?void 0:j.querySelector(".copy-link");o===ye.img?(p.style.display="block",c.innerHTML="\u4ECE\u5F53\u524D\u4F4D\u7F6E\u4E0A\u4F20\u65B0\u56FE\u7247"):(p.style.display="none",c.innerHTML=`\u4E0A\u4F20\u56FE\u7247\u5230 < ${l==="/"?"\u6839\u76EE\u5F55":l} > \u76EE\u5F55`);let g=n.clientX,v=n.clientY;const D=j.clientWidth,E=j.clientHeight,d=document.documentElement.clientWidth,F=document.documentElement.clientHeight,S=6;D+g>d&&(g=d-D-S),E+v>F&&(v=F-E-S),j.style.top=`${v}px`,j.style.left=`${g}px`,mt||(mt=!0,c==null||c.addEventListener("click",async()=>{const y=l==="/"?K.rootDir:K.repoDir,M=l==="/"?[]:l.split("/");await V.dispatch("SET_USER_CONFIG_INFO",{dirMode:y,selectedDir:l,selectedDirList:M}),await Oe.push("/upload")}),p==null||p.addEventListener("click",async()=>{const y=$(()=>V.getters.getUserConfigInfo).value,M=$(()=>V.getters.getUserSettings).value;qe(u,y,M)}));const b=()=>{j&&(document.removeEventListener("click",b),document.body.removeChild(j),j=null,mt=!1)};document.addEventListener("click",b)})}};const pt=Qn(Gi);pt.directive("contextmenu",Qi);for(const[e,t]of Object.entries(Zn))pt.component(e,t);pt.use(Oe).use(V,Yt).use(Ji).mount("#app");
