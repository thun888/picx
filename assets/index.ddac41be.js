var An=Object.defineProperty;var Et=Object.getOwnPropertySymbols;var wn=Object.prototype.hasOwnProperty,Sn=Object.prototype.propertyIsEnumerable;var Ft=(e,t,n)=>t in e?An(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t)=>{for(var n in t||(t={}))wn.call(t,n)&&Ft(e,n,t[n]);if(Et)for(var n of Et(t))Sn.call(t,n)&&Ft(e,n,t[n]);return e};import{A as kn,E as x,a as Se,C as Bn,e as Ln,d as $n,b as xn,c as Tn,f as Rn,u as On,g as G,h as L,i as Un,o as f,j as $,n as ke,k as l,r as J,l as b,m as r,w as _,p as re,q as ve,s as k,t as te,v as Be,x as Qe,y as Ce,z as et,B as vt,D as bt,F as tt,G as nt,H as Le,I as ne,J as C,K as be,L as S,M as O,N as ce,O as de,P as Mn,Q as d,R as me,S as Pn,T as se,U as De,V as Ie,W as Dt,X as Ve,Y as It,Z as $e,_ as Ct,$ as Vn,a0 as yt,a1 as At,a2 as wt,a3 as Nn,a4 as St,a5 as xe,a6 as Te,a7 as Gn,a8 as jn,a9 as zn,aa as Hn,ab as kt,ac as Bt,ad as Lt,ae as Xn,af as Kn,ag as Wn,ah as Yn,ai as $t,aj as qn,ak as Jn,al as Zn,am as Qn,an as ea,ao as ta,ap as na,aq as aa,ar as sa,as as oa}from"./vendor.868ba052.js";const ua=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};ua();const ia="XPoet/picx",Ne="picx-images-hosting",la="PicX images hosting repository",Ge="master",ra="Upload image via PicX(https://github.com/XPoet/picx)",ca="Upload images via PicX(https://github.com/XPoet/picx)",da="Delete image via PicX(https://github.com/XPoet/picx)",ma="https://api.github.com",pa=3e5,at="PICX_",st=`${at}CONFIG`,xt=`${at}MANAGEMENT`,Tt=`${at}SETTINGS`,Rt=5,Ot=30,Ut=18,Mt=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Pt=ma,je=kn.create({baseURL:Pt,timeout:pa});je.defaults.headers["Content-Type"]="application/json";je.interceptors.request.use(e=>{var n;const t=Mt(st);if(t){const{token:a}=t;((n=e.baseURL)==null?void 0:n.includes(Pt))&&a&&(e.headers.Authorization=`token ${a}`)}return e},e=>Promise.reject(e));je.interceptors.response.use(e=>e,e=>((e==null?void 0:e.response)||x.error({duration:6e3,message:`${e}`}),Promise.reject(e.response)));function W(e){const t={};e.method=e.method.toUpperCase();for(const n in e)n==="params"?e.method==="GET"?t.params=e.params:t.data=e.params:t[n]=e[n];return new Promise(n=>{je.request(t).then(a=>{const{status:o,data:i}=a;n(a&&(o===200||o===201||o===204)?i||"SUCCESS":null)}).catch(a=>{var o;if((t==null?void 0:t.success422)&&(a==null?void 0:a.status)===422)n((a==null?void 0:a.data)||"SUCCESS");else{const i=a==null?void 0:a.status,s=(o=a==null?void 0:a.data)==null?void 0:o.message;(t==null?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",a),i!==void 0&&s!==void 0&&x.error({duration:6e3,message:`Code: ${i}, Message: ${s}`})),n(null)}})})}const Vt=e=>W({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),_a=(e=ia)=>W({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}),fa=(e,t=1)=>new Promise(async n=>{const a=await W({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:t}});a&&a.length?n(a.filter(o=>!o.fork&&!o.private).map(o=>({value:o.name,label:o.name}))):n(null)}),Nt=async e=>{const t=[];for(let n=1;n<=3;n++){const a=await fa(e,n);a&&t.push(...a)}return Promise.resolve(t.length?t:null)},Gt=async(e,t=!0)=>{const n=`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).
        `,{owner:a,selectedRepo:o,selectedBranch:i}=e;let s=null;t&&(s=Se.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."})),await W({url:`/repos/${a}/${o}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:i,content:window.btoa(n)},noShowErrorMsg:!0})?s==null||s.close():t&&x.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")},ga=e=>W({url:"/user/repos",method:"POST",params:{name:Ne,description:la,private:!1},headers:{Authorization:`token ${e}`},success422:!0}),Re=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),ha=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},Ea=e=>{if(e==="/")return[];const t=e.split("/"),n=[];let a="";return t.forEach((o,i)=>{a+=`${i>0?"/":""}${o}`,n.unshift(a)}),n};function jt(e,t,n){var a;return e?t.length===n?e:jt((a=e.childrenDirs)==null?void 0:a.find(o=>o.dir===t[n]),t,++n):null}const ze=(e,t)=>{if(e==="/")return t;const n=e.split("/");return jt(t,n,0)},He=(e,t,n)=>{var a;return n==="dir"?(a=t.childrenDirs)==null?void 0:a.filter(o=>o.type==="dir"):n==="image"?t.imageList.filter(o=>o.type==="image"):[]},Fa=()=>{const e=localStorage.getItem(xt);return e?JSON.parse(e):Re("/","/")},va={state:{name:"dirImageListModule",dirObject:Fa()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(u,c,m)=>u?(u.childrenDirs.some(D=>D.dir===c)||u.childrenDirs.push(Re(c,m)),u.childrenDirs.find(D=>D.dir===c)||Re(c,m)):Re(c,m),o=n.split("/");let i="",s=e.dirObject;for(let u=0,c=o.length;u<c;u++){const m=o[u];i+=`${u>0?"/":""}${m}`,s=a(s,m,i),u===0&&t("USER_CONFIG_INFO_ADD_DIR",m)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(s,u,c)=>{if(u==="/")return e.dirObject;const m=s.childrenDirs.find(g=>g.dir===u);if(!m)return s;if(c){const g=s.childrenDirs.findIndex(D=>D.dir===u);g!==-1&&s.childrenDirs.splice(g,1)}return m},o=n.split("/");let i=e.dirObject;o.forEach((s,u)=>{i=a(i,s,u===o.length-1),u===0&&t("USER_CONFIG_INFO_REMOVE_DIR",s)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},n){const a=(i,s,u,c,m=!1)=>{var D;if(!i)return e.dirObject;let g=(D=i.childrenDirs)==null?void 0:D.find(h=>h.dir===s);return g||(g={type:"dir",dir:s,dirPath:u,childrenDirs:[],imageList:[]},i.childrenDirs.push(g)),m&&!g.imageList.some(h=>h.name===c.name)&&g.imageList.push(c),g};let o=e.dirObject;if(n.dir==="/")o.imageList.some(i=>i.name===n.name)||o.imageList.push(n);else{const i=n.dir.split("/");let s="";i.forEach((u,c)=>{s+=`${c>0?"/":""}${u}`,o=a(o,u,s,n,c===i.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},n){const a=(m,g)=>{if(m.length){const D=m.findIndex(h=>h.uuid===g);D!==-1&&m.splice(D,1)}},o=(m,g,D,h)=>{if(!m)return e.dirObject;const F=m.childrenDirs.find(p=>p.dir===g);return F?(F.dir===g&&h&&a(F.imageList,D.uuid),F):e.dirObject},{dir:i,uuid:s}=n;if(i==="/"){a(e.dirObject.imageList,s),t("DIR_IMAGE_LIST_PERSIST");return}const u=i.split("/");let c=e.dirObject;u.forEach((m,g)=>{c=o(c,m,n,g===u.length-1),!c.imageList.length&&!c.childrenDirs.length&&Ea(c.dirPath).forEach(h=>{const F=ze(h,e.dirObject);if(F&&!F.imageList.length&&!F.childrenDirs.length){const{dirPath:p}=ha(h);t("SET_USER_CONFIG_INFO",{viewDir:p}),t("DIR_IMAGE_LIST_REMOVE_DIR",h)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},n){let a=e.dirObject;if(n==="/"){a.imageList=[],a.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const o=(s,u,c)=>{var g;if(!s)return e.dirObject;const m=(g=s.childrenDirs)==null?void 0:g.find(D=>D.dir===u);return m?(c&&(m.imageList=[],m.childrenDirs=[]),m):e.dirObject},i=n.split("/");i.forEach((s,u)=>{a=o(a,s,u===i.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(xt,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Re("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var Ee;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(Ee||(Ee={}));var Fe;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(Fe||(Fe={}));var ue;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(ue||(ue={}));var pe;(function(e){e.newBranch="newBranch",e.repoBranch="repoBranch"})(pe||(pe={}));var Y;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.repoDir="repoDir"})(Y||(Y={}));var Z;(function(e){e.large="large",e.default="default",e.small="small"})(Z||(Z={}));var _e;(function(e){e.leftTop="leftTop",e.leftBottom="leftBottom",e.rightTop="rightTop",e.rightBottom="rightBottom"})(_e||(_e={}));var Q;(function(e){e.auto="auto",e.light="light",e.dark="dark"})(Q||(Q={}));var ye;(function(e){e[e.parentDir=0]="parentDir",e[e.childDir=1]="childDir",e[e.img=2]="img"})(ye||(ye={}));const zt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},fe=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),ot=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{t&&t()})},Ht=e=>{for(const t in e)switch(zt(e[t])){case"object":Ht(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},ut=(e,t)=>{for(const n in t)zt(t[n])!=="object"?e&&(e[n]=t[n]):ut(e[n],t[n])},it=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},Xe=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function n(i){return`00${i}`.substr(i.length)}const a=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${a.getFullYear()}`.substr(4-RegExp.$1.length)));const o={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds()};for(const i in o)if(new RegExp(`(${i})`).test(e)){const s=`${o[i]}`;e=e.replace(RegExp.$1,RegExp.$1.length===1?s:n(s))}return e},ba=(e,t=500)=>{let n,a;function o(...i){a=i,n||(n=setTimeout(()=>{e(...a),n=void 0},t))}return o};function Da(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=()=>{const o=new Image;o.setAttribute("crossOrigin","Anonymous"),o.onload=()=>t(o),o.onerror=n,o.src=a.result},a.onerror=n,a.readAsDataURL(e)})}async function Ia(e,t){const{text:n,fontSize:a,position:o,opacity:i}=t,s=await Da(e),u=document.createElement("canvas"),c=u.getContext("2d");u.width=s.width,u.height=s.height,c.drawImage(s,0,0),c.font=`bold ${a}px Arial`,c.strokeStyle=`rgba(0, 0, 0, ${i})`,c.lineWidth=3,c.fillStyle=`rgba(255, 255, 255, ${i})`;let m=0,g=0;switch(o){case _e.leftTop:m=10,g=a+5;break;case _e.rightTop:m=u.width-c.measureText(n).width-10,g=a+5;break;case _e.leftBottom:m=10,g=u.height-15;break;case _e.rightBottom:m=u.width-c.measureText(n).width-10,g=u.height-15;break}return c.strokeText(n,m,g),c.fillText(n,m,g),new Promise(D=>{u.toBlob(h=>{if(!h)D(null);else{const F=new File([h],e.name,{type:e.type});D(F)}},e.type)})}const Xt=()=>({uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isHashRename:!0,isRename:!1,isPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}}),Ca=(e,t)=>({type:"image",uuid:fe(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});async function ya(e,t){e.deleting=!0;const{owner:n,selectedRepo:a}=t,{path:o,sha:i}=e;return new Promise(async s=>{const u=await on(n,a,o,i);e.deleting=!1,u?(s(!0),await V.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await V.dispatch("DIR_IMAGE_LIST_REMOVE",e)):s(!1)})}const Oe=(e,t=!1)=>{e.forEach(n=>{n.deleting=t})};async function Aa(e,t){Oe(e,!0);const{owner:n,selectedRepo:a,selectedBranch:o}=t,i=await an(n,a,o);if(!i)throw Oe(e,!1),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const s=await un(n,a,e.map(m=>({path:m.path,sha:null})),i);if(!s)throw Oe(e,!1),new Error("\u521B\u5EFA tree \u5931\u8D25");const u=await ln(n,a,s,i);if(!u)throw Oe(e,!1),new Error("\u521B\u5EFA commit \u5931\u8D25");if(!await rn(n,a,o,u.sha))throw Oe(e,!1),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(m=>{m.deleting=!1,V.dispatch("UPLOAD_IMG_LIST_REMOVE",m.uuid),V.dispatch("DIR_IMAGE_LIST_REMOVE",m)})}async function wa(e,t){if(e.length===1)return await ya(e[0],t)?Fe.deleted:Fe.deleteFail;try{return await Aa(e,t),Fe.allDeleted}catch(n){return console.error(n),Fe.deleteFail}}function Sa(e,t){const n=document.createElement("canvas"),a=n.getContext("2d"),o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(i=>{o.onload=()=>{const{width:s}=o,{height:u}=o;n.width=s,n.height=u,a==null||a.drawImage(o,0,0,s,u);const c=n.toDataURL(`image/${t}`);i(c)}})}function ka(e){return new Promise(t=>{W({baseURL:"",url:e,method:"GET",responseType:"blob"}).then(n=>{if(n){const a=new FileReader;a.onload=()=>{const o=a.result;t(o)},a.onerror=()=>{t(null)},a.readAsDataURL(n)}else t(null)}).catch(()=>{t(null)})})}function Ke(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{const a=n.result;t(a)},n.onerror=()=>t(null)})}function Kt(e){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}const Wt=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},lt=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},rt=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),Ba=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),La=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),Ae=e=>e&&Number((e/1024).toFixed(0)),$a=e=>new Promise(async t=>{e||t(null),rt(e.type)||(x.error(`${e.name} \u4E0D\u662F\u56FE\u7247\u683C\u5F0F`),t(null));const n=await Ke(e)||"";Ae(n.length)>=Ot*1024&&(x.error(`${e.name} \u8D85\u8FC7 ${Ot} MB\uFF0C\u8DF3\u8FC7\u9009\u62E9`),t(null)),t({uuid:fe(),base64:n,file:e})}),Yt=async(e,t)=>Ba(e.type)?new Bn(e,{encoderState:{type:t,options:Ln[t].meta.defaultOptions},processorState:$n,preprocessorState:xn}).process():e,ct=(e,t,n)=>{var i;const a=n.imageLinkType.selected,o=(i=n.imageLinkType.presetList.find(s=>s.name===a))==null?void 0:i.rule;if(o){const{owner:s,selectedRepo:u,selectedBranch:c}=t;return o.replaceAll("{{owner}}",s).replaceAll("{{repo}}",u).replaceAll("{{branch}}",c).replaceAll("{{path}}",e.path)}return null},qt=(e,t,n)=>{var a;if(n.imageLinkFormat.enable){const o=n.imageLinkFormat.selected,i=(a=n.imageLinkFormat.presetList.find(s=>s.name===o))==null?void 0:a.format;if(i)return i.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},Jt=(e,t=6500)=>{Tn({type:"success",title:"\u590D\u5236\u6210\u529F",message:e,duration:t,offset:50})},Zt=()=>`${it()==="mac"?"Command":"Ctrl"} + V`,We=(e,t,n,a=!1)=>{const o=qt(ct(e,t,n),e.name,n);o?ot(o,()=>{const i=`${e.name} \u56FE\u7247\u94FE\u63A5\u5DF2${a?"\u81EA\u52A8":""}\u590D\u5236\u5230\u7CFB\u7EDF\u526A\u8D34\u677F\uFF0C\u53EF\u4F7F\u7528\u5FEB\u6377\u952E ${Zt()} \u8FDB\u884C\u7C98\u8D34\u3002`;Jt(i)}):x.error("\u590D\u5236\u5931\u8D25")},Qt=(e,t,n,a=!1)=>{if((e==null?void 0:e.length)>0){let o="";e.forEach((i,s)=>{o+=`${qt(ct(i,t,n),i.name,n)}${s<e.length-1?`
`:""}`}),ot(o,()=>{const i=`\u5DF2${a?"\u81EA\u52A8":""}\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5\u5230\u7CFB\u7EDF\u526A\u8D34\u677F\uFF0C\u53EF\u4F7F\u7528\u5FEB\u6377\u952E ${Zt()} \u8FDB\u884C\u7C98\u8D34\u3002`;Jt(i)})}else console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},en=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:pe.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:Y.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(st);return t&&(ut(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===Y.autoDir&&(e.selectedDir=Xe("yyyyMMdd"))),e},xa=e=>{const{selectedDir:t,selectedBranch:n,dirMode:a}=e.userConfigInfo;if(a==="newDir"){const o=t.split("");let i=0,s="";const u=[" ",".","\u3001",",","\uFF0C","!","\uFF1F","?"];for(let c=0;c<o.length&&(u.some(m=>m===o[c])&&(o[c]="-"),o[c]==="/"&&(i+=1),!(i>=Rt));c++)s+=o[c];e.userConfigInfo.selectedDir=s}e.userConfigInfo.selectedBranch=n.replace(/\s+/g,"-")},Ta={state:{userConfigInfo:en()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=en()},SET_USER_CONFIG_INFO({state:e,dispatch:t},n){for(const a in n)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=n[a]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},n){e.userConfigInfo.dirList.some(a=>a.value===n)||(e.userConfigInfo.dirList.push({label:n,value:n}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},n){const{dirList:a}=e.userConfigInfo;if(a.some(o=>o.value===n)){const o=a.findIndex(i=>i.value===n);a.splice(o,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){xa(e),localStorage.setItem(st,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Ht(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},Ra={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:n,checked:a}=t;a&&e.imgCardArr.forEach(o=>{o.uuid===n&&(o.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},Oa={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},dt={defaultHash:!0,prefixNaming:{enable:!1,prefix:""},compress:{enable:!0,encoder:ue.webP},theme:{mode:Q.light,autoLightTime:["08:00","19:00"]},elementPlusSize:Z.default,imageLinkType:{selected:"Staticaly",presetList:[{id:fe(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:fe(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:fe(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:fe(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:_e.rightBottom,opacity:.5}},Ua=()=>{const e=Mt(Tt);return e&&ut(dt,e),dt},Ma={state:{userSettings:Ua()},actions:{SET_USER_SETTINGS({state:e},t){for(const n in t)e.userSettings.hasOwnProperty(n)&&(e.userSettings[n]=t[n])},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){e.userSettings.imageLinkType.presetList.some(o=>o.name===n.name)?x.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u89C4\u5219\u5DF2\u5B58\u5728"):n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")?(e.userSettings.imageLinkType.presetList.push(n),t("USER_SETTINGS_PERSIST")):x.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5")},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){if(n.rule.includes("{{owner}}")&&n.rule.includes("{{repo}}")&&n.rule.includes("{{branch}}")&&n.rule.includes("{{path}}")){const a=e.userSettings.imageLinkType.presetList.find(o=>o.id===n.id);a&&(a.rule=n.rule,t("USER_SETTINGS_PERSIST"))}else x.error("\u4FEE\u6539\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u5408\u6CD5")},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){const a=e.userSettings.imageLinkType.presetList;a.splice(a.findIndex(o=>o.id===n),1),t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Tt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=dt}},getters:{getUserSettings:e=>e.userSettings}},Pa={state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const n=e.toolboxImageList.findIndex(a=>a.uuid===t);n!==-1&&e.toolboxImageList.splice(n,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},Va={state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const n=e.uploadImageList.findIndex(a=>a.uuid===t);n!==-1&&e.uploadImageList[n].uploadStatus.progress===0&&e.uploadImageList.splice(n,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},V=Rn({modules:{dirImageListModule:va,userConfigInfoModule:Ta,imageCardModule:Ra,uploadAreaActiveModule:Oa,userSettingsModule:Ma,toolboxImageListModule:Pa,uploadImageListModule:Va},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),tn=Symbol("vuex-store");function ee(){return On(tn)}const nn=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:o}=e;return new Promise(async i=>{const s=await W({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{ref:o}});s&&s.length?i(s.filter(u=>u.type==="dir").map(u=>({value:u.name,label:u.name}))):i(null)})},Ye=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:o}=e;return new Promise(async i=>{const s=await W({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{"no-cache":fe(),ref:o}});s&&s.length?(s.filter(u=>u.type==="dir").forEach(u=>V.dispatch("DIR_IMAGE_LIST_ADD_DIR",u.path)),setTimeout(()=>{s.filter(u=>u.type==="file"&&rt(lt(u.name))).forEach(u=>{V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Ca(u,t))})},120),i(!0)):i(null)})},an=(e,t,n)=>W({url:`/repos/${e}/${t}/branches/${n}`,method:"GET"}),sn=(e,t)=>new Promise(async n=>{const a=await W({url:`/repos/${e}/${t}/branches`,method:"GET"});a&&a.length?n(a.filter(o=>!o.protected).map(o=>({value:o.name,label:o.name})).reverse()):n(null)}),Na=async(e,t,n)=>{const{owner:a,selectedRepo:o,branchList:i}=e,s=Se.service({text:`\u6B63\u5728\u65B0\u5EFA ${t} \u5206\u652F...`});try{let u="";const c=await W({url:`/repos/${a}/${o}/git/refs/heads/${i[0].value}`,method:"GET"});if(c&&(u=c.object.sha),!u){s.close(),x.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}let m="";const g=await W({url:`/repos/${a}/${o}/git/refs`,method:"POST",params:{ref:`refs/heads/${t}`,sha:u}});if(g&&(m=g.object.sha),!m){s.close(),x.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}await W({url:`/repos/${a}/${o}/git/refs/heads/${t}`,method:"PATCH",params:{force:!0,sha:m}})&&n()}catch(u){console.error(u)}},on=(e,t,n,a)=>W({url:`/repos/${e}/${t}/contents/${n}`,method:"DELETE",data:{owner:e,repo:t,path:n,message:da,sha:a}}),Ga=(e,t)=>W({url:e,method:"PUT",data:t}),ja=(e,t,n)=>W({url:`/repos/${t}/${n}/git/blobs`,method:"POST",params:{owner:t,repo:n,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),un=(e,t,n,a)=>{var o,i,s;return W({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:n.map(u=>({path:u.path,mode:"100644",type:"blob",sha:u.sha})),base_tree:((s=(i=(o=a==null?void 0:a.commit)==null?void 0:o.commit)==null?void 0:i.tree)==null?void 0:s.sha)||null}})},ln=(e,t,n,a)=>W({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:n.sha,parents:[a.commit.sha],message:ca}}),rn=(e,t,n,a)=>W({url:`/repos/${e}/${t}/git/refs/heads/${n}`,method:"PATCH",params:{sha:a}}),cn=G({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:Z.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!0}},setup(e){const t=ee(),n=L(()=>t.getters.getUserConfigInfo).value,a={lazy:!0,checkStrictly:!0,async lazyLoad(i,s){const{level:u,pathLabels:c}=i;let m;u===0?m=n.dirList:m=await nn(n,c.join("/")),s(m?m.map(g=>({value:g.value,label:g.label,leaf:u>=Rt-1})):[])}},o=i=>{n.selectedDirList=i,n.selectedDir=i.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(i,s)=>{const u=Un;return f(),$(u,{style:ke({width:e.elWidth}),size:e.elSize,debounce:500,props:a,key:e.elKey,modelValue:l(n).selectedDirList,"onUpdate:modelValue":s[0]||(s[0]=c=>l(n).selectedDirList=c),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:e.elClearable,onChange:o},null,8,["style","size","modelValue","clearable"])}}});var j=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n};const za=G({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:""}},setup(e){const t=e,n=ee(),a=L(()=>n.getters.getUserConfigInfo).value,o=L(()=>t.dataType==="repo"?"\u4ED3\u5E93":"\u5206\u652F"),i=async()=>{const s=Se.service({lock:!0,text:`\u6B63\u5728\u52A0\u8F7D ${o.value} \u6570\u636E ...`}),{owner:u,selectedRepo:c}=a;if(t.dataType==="repo"){const m=await Nt(u);m&&(a.repoList=m)}else if(t.dataType==="branch"){const m=await sn(u,c);m&&(a.branchList=m)}s.close(),await n.dispatch("USER_CONFIG_INFO_PERSIST")};return(s,u)=>{const c=J("Refresh"),m=re,g=ve;return f(),b("div",{class:"refresh-config-box",style:ke({width:e.boxWidth+"rem"})},[r(g,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+l(o)+" \u6570\u636E"},{default:_(()=>[r(m,{class:"icon",onClick:i},{default:_(()=>[r(c)]),_:1})]),_:1},8,["content"])],4)}}});var Ha=j(za,[["__scopeId","data-v-9acb8ba8"]]);const N=L(()=>V.getters.getUserConfigInfo).value,Xa=()=>{V.dispatch("LOGOUT")},he=()=>{V.dispatch("USER_CONFIG_INFO_PERSIST")};function dn(e){N.logined=!0,N.owner=e.login,N.name=e.name,N.email=e.email,N.avatarUrl=e.avatar_url,he()}const Ka=()=>{N.selectedRepo="",N.repoList=[],N.selectedBranch="",N.branchMode=pe.repoBranch,N.branchList=[],N.selectedDir="",N.dirMode=Y.repoDir,N.dirList=[]},Wa=async()=>{const{selectedDir:e,dirMode:t}=N;let n="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(e===""){switch(t){case Y.newDir:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case Y.repoDir:n=`\u8BF7\u9009\u62E9 ${N.selectedRepo} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}x.warning(n)}else await Ue.push("/upload")},Ya=async()=>{const{token:e}=N;if(!e){x.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A");return}const t=Se.service({lock:!0,text:"\u6B63\u5728\u81EA\u52A8\u914D\u7F6E..."}),n=await Vt(N.token);if(console.log("getGitHubUserInfo >> ",n),!n){t.close(),x.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}dn(n);const a=await ga(N.token);if(console.log("createRepo >> ",a),!a){t.close(),x.error("\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5");return}N.repoList=[{value:Ne,label:Ne}],N.selectedRepo=Ne,N.branchList=[{value:Ge,label:Ge}],N.selectedBranch=Ge,N.branchMode=pe.repoBranch,N.selectedDir=Xe("yyyyMMdd"),N.dirMode=Y.autoDir,N.dirList=[],he(),await Gt(N,!1),t.close(),x.success("\u81EA\u52A8\u914D\u7F6E\u6210\u529F"),await Ue.push("/upload")};const qa={class:"page-container config-page-container"},Ja=G({__name:"my-config",setup(e){const t=ee(),n=k(!1),a=k(!1),o=k(!1),i=k(32),s=L(()=>t.getters.getUserConfigInfo).value,u=L(()=>t.getters.getUserLoginStatus).value,c=L(()=>t.getters.getUserSettings).value,m=L(()=>!s.token||!s.owner),g=L(()=>c.elementPlusSize===Z.large?"right":"top"),D=L(()=>n.value||a.value||o.value),h=k(null),F=k(null),p=k(""),I=k("repoDirCascaderKey"),A=T=>{var y;switch(T){case Y.rootDir:s.selectedDir="/";break;case Y.autoDir:s.selectedDir=Xe("yyyyMMdd");break;case Y.newDir:s.selectedDir="xxx",(y=h.value)==null||y.focus();break;case Y.repoDir:const{dirList:P}=s;P.length?(s.selectedDir=P[0].value,s.selectedDirList=[P[0].value]):s.selectedDir="";break;default:s.selectedDir="/";break}he()};async function B(T){const y=await Nt(T);console.log("getAllRepoList >> ",y),n.value=!1,y?(s.repoList=y,he()):x.error("\u4ED3\u5E93\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}async function v(){a.value=!0;const T=await nn(s);console.log("getDirInfoList >> ",T),a.value=!1,T&&(s.dirList=T),he()}const R=T=>{var U;const y=s.selectedBranch,P=s.branchList[0].value;switch(T){case pe.newBranch:s.dirMode=Y.newDir,s.selectedBranch="",s.selectedDir="",(U=F.value)==null||U.focus();break;case pe.repoBranch:y!==P&&(s.selectedBranch=P,v());break;default:s.selectedBranch="";break}he()};async function w(T){o.value=!0;const{owner:y,dirMode:P}=s,U=await sn(y,T);console.log("getBranchInfoList >> ",U),o.value=!1,U?(U.length>0?(s.branchList=U,s.selectedBranch=s.branchList[0].value,s.branchMode=pe.repoBranch,await v()):(s.selectedBranch=Ge,s.branchMode=pe.newBranch,await Gt(s)),A(P),he()):x.error("\u5206\u652F\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")}async function E(){if(!s.token){x.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A");return}m.value||Ka(),n.value=!0;const T=await Vt(s.token);if(console.log("getGitHubUserInfo >> ",T),!T){x.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}dn(T),await B(T.login)}function X(T){s.branchList=[],s.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),w(T),he()}async function q(T){s.selectedBranch=T,await v(),I.value=s.selectedBranch,s.selectedDir=s.dirList[0].value,s.selectedDirList=[s.selectedDir],he()}const H=()=>{const T=p.value,y=s.branchList;T?y.find(P=>P.value===T)?x.warning(`${T} \u5206\u652F\u5DF2\u5B58\u5728\uFF0C\u8BF7\u5728\u5206\u652F\u5217\u8868\u4E2D\u9009\u62E9`):Na(s,T,()=>{x.success(`\u65B0\u5EFA ${T} \u6210\u529F`),s.branchList.push({value:T,label:T})}):x.error("\u65B0\u5EFA\u5206\u652F\u4E0D\u80FD\u4E3A\u7A7A")};return te(()=>u,T=>{T||(n.value=!1,a.value=!1,o.value=!1)}),(T,y)=>{const P=Be,U=Qe,ae=Ce,oe=ve,ge=et,K=vt,le=bt,ht=Ha,Me=tt,Cn=nt,yn=cn,Je=Le;return f(),b("div",qa,[r(ge,{"label-width":"70rem","label-position":l(g)},{default:_(()=>[r(U,{label:"Token"},{default:_(()=>[r(P,{modelValue:l(s).token,"onUpdate:modelValue":y[0]||(y[0]=M=>l(s).token=M),clearable:"",autofocus:!l(s).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),r(U,{class:"operation"},{default:_(()=>[r(oe,{placement:"top",content:"\u9009\u62E9\u5DF2\u6709\u7684 GitHub \u4ED3\u5E93"},{default:_(()=>[r(ae,{disabled:l(D),plain:"",type:"primary","native-type":"submit",onClick:y[1]||(y[1]=be(M=>E(),["prevent"]))},{default:_(()=>[S(O(l(m)?"":"\u91CD\u65B0")+"\u624B\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1}),r(oe,{placement:"top",content:"\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\uFF08\u9002\u5408\u65B0\u7528\u6237\uFF09"},{default:_(()=>[r(ae,{plain:"",disabled:l(D),type:"primary",onClick:y[2]||(y[2]=be(M=>l(Ya)(),["prevent"]))},{default:_(()=>[S(O(l(m)?"":"\u91CD\u65B0")+"\u4E00\u952E\u81EA\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["label-position"]),l(s).token&&l(s).owner?ne((f(),$(ge,{key:0,"label-width":"70rem","label-position":l(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F..."},{default:_(()=>[l(s).owner?(f(),$(U,{key:0,label:"\u7528\u6237\u540D"},{default:_(()=>[r(P,{modelValue:l(s).owner,"onUpdate:modelValue":y[3]||(y[3]=M=>l(s).owner=M),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),l(s).email?(f(),$(U,{key:1,label:"\u90AE\u7BB1"},{default:_(()=>[r(P,{modelValue:l(s).email,"onUpdate:modelValue":y[4]||(y[4]=M=>l(s).email=M),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),l(s).repoList.length?(f(),$(U,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:_(()=>[r(le,{modelValue:l(s).selectedRepo,"onUpdate:modelValue":y[5]||(y[5]=M=>l(s).selectedRepo=M),filterable:!0,style:ke({width:"calc(100% - "+i.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:X},{default:_(()=>[(f(!0),b(ce,null,de(l(s).repoList,(M,Ze)=>(f(),$(K,{key:Ze,label:M.label,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(ht,{"box-width":i.value,"data-type":"repo"},null,8,["box-width"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,n.value]]):C("",!0),l(s).token&&l(s).selectedRepo&&l(s).branchList.length?ne((f(),$(ge,{key:1,"label-width":"70rem","label-position":l(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u5206\u652F\u4FE1\u606F..."},{default:_(()=>[(l(s).selectedRepo,C("",!0)),l(s).branchList.length&&l(s).branchMode===l(pe).repoBranch?(f(),$(U,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:_(()=>[r(le,{modelValue:l(s).selectedBranch,"onUpdate:modelValue":y[7]||(y[7]=M=>l(s).selectedBranch=M),filterable:!0,style:ke({width:"calc(100% - "+i.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:q},{default:_(()=>[(f(!0),b(ce,null,de(l(s).branchList,(M,Ze)=>(f(),$(K,{key:Ze,label:M.label,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),r(ht,{"box-width":i.value,"data-type":"branch"},null,8,["box-width"])]),_:1})):C("",!0),l(s).branchMode===l(pe).newBranch?(f(),$(U,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:_(()=>[r(P,{modelValue:p.value,"onUpdate:modelValue":y[8]||(y[8]=M=>p.value=M),onBlur:H,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F...",ref_key:"newBranchInputRef",ref:F},null,8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,o.value]]):C("",!0),l(s).token&&l(s).selectedBranch?ne((f(),$(ge,{key:2,"label-width":"70rem","label-position":l(g),"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u76EE\u5F55\u4FE1\u606F..."},{default:_(()=>[l(s).selectedBranch?(f(),$(U,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:_(()=>[r(Cn,{modelValue:l(s).dirMode,"onUpdate:modelValue":y[9]||(y[9]=M=>l(s).dirMode=M),onChange:A},{default:_(()=>[r(oe,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"newDir"},{default:_(()=>[S("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),r(oe,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+l(s).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"rootDir"},{default:_(()=>[S("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),r(oe,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"autoDir"},{default:_(()=>[S("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),l(s).dirList.length&&l(s).branchMode!=="newBranch"?(f(),$(oe,{key:0,content:"\u9009\u62E9 "+l(s).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:_(()=>[r(Me,{label:"repoDir"},{default:_(()=>[S(" \u9009\u62E9 "+O(l(s).selectedRepo)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):C("",!0)]),_:1},8,["modelValue"])]),_:1})):C("",!0),l(s).dirMode==="autoDir"?(f(),$(U,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:_(()=>[r(P,{modelValue:l(s).selectedDir,"onUpdate:modelValue":y[10]||(y[10]=M=>l(s).selectedDir=M),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),l(s).dirMode==="rootDir"?(f(),$(U,{key:2,label:"\u6839\u76EE\u5F55"},{default:_(()=>[r(P,{modelValue:l(s).selectedDir,"onUpdate:modelValue":y[11]||(y[11]=M=>l(s).selectedDir=M),readonly:""},null,8,["modelValue"])]),_:1})):C("",!0),l(s).dirMode==="newDir"?(f(),$(U,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:_(()=>[r(P,{ref_key:"newDirInputRef",ref:h,modelValue:l(s).selectedDir,"onUpdate:modelValue":y[12]||(y[12]=M=>l(s).selectedDir=M),onInput:y[13]||(y[13]=M=>l(he)()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):C("",!0),l(s).dirList.length&&l(s).dirMode==="repoDir"&&l(s).branchMode!=="newBranch"?(f(),$(U,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:_(()=>[r(yn,{"el-key":I.value,"el-size":l(c).elementPlusSize},null,8,["el-key","el-size"])]),_:1})):C("",!0)]),_:1},8,["label-position"])),[[Je,a.value]]):C("",!0),l(s).token?(f(),$(ge,{key:3,"label-width":"70rem","label-position":l(g)},{default:_(()=>[r(U,{class:"operation"},{default:_(()=>[l(s).owner?(f(),$(ae,{key:0,plain:"",disabled:l(D),type:"warning",onClick:y[14]||(y[14]=M=>l(Xa)())},{default:_(()=>[S(" \u91CD\u7F6E ")]),_:1},8,["disabled"])):C("",!0),l(s).selectedRepo?(f(),$(ae,{key:1,plain:"",disabled:l(D),type:"success",onClick:y[15]||(y[15]=M=>l(Wa)())},{default:_(()=>[S(" \u786E\u8BA4 ")]),_:1},8,["disabled"])):C("",!0)]),_:1})]),_:1},8,["label-position"])):C("",!0)])}}});var Za=j(Ja,[["__scopeId","data-v-2aa853fc"]]);const Qa={key:0,class:"selected-info-bar-box"},es={class:"info-item repo"},ts={key:0,class:"info-item branch"},ns={class:"info-item dir"},as=G({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=ee(),n=L(()=>t.getters.getUserConfigInfo),a=L(()=>t.getters.getUserSettings);return(o,i)=>{const s=Mn,u=cn;return l(n).selectedRepo?(f(),b("div",Qa,[d("span",es,[S(" \u4ED3\u5E93\uFF1A "),r(s,{"disable-transitions":""},{default:_(()=>[S(O(l(n).selectedRepo),1)]),_:1})]),l(n).selectedBranch?(f(),b("span",ts,[S(" \u5206\u652F\uFF1A "),r(s,{"disable-transitions":""},{default:_(()=>[S(O(l(n).selectedBranch),1)]),_:1})])):C("",!0),d("span",ns,[S(" \u76EE\u5F55\uFF1A "),l(n).dirMode!==l(Y).repoDir||e.barType==="management"?(f(),$(s,{key:0,"disable-transitions":""},{default:_(()=>[S(O(e.barType==="management"?l(n).viewDir:l(n).selectedDir),1)]),_:1})):C("",!0),l(n).dirMode===l(Y).repoDir&&e.barType==="upload"?(f(),$(u,{key:1,"el-size":l(a).elementPlusSize===l(Z).large?l(Z).default:l(a).elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):C("",!0)])])):C("",!0)}}});var mn=j(as,[["__scopeId","data-v-dc55c6ba"]]);const pn=e=>(De("data-v-e7b81042"),e=e(),Ie(),e),ss=["onDrop","onPaste"],os=pn(()=>d("label",{for:"input-file-selector"},null,-1)),us={key:0,class:"upload-area-tips"},is=pn(()=>d("div",{class:"text"},"\u62D6\u62FD / \u7C98\u8D34 / \u70B9\u51FB\u6B64\u5904\u9009\u62E9\u56FE\u7247",-1)),ls=["src"],rs=G({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:n}){const a=ee(),o=L(()=>a.getters.getUploadAreaActive),i=k({uuid:"",base64:""}),s=k([]),u=()=>{const p=s.value.length,I=p>0?s.value[p-1]:{uuid:"",base64:""};i.value={uuid:I.uuid,base64:I.base64}},c=async p=>{if(!!p.length){s.value=[];for(const I of p){const A=await $a(I);A&&s.value.push(A)}u(),a.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),n("getImgList",s.value)}},m=async p=>{const I=p.target;await c(I.files),I.value="",I.value=I.defaultValue},g=async p=>{await c(p.dataTransfer.files)},D=async p=>{const I=Array.from(p.clipboardData.items).filter(A=>A.kind==="file"&&rt(A.type)).map(A=>A.getAsFile());await c(I)},h=()=>{s.value=[],i.value.uuid="",i.value.base64=""},F=p=>{const I=s.value.findIndex(A=>A.uuid===p);I!==-1&&s.value.splice(I,1),p===i.value.uuid&&u()};return me(()=>{window.addEventListener("paste",D)}),Pn(()=>{window.removeEventListener("paste",D)}),t({reset:h,remove:F}),(p,I)=>{const A=J("UploadFilled"),B=re;return f(),b("div",{class:se(["getting-images-container",{focus:l(o)&&i.value.base64,disabled:e.disabled}]),onDragover:I[0]||(I[0]=be(()=>{},["prevent"])),onDrop:be(g,["stop","prevent"]),onPaste:be(D,["stop"])},[os,d("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:m,multiple:"multiple"},null,32),i.value.base64?C("",!0):(f(),b("div",us,[r(B,{class:"icon"},{default:_(()=>[r(A)]),_:1}),is])),i.value.base64?(f(),b("img",{key:1,class:"preview-img",src:i.value.base64},null,8,ls)):C("",!0)],42,ss)}}});var mt=j(rs,[["__scopeId","data-v-e7b81042"]]);const cs=L(()=>V.getters.getUserSettings).value,ds=async e=>{const{starred:t}=e;t||await _a()&&await V.dispatch("SET_USER_SETTINGS",{starred:!0})},ms=e=>{const t=Xt();t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{prefixNaming:n,defaultHash:a}=cs,o=e.uuid,i=e.file.name.lastIndexOf("."),s=e.file.name.slice(0,i),u=e.file.name.slice(i+1);return t.filename.initName=s,t.filename.name=n.enable?`${n.prefix}${s}`:s,t.filename.prefixName=n.prefix,t.filename.hash=o,t.filename.suffix=u,t.filename.final=a?`${t.filename.name}.${o}.${u}`:`${t.filename.name}.${u}`,t.filename.isHashRename=a,t.filename.isPrefix=n.enable,t},_n=(e,t,n)=>{var i;let a=n.selectedDir;((i=t==null?void 0:t.reUploadInfo)==null?void 0:i.isReUpload)&&(a=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const o={checked:!1,type:"image",uuid:t.uuid,dir:a,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=o,V.dispatch("DIR_IMAGE_LIST_ADD_DIR",a),V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)},ps=(e,t)=>{var u;const{owner:n,selectedRepo:a,selectedDir:o}=e,i=t.filename.final;let s=i;return o!=="/"&&(s=`${o}/${i}`),((u=t==null?void 0:t.reUploadInfo)==null?void 0:u.isReUpload)&&(s=t.reUploadInfo.path),`/repos/${n}/${a}/contents/${s}`};async function _s(e,t){const{selectedBranch:n,selectedRepo:a,selectedDir:o,owner:i}=e,s=[];for(const h of t){h.uploadStatus.uploading=!0;const F=await ja(h,i,a);F?s.push(Pe({img:h},F)):(h.uploadStatus.uploading=!1,x.error(`${h.filename.final} \u4E0A\u4F20\u5931\u8D25`))}const u=await an(i,a,n);if(!u)return Promise.resolve(!1);const c=o==="/"?"":`${o}/`,m=await un(i,a,s.map(h=>({sha:h.sha,path:`${c}${h.img.filename.final}`})),u);if(!m)return Promise.resolve(!1);const g=await ln(i,a,m,u);return!g||!await rn(i,a,n,g.sha)?Promise.resolve(!1):(s.forEach(h=>{const F=h.img.filename.final;_n({name:F,sha:h.sha,path:`${c}${F}`,size:0},h.img,e)}),Promise.resolve(!0))}function fn(e,t){const{selectedBranch:n,email:a,owner:o}=e,i={message:ra,branch:n,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return a&&(i.committer={name:o,email:a}),t.uploadStatus.uploading=!0,new Promise(async s=>{const u=await Ga(ps(e,t),i);if(console.log("uploadSingleImage >> ",u),t.uploadStatus.uploading=!1,u){const{name:c,sha:m,path:g,size:D}=u.content;_n({name:c,sha:m,path:g,size:D},t,e),s(!0)}else s(!1)})}const pt=(e,t)=>{e?t.filename.name=`${t.filename.prefixName}${t.filename.initName}`:t.filename.name=`${t.filename.initName}`,t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},gn=(e,t)=>{e?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},fs=(e,t)=>{t.filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):pt(t.filename.isPrefix,t),t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},gs=async(e,t)=>{const{watermark:n,compress:a}=t;let o=e.fileInfo.originalFile;n.enable&&n.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=La(e.fileInfo.originalFile.type)?await Ia(e.fileInfo.originalFile,n):e.fileInfo.originalFile,o=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Ke(o),e.beforeUploadStatus.watermarking=!1),a.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await Yt(o,a.encoder),o=e.fileInfo.compressFile,e.base64.compressBase64=await Ke(o),e.filename.suffix=lt(o.name),e.beforeUploadStatus.compressing=!1)};const hs=["element-loading-text"],Es={class:"before-upload-handle-container"},Fs={class:"img-name-box"},vs={class:"img-name text-ellipsis"},bs={class:"operate-item"},Ds={class:"operate-item"},Is={key:0,class:"operate-item"},Cs={key:1,class:"img-info-box"},ys={class:"file-size-box"},As={key:0,class:"finial-file-size file-size-item"},ws={class:"last-modified"},Ss=G({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=e,a=ee(),o=k(null),i=L(()=>a.getters.getUserSettings).value,s=L(()=>a.getters.getUserConfigInfo).value,u=k(""),c=Dt({isHash:!1,prefixNaming:!1,isRename:!1,newName:""}),m=k(!0),g=F=>{t("remove",F)},D=()=>{n.imgObj.filename.newName=c.newName,setTimeout(()=>{var F;(F=o.value)==null||F.focus()},100),fs(c.isRename,n.imgObj)},h=()=>{const{defaultHash:F,prefixNaming:p}=i;n.imgObj.uploadStatus.progress===0&&(n.imgObj.filename.isHashRename=F,n.imgObj.filename.isPrefix=p.enable,n.imgObj.filename.prefixName=p.prefix,pt(p.enable,n.imgObj),gn(F,n.imgObj),c.isHash=n.imgObj.filename.isHashRename,c.prefixNaming=n.imgObj.filename.isPrefix,c.isRename=n.imgObj.filename.isRename,c.newName=n.imgObj.filename.newName)};return te(()=>n.imgObj.uploadStatus,F=>{F.uploading&&(u.value="\u6B63\u5728\u4E0A\u4F20...")},{deep:!0,immediate:!0}),me(async()=>{await gs(n.imgObj,i),h()}),(F,p)=>{var y,P,U,ae,oe,ge;const I=Ve,A=J("CaretBottom"),B=J("CaretLeft"),v=re,R=ve,w=It,E=Be,X=J("Remove"),q=J("Upload"),H=J("Check"),T=Le;return f(),b("div",{class:se(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploading:e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress!==100,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[ne((f(),b("div",{class:"img-show-container","element-loading-text":u.value},[r(I,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])],8,hs)),[[T,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),d("div",Es,[d("div",Fs,[d("span",vs,O(e.imgObj.filename.final||e.imgObj.filename.name),1),e.imgObj.uploadStatus.progress===0?(f(),$(R,{key:0,placement:"top",offset:8,content:m.value?"\u5C55\u5F00":"\u6298\u53E0"},{default:_(()=>[r(v,{class:"fold-btn",onClick:p[0]||(p[0]=K=>m.value=!m.value)},{default:_(()=>[m.value?C("",!0):(f(),$(A,{key:0})),m.value?(f(),$(B,{key:1})):C("",!0)]),_:1})]),_:1},8,["content"])):C("",!0)]),e.imgObj.uploadStatus.progress===0?(f(),b("div",{key:0,class:se(["img-name-operate-box",{folded:m.value}])},[d("div",bs,[r(w,{label:"\u54C8\u5E0C\u5316",modelValue:c.isHash,"onUpdate:modelValue":p[1]||(p[1]=K=>c.isHash=K),onChange:p[2]||(p[2]=K=>l(gn)(K,e.imgObj))},null,8,["modelValue"])]),d("div",Ds,[r(w,{label:"\u91CD\u547D\u540D",modelValue:c.isRename,"onUpdate:modelValue":p[3]||(p[3]=K=>c.isRename=K),onChange:D},null,8,["modelValue"]),e.imgObj.filename.isRename?(f(),$(E,{key:0,class:"rename-input",size:"small",modelValue:c.newName,"onUpdate:modelValue":p[4]||(p[4]=K=>c.newName=K),onInput:D,maxlength:l(Ut),ref_key:"renameInputRef",ref:o,clearable:""},null,8,["modelValue","maxlength"])):C("",!0)]),!e.imgObj.filename.isRename&&l(i).prefixNaming.enable&&l(i).prefixNaming.prefix?(f(),b("div",Is,[r(w,{label:"\u547D\u540D\u524D\u7F00",modelValue:c.prefixNaming,"onUpdate:modelValue":p[5]||(p[5]=K=>c.prefixNaming=K),onChange:p[6]||(p[6]=K=>l(pt)(K,e.imgObj))},null,8,["modelValue"])])):C("",!0)],2)):C("",!0),e.imgObj.uploadStatus.progress===0?(f(),b("div",Cs,[d("div",ys,[d("span",{class:se(["original-file-size file-size-item",{"del-line":(P=(y=e.imgObj.fileInfo)==null?void 0:y.compressFile)==null?void 0:P.size}])},O(l(Ae)(e.imgObj.fileInfo.originalFile.size))+" KB ",3),((ae=(U=e.imgObj.fileInfo)==null?void 0:U.compressFile)==null?void 0:ae.size)?(f(),b("span",As,O(l(Ae)((ge=(oe=e.imgObj.fileInfo)==null?void 0:oe.compressFile)==null?void 0:ge.size))+" KB ",1)):C("",!0)]),d("span",ws,O(l(Xe)("yyyy-MM-dd hh:mm",e.imgObj.fileInfo.originalFile.lastModified)),1)])):C("",!0)]),e.imgObj.uploadStatus.progress===100?(f(),b("div",{key:0,class:"after-upload-handle-container flex-center",onClick:p[7]||(p[7]=K=>l(We)(e.imgObj.uploadedImg,l(s),l(i)))}," \u70B9\u51FB\u590D\u5236\u56FE\u7247\u94FE\u63A5 ")):C("",!0),e.imgObj.uploadStatus.progress===0?(f(),$(R,{key:1,placement:"top",offset:8,content:"\u5220\u9664"},{default:_(()=>[r(v,{class:"del-img-btn",onClick:p[8]||(p[8]=K=>g(e.imgObj.uuid))},{default:_(()=>[r(X)]),_:1})]),_:1})):C("",!0),d("div",{class:se(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[r(v,null,{default:_(()=>[!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0?(f(),$(q,{key:0})):C("",!0),!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100?(f(),$(H,{key:1})):C("",!0)]),_:1})],2)],2)}}});var ks=j(Ss,[["__scopeId","data-v-2a6b23a0"]]);const Bs={class:"upload-page-container"},Ls={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},$s={class:"row-item"},xs={class:"content-box"},Ts={class:"row-item"},Rs={class:"content-box upload-area-status"},Os={key:0},Us={key:0,class:"row-item"},Ms={class:"content-box",style:{"text-align":"right"}},Ps={class:"shortcut-key"},Vs={class:"shortcut-key"},Ns=G({__name:"upload-image",setup(e){const t=ee(),n=$e(),a=k(null),o=L(()=>t.getters.getUserConfigInfo).value,i=L(()=>t.getters.getUserSettings).value,s=L(()=>t.getters.getUserLoginStatus),u=k([]),c=k(!1),m=L(()=>it()==="mac"?"Command":"Ctrl"),g=v=>{v.forEach(R=>{t.dispatch("UPLOAD_IMG_LIST_ADD",ms(R))})},D=()=>{var v;(v=a.value)==null||v.reset()},h=async v=>{if(v.length===1)return await fn(o,v[0])?Ee.uploaded:Ee.uploadFail;if(v.length>1)return await _s(o,v)?Ee.allUploaded:Ee.uploadFail},F=async(v,R=!1)=>{D(),R?Qt(v,o,i,!0):We(v[0],o,i,!0),await t.dispatch("SET_USER_CONFIG_INFO",{viewDir:o.selectedDir}),await ds(i)},p=async()=>{const{token:v,selectedRepo:R,selectedDir:w}=o;if(!v){x.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E"),await n.push("/config");return}if(!R){x.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),await n.push("/config");return}if(!w){x.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),await n.push("/config");return}const E=u.value.filter(H=>H.uploadStatus.progress===0);if(E.length===0){x.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247");return}c.value=!0;const X=await h(E);c.value=!1;const q=E.filter(H=>H.uploadStatus.progress===100).map(H=>H.uploadedImg);switch(X){case Ee.uploaded:x.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F"),await F(q);break;case Ee.allUploaded:x.success("\u56FE\u7247\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),await F(q,!0);break;case Ee.uploadFail:x.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}},I=()=>{c.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),D()},A=v=>{var R;t.dispatch("UPLOAD_IMG_LIST_REMOVE",v),(R=a.value)==null||R.remove(v)};te(()=>s,v=>{!v&&I()}),te(()=>t.state.uploadImageListModule.uploadImageList,v=>{u.value=v},{immediate:!0,deep:!0});const B=()=>{document.addEventListener("keydown",v=>{const R=v.keyCode||v.which||v.charCode,w=v.ctrlKey||v.metaKey;w&&R===65&&u.value.length&&(I(),v.preventDefault()),w&&R===83&&(c.value||(p(),v.preventDefault()))})};return me(()=>{B()}),(v,R)=>{const w=mt,E=mn,X=Ce;return f(),b("div",Bs,[u.value.length&&(l(i).elementPlusSize===l(Z).large||l(i).elementPlusSize===l(Z).default)?(f(),b("div",Ls,[(f(!0),b(ce,null,de(u.value,(q,H)=>(f(),b("div",{class:"uploaded-item",key:H+q.uuid},[r(ks,{"img-obj":q,onRemove:R[0]||(R[0]=T=>A(T))},null,8,["img-obj"])]))),128))])):C("",!0),d("div",{class:se(["upload-page-right page-container",{"has-left":u.value.length}])},[d("div",$s,[d("div",xs,[r(w,{disabled:c.value,ref_key:"gettingImagesRef",ref:a,onGetImgList:g},null,8,["disabled"])])]),d("div",Ts,[d("div",Rs,[r(E),u.value.length?(f(),b("div",Os," \u5DF2\u4E0A\u4F20\uFF1A"+O(u.value.filter(q=>q.uploadStatus.progress===100).length)+" / "+O(u.value.length),1)):C("",!0)])]),u.value.length?(f(),b("div",Us,[d("div",Ms,[r(X,{disabled:c.value,plain:"",type:"warning",onClick:I},{default:_(()=>[S(" \u91CD\u7F6E "),d("span",Ps,O(l(m))+" + A",1)]),_:1},8,["disabled"]),r(X,{disabled:c.value,plain:"",type:"primary",onClick:p},{default:_(()=>[S(" \u4E0A\u4F20 "),d("span",Vs,O(l(m))+" + S",1)]),_:1},8,["disabled"])])])):C("",!0)],2)])}}});const Gs={class:"copy-image-link-box"},js={class:"left"},zs={class:"btn-box right"},Hs=G({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,n=L(()=>V.getters.getUserSettings).value,a=L(()=>V.getters.getUserConfigInfo).value;let o=k(t.imgObj).value;const i=()=>{We(o,a,n)};return Ct(()=>{o=t.imgObj}),(s,u)=>{const c=J("InfoFilled"),m=re,g=ve;return f(),b("div",Gs,[d("div",js,[r(g,{content:"\u8BF7\u5728'\u6211\u7684\u8BBE\u7F6E'\u8FDB\u884C\u56FE\u7247\u94FE\u63A5\u76F8\u5173\u914D\u7F6E",placement:"top"},{default:_(()=>[r(m,null,{default:_(()=>[r(c)]),_:1})]),_:1})]),d("div",zs,[r(g,{content:"\u70B9\u51FB\u590D\u5236 "+l(n).imageLinkType.selected+" \u56FE\u7247\u94FE\u63A5",placement:"top"},{default:_(()=>[d("span",{class:"btn-item flex-center",onClick:i}," \u590D\u5236\u94FE\u63A5 ")]),_:1},8,["content"])])])}}});var Xs=j(Hs,[["__scopeId","data-v-88d7032a"]]);const Ks={class:"image-box"},Ws={class:"info-box"},Ys={class:"image-info"},qs={key:0,class:"rename-operate"},Js={key:1,class:"filename"},Zs={class:"copy-link-box"},Qs={class:"operation-box"},eo={class:"operation-left"},to={class:"operation-right"},no={class:"operation-btn"},ao=G({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,n=ee(),a=Vn(),o=L(()=>n.getters.getUserConfigInfo).value,i=L(()=>n.getters.getUserSettings).value,s=L(()=>a.path==="/management"),u=L(()=>ct(t.imageObj,o,i)),c=k(),m=k(""),g=k(!1),D=k(!1),h=k(!1),F=(w,E=!1)=>{E||(w.deleting=!0);const{owner:X,selectedRepo:q}=o,{path:H,sha:T}=w;return new Promise(async y=>{await on(X,q,H,T)?(E?(g.value=!1,x.success("\u66F4\u65B0\u6210\u529F")):x.success("\u5220\u9664\u6210\u529F"),await n.dispatch("DIR_IMAGE_LIST_REMOVE",w),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid),y(!0)):y(!1)})},p=w=>{Te.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${w.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{F(w)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},I=w=>{w.checked=!w.checked,n.commit("IMAGE_CARD",{imageObj:w})},A=async w=>{g.value=!0,m.value=Wt(w.name),setTimeout(()=>{var E;(E=c.value)==null||E.focus()},100)},B=async()=>{var X;const{imageObj:w}=t;if(!m.value){x.error("\u56FE\u7247\u540D\u4E0D\u80FD\u4E3A\u7A7A"),(X=c.value)==null||X.focus();return}if(m.value===Wt(w.name)){x.error("\u56FE\u7247\u540D\u65E0\u6539\u53D8"),g.value=!1;return}const E=async()=>{const q=Se.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),H=lt(w.name),T=fe(),y=`${m.value}${i.defaultHash?`.${T}`:""}.${H}`;let P;if(H.includes("svg")?P=await ka(u.value||""):P=await Sa(u.value||"",H),P){const U=Xt();U.uuid=T,U.base64.originalBase64=P,U.filename.final=y,U.reUploadInfo.isReUpload=!0,U.reUploadInfo.dir=w.dir;let ae=y;w.dir!=="/"&&(ae=`${w.dir}/${y}`),U.reUploadInfo.path=ae,await fn(o,U)?(m.value="",await F(w,!0),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",w.uuid)):x.error("\u91CD\u547D\u540D\u5931\u8D25")}else x.error("\u91CD\u547D\u540D\u5931\u8D25");q.close(),g.value=!1};Te.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${m.value} \uFF1F`,"\u63D0\u793A",{type:"info"}).then(()=>{E()}).catch(()=>{console.log("\u53D6\u6D88\u91CD\u547D\u540D"),g.value=!1})},v=w=>{h.value=w},R=w=>{Te.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${w.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Ae(w.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(w,E)=>{const X=Ve,q=Be,H=Ce,T=Gn,y=Xs,P=re,U=J("MoreFilled"),ae=yt,oe=At,ge=wt,K=Le;return ne((f(),b("div",{class:se(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:E[6]||(E[6]=le=>D.value=!0),onMouseleave:E[7]||(E[7]=le=>D.value=!1)},[d("div",Ks,[r(X,{src:l(u),fit:"cover",loading:"lazy",lazy:"","data-fancybox":"gallery"},null,8,["src"])]),d("div",Ws,[d("div",Ys,[g.value?(f(),b("div",qs,[r(q,{size:"small",class:"rename-input",modelValue:m.value,"onUpdate:modelValue":E[0]||(E[0]=le=>m.value=le),clearable:"",ref_key:"renameInputRef",ref:c,maxlength:l(Ut)},null,8,["modelValue","maxlength"]),r(T,{size:"small"},{default:_(()=>[r(H,{icon:l(Nn),onClick:E[1]||(E[1]=le=>g.value=!1)},null,8,["icon"]),r(H,{icon:l(St),onClick:be(B,["prevent"])},null,8,["icon","onClick"])]),_:1})])):(f(),b("div",Js,O(e.imageObj.name),1))])]),d("div",Zs,[r(y,{"img-obj":e.imageObj},null,8,["img-obj"])]),ne(d("div",Qs,[d("div",eo,[l(s)?(f(),b("div",{key:0,class:se([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:E[2]||(E[2]=le=>I(e.imageObj))},[e.imageObj.checked?(f(),$(P,{key:0},{default:_(()=>[r(l(St))]),_:1})):C("",!0)],2)):C("",!0)]),d("div",to,[r(ge,{size:"default",trigger:"click",onVisibleChange:v},{dropdown:_(()=>[r(oe,null,{default:_(()=>[r(ae,{onClick:E[3]||(E[3]=le=>p(e.imageObj))},{default:_(()=>[S(" \u5220\u9664 ")]),_:1}),r(ae,{onClick:E[4]||(E[4]=be(le=>A(e.imageObj),["self"]))},{default:_(()=>[S(" \u91CD\u547D\u540D ")]),_:1}),r(ae,{onClick:E[5]||(E[5]=le=>R(e.imageObj))},{default:_(()=>[S(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:_(()=>[d("div",no,[r(P,null,{default:_(()=>[r(U)]),_:1})])]),_:1})])],512),[[xe,D.value||h.value||e.imageObj.checked]])],34)),[[K,e.imageObj.deleting]])}}});var so=j(ao,[["__scopeId","data-v-4a38fea8"]]);const hn=e=>(De("data-v-fba37bd4"),e=e(),Ie(),e),oo=hn(()=>d("div",{class:"icon"},[d("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[d("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),d("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),uo={key:1,class:"text"},io={key:2,class:"icon"},lo=hn(()=>d("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[d("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),ro=[lo],co={key:3,class:"text"},mo=G({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,n=ee(),a=L(()=>n.getters.getUserConfigInfo).value,o=()=>{const{folderObj:i,mode:s}=t;if(s==="back"){const u=a.viewDir;if(u==="/")return;const c=u.split("/");c.length===1?a.viewDir="/":c.length>1&&(c.length-=1,a.viewDir=c.join("/"))}s==="dir"&&(a.viewDir=i.dirPath),n.dispatch("USER_CONFIG_INFO_PERSIST")};return(i,s)=>{const u=ve;return f(),b("div",{class:"folder-card",onDblclick:o},[e.mode==="dir"?(f(),$(u,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:_(()=>[oo]),_:1})):C("",!0),e.mode==="dir"?(f(),b("div",uo,O(e.folderObj.dir),1)):C("",!0),e.mode==="back"?(f(),b("div",io,ro)):C("",!0),e.mode==="back"?(f(),b("div",co,"\u53CC\u51FB\u540E\u9000")):C("",!0)],32)}}});var En=j(mo,[["__scopeId","data-v-fba37bd4"]]);const po={key:0,class:"selector-wrapper"},_o={class:"selector-left-box"},fo={class:"item"},go={class:"selector-right-box"},ho=G({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,n=ee(),a=k(!1),o=L(()=>n.getters.getImageCardCheckedArr),i=L(()=>n.getters.getUserConfigInfo).value,s=L(()=>n.getters.getUserSettings).value,u=L(()=>o.value.length||0);te(()=>u.value,h=>{const F=t.currentDirImageList.length;a.value=h===F});const c=()=>{Qt(o.value,i,s)},m=()=>{t.currentDirImageList.forEach(h=>{h.checked&&(h.checked=!1)})},g=()=>{var h,F;((h=o.value)==null?void 0:h.length)>0?Te.confirm(`\u5DF2\u9009\u4E2D ${(F=o.value)==null?void 0:F.length} \u5F20\u56FE\u7247\uFF0C\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F`,"\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const p=await wa(o.value,i);p===Fe.deleted&&x.success("\u5220\u9664\u6210\u529F"),p===Fe.allDeleted&&x.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),p===Fe.deleteFail&&x.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):x.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},D=()=>{let h=[];t.currentDirImageList.forEach(F=>{F.checked=a.value}),h=t.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:h})};return me(()=>{D()}),(h,F)=>{const p=It,I=J("CopyDocument"),A=re,B=ve,v=J("Delete");return l(u)?(f(),b("div",po,[d("div",_o,[r(p,{label:a.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:a.value,"onUpdate:modelValue":F[0]||(F[0]=R=>a.value=R),onChange:D},null,8,["label","modelValue"]),d("div",fo,"\u5DF2\u9009\u62E9 "+O(l(u))+" \u5F20\u56FE\u7247",1),d("div",{class:"item cancel-select-btn",onClick:m},"\u53D6\u6D88\u9009\u62E9")]),d("div",go,[r(B,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u94FE\u63A5"},{default:_(()=>[r(A,{class:"btn-icon",onClick:c},{default:_(()=>[r(I)]),_:1})]),_:1}),r(B,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:_(()=>[r(A,{class:"btn-icon",onClick:g},{default:_(()=>[r(v)]),_:1})]),_:1})])])):C("",!0)}}});var Eo=j(ho,[["__scopeId","data-v-fb405f6a"]]);const Fo=e=>(De("data-v-45520a6c"),e=e(),Ie(),e),vo={class:"page-container management-page-container"},bo={class:"content-container"},Do={class:"top"},Io={class:"left"},Co={class:"right flex-start"},yo={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},Ao={key:0,class:"image-management-item"},wo=Fo(()=>d("div",{style:{width:"100%"}},null,-1)),So=G({__name:"imgs-management",setup(e){const t=ee(),n=$e(),a=L(()=>t.getters.getUserConfigInfo).value,o=L(()=>t.getters.getUserLoginStatus).value,i=L(()=>t.getters.getDirObject).value,s=k(new Date().getTime()),u=k(!1),c=k([]),m=k([]),g=k(!1);async function D(p){u.value=!0;const I=ze(p,i);if(I){const A=He(p,I,"dir"),B=He(p,I,"image");!A.length&&!B.length?await Ye(a,p):(c.value=A,m.value=B,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value}))}else await Ye(a,p);u.value=!1}async function h(){const{selectedDir:p,viewDir:I,dirMode:A}=a;if(I===""&&((A===Y.newDir||A===Y.autoDir)&&!ze(p,i)&&(a.selectedDir="/",a.dirMode="rootDir"),a.selectedDir?a.viewDir=a.selectedDir:a.viewDir="/"),!i.imageList.length&&!i.childrenDirs.length){await Ye(a,a.viewDir);return}await D(a.viewDir)}async function F(){const{viewDir:p}=a;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",p),u.value=!0,await Ye(a,p),u.value=!1}return me(()=>{h()}),te(()=>o,p=>{p===!1&&n.push("/config")}),te(()=>a.viewDir,async p=>{await D(p),s.value+=1},{deep:!0}),te(()=>i,p=>{const{viewDir:I}=a,A=ze(I,p);A&&(c.value=He(I,A,"dir"),m.value=He(I,A,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value}))},{deep:!0}),te(()=>m.value,p=>{g.value=p.filter(I=>I.checked).length>0},{deep:!0}),(p,I)=>{const A=J("Refresh"),B=re,v=ve,R=jn("contextmenu"),w=Le;return f(),b("div",vo,[d("div",bo,[d("div",Do,[d("div",Io,[r(mn,{"bar-type":"management"})]),d("div",Co,[r(v,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+l(a).viewDir+" \u76EE\u5F55\u5185\u5BB9"},{default:_(()=>[r(B,{class:"btn-icon",onClick:be(F,["stop"])},{default:_(()=>[r(A)]),_:1},8,["onClick"])]),_:1},8,["content"])])]),ne((f(),b("div",yo,[m.value.length?(f(),$(Eo,{currentDirImageList:m.value,"onUpdate:initImageList":m.value,key:s.value},null,8,["currentDirImageList","onUpdate:initImageList"])):C("",!0),ne((f(),b("ul",{class:"image-management-list",style:ke({height:g.value?"calc(100% - 50rem)":"100%"})},[l(a).viewDir!=="/"?(f(),b("li",Ao,[r(En,{mode:"back"})])):C("",!0),(f(!0),b(ce,null,de(c.value,(E,X)=>ne((f(),b("li",{class:"image-management-item",key:"folder-card-"+E.dir+"-"+X},[r(En,{"folder-obj":E},null,8,["folder-obj"])])),[[R,{type:l(ye).childDir,dir:E.dir}]])),128)),wo,(f(!0),b(ce,null,de(m.value,(E,X)=>ne((f(),b("li",{class:"image-management-item image",key:"image-card-"+X},[r(so,{"image-obj":E},null,8,["image-obj"])])),[[R,{type:l(ye).img,img:E}]])),128))],4)),[[R,{type:l(ye).parentDir}]])])),[[w,u.value]])])])}}});var ko=j(So,[["__scopeId","data-v-45520a6c"]]);const Bo=["contenteditable","onFocusout"],Lo={style:{"margin-top":"20px"}},$o=G({__name:"image-link-rule-config",setup(e){const t=L(()=>V.getters.getUserSettings).value,n=k(),a=Dt({id:"",name:"",rule:"",editable:!0}),o=(u,c)=>{V.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:u,id:c})},i=u=>{Te.confirm(`<span>\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A</span><strong>${u.name}</strong>`,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{V.dispatch("DEL_IMAGE_LINK_TYPE_RULE",u.id)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},s=u=>{!u||u.validate(c=>{if(c)a.id=fe(),V.dispatch("ADD_IMAGE_LINK_TYPE_RULE",a);else return!1})};return(u,c)=>{const m=zn,g=Ce,D=Hn,h=kt,F=Be,p=Qe,I=et,A=Bt;return f(),$(A,null,{default:_(()=>[r(D,{data:l(t).imageLinkType.presetList,style:{width:"100%"}},{default:_(()=>[r(m,{prop:"name",label:"\u7C7B\u578B",width:"120"}),r(m,{label:"CDN \u89C4\u5219"},{default:_(B=>[d("div",{contenteditable:B.row.editable,onFocusout:v=>o(v.target.innerHTML,B.row.id)},O(B.row.rule),41,Bo)]),_:1}),r(m,{label:"\u64CD\u4F5C",width:"80"},{default:_(B=>[r(g,{link:"",type:"danger",size:"small",disabled:!B.row.editable,onClick:v=>i(B.row)},{default:_(()=>[S(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),r(h),d("div",Lo,[r(I,{ref_key:"formRef",ref:n,"label-position":"left",model:a,"label-width":"120px",size:"default"},{default:_(()=>[r(p,{label:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B",prop:"name",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[r(F,{modelValue:a.name,"onUpdate:modelValue":c[0]||(c[0]=B=>a.name=B),type:"text"},null,8,["modelValue"])]),_:1}),r(p,{label:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219",prop:"rule",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:_(()=>[r(F,{modelValue:a.rule,"onUpdate:modelValue":c[1]||(c[1]=B=>a.rule=B),type:"text"},null,8,["modelValue"])]),_:1}),r(p,null,{default:_(()=>[r(g,{type:"primary",disabled:!a.name||!a.rule,onClick:c[2]||(c[2]=B=>s(n.value))},{default:_(()=>[S(" \u6DFB\u52A0\u56FE\u7247\u94FE\u63A5\u89C4\u5219 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])]),_:1})}}});var xo=j($o,[["__scopeId","data-v-3fcb9f0e"]]);const qe=e=>(De("data-v-d876ad10"),e=e(),Ie(),e),To={class:"compress-config-box"},Ro=qe(()=>d("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u7247\u538B\u7F29\u7B97\u6CD5\uFF1A",-1)),Oo=qe(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u538B\u7F29\u7387\u8F83\u9AD8\uFF0C\u5927\u591A\u6570\u6D4F\u89C8\u5668\u652F\u6301",-1)),Uo=qe(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF0C\u6240\u6709\u6D4F\u89C8\u5668\u652F\u6301",-1)),Mo=qe(()=>d("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u7387\u6781\u9AD8\uFF0C\u90E8\u5206\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301",-1)),Po=G({__name:"compress-config-box",emits:["encoder"],setup(e,{expose:t,emit:n}){const a=k(ue.webP),o=s=>{n("encoder",s)},i=()=>{a.value=ue.webP};return me(()=>{n("encoder",a.value)}),t({reset:i}),(s,u)=>{const c=tt,m=nt;return f(),b("div",To,[Ro,r(m,{class:"img-encoder-group",modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=g=>a.value=g),onChange:o},{default:_(()=>[r(c,{label:l(ue).webP},{default:_(()=>[S(O(l(ue).webP)+" ",1),Oo]),_:1},8,["label"]),r(c,{label:l(ue).mozJPEG},{default:_(()=>[S(O(l(ue).mozJPEG)+" ",1),Uo]),_:1},8,["label"]),r(c,{label:l(ue).avif},{default:_(()=>[S(O(l(ue).avif)+" ",1),Mo]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}});var Fn=j(Po,[["__scopeId","data-v-d876ad10"]]);const ie=e=>(De("data-v-92d0dcc8"),e=e(),Ie(),e),Vo={class:"page-container settings-page-container"},No=ie(()=>d("div",{class:"setting-title"},"\u56FE\u7247\u540D\u79F0\u8BBE\u7F6E\uFF1A",-1)),Go={class:"setting-list"},jo={class:"setting-item has-desc"},zo=ie(()=>d("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u54C8\u5E0C\u7801\uFF0C\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),Ho={class:"setting-item has-desc"},Xo=ie(()=>d("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u524D\u7F00\uFF0C\u4F8B\u5982\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00",-1)),Ko={key:0,class:"setting-item has-desc"},Wo=ie(()=>d("div",{class:"setting-title"},"\u6C34\u5370\u8BBE\u7F6E\uFF1A",-1)),Yo={class:"setting-list"},qo={class:"setting-item has-desc"},Jo=ie(()=>d("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6C34\u5370\u6587\u5B57\u3001\u5B57\u4F53\u5927\u5C0F\u3001\u4F4D\u7F6E\u548C\u900F\u660E\u5EA6",-1)),Zo={key:0,class:"setting-item"},Qo=ie(()=>d("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),eu={class:"setting-list"},tu={class:"setting-item has-desc"},nu=ie(()=>d("span",{class:"desc"},"\u5F00\u542F\u540E\u4E0A\u4F20\u524D\u4F1A\u81EA\u52A8\u538B\u7F29\u56FE\u7247\uFF0C\u6709\u6548\u7F29\u77ED\u56FE\u7247\u52A0\u8F7D\u65F6\u95F4\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),au={key:0,class:"setting-item"},su=ie(()=>d("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u914D\u7F6E\uFF1A",-1)),ou={class:"setting-list"},uu={class:"setting-item cdn"},iu={class:"left"},lu={class:"right"},ru={class:"setting-item has-desc"},cu=ie(()=>d("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u65B0\u589E\u548C\u7BA1\u7406\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219",-1)),du={key:0,class:"setting-item"},mu=ie(()=>d("div",{class:"setting-title"},"\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\u8BBE\u7F6E\uFF1A",-1)),pu={class:"setting-list"},_u={class:"setting-item has-desc"},fu={class:"desc"},gu={class:"setting-item"},hu={class:"left"},Eu={class:"right"},Fu=ie(()=>d("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),vu={class:"setting-list"},bu={class:"setting-item"},Du={key:0,class:"setting-title"},Iu={key:1,class:"setting-list"},Cu={class:"setting-item"},yu=ie(()=>d("span",{class:"time-middle-space"}," ~ ",-1)),Au=G({__name:"my-settings",setup(e){const t=L(()=>V.getters.getUserSettings).value,n=k(!1),a=()=>{V.dispatch("USER_SETTINGS_PERSIST")},o=()=>{V.dispatch("SET_USER_SETTINGS",Pe({},t)),a()};return(i,s)=>{const u=Lt,c=Be,m=kt,g=Qe,D=Xn,h=tt,F=nt,p=et,I=Bt,A=Fn,B=vt,v=bt,R=xo,w=Kn;return f(),b("div",Vo,[No,d("ul",Go,[d("li",jo,[r(u,{modelValue:l(t).defaultHash,"onUpdate:modelValue":s[0]||(s[0]=E=>l(t).defaultHash=E),onChange:a,"active-text":"\u81EA\u52A8\u54C8\u5E0C\u5316"},null,8,["modelValue"]),zo]),d("li",Ho,[r(u,{modelValue:l(t).prefixNaming.enable,"onUpdate:modelValue":s[1]||(s[1]=E=>l(t).prefixNaming.enable=E),onChange:a,"active-text":"\u6DFB\u52A0\u524D\u7F00\u547D\u540D"},null,8,["modelValue"]),Xo]),l(t).prefixNaming.enable?(f(),b("li",Ko,[r(c,{class:"prefix-input",modelValue:l(t).prefixNaming.prefix,"onUpdate:modelValue":s[2]||(s[2]=E=>l(t).prefixNaming.prefix=E),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:a,clearable:"",autofocus:""},null,8,["modelValue"])])):C("",!0)]),r(m),Wo,d("ul",Yo,[d("li",qo,[r(u,{modelValue:l(t).watermark.enable,"onUpdate:modelValue":s[3]||(s[3]=E=>l(t).watermark.enable=E),onChange:a,"active-text":"\u662F\u5426\u6DFB\u52A0\u6C34\u5370"},null,8,["modelValue"]),Jo]),l(t).watermark.enable?(f(),b("li",Zo,[r(I,null,{default:_(()=>[r(p,{"label-position":"left","label-width":"120rem"},{default:_(()=>[r(g,{label:"\u6C34\u5370\u6587\u5B57"},{default:_(()=>[r(c,{modelValue:l(t).watermark.text,"onUpdate:modelValue":s[4]||(s[4]=E=>l(t).watermark.text=E),clearable:"",maxlength:"10",onInput:a},null,8,["modelValue"])]),_:1}),r(g,{label:"\u5B57\u4F53\u5927\u5C0F"},{default:_(()=>[r(D,{modelValue:l(t).watermark.fontSize,"onUpdate:modelValue":s[5]||(s[5]=E=>l(t).watermark.fontSize=E),min:40,max:60,step:2,onChange:a},null,8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u4F4D\u7F6E"},{default:_(()=>[r(F,{modelValue:l(t).watermark.position,"onUpdate:modelValue":s[6]||(s[6]=E=>l(t).watermark.position=E),onChange:a},{default:_(()=>[r(h,{label:l(_e).leftTop},{default:_(()=>[S("\u5DE6\u4E0A\u89D2")]),_:1},8,["label"]),r(h,{label:l(_e).leftBottom},{default:_(()=>[S("\u5DE6\u4E0B\u89D2")]),_:1},8,["label"]),r(h,{label:l(_e).rightTop},{default:_(()=>[S("\u53F3\u4E0A\u89D2")]),_:1},8,["label"]),r(h,{label:l(_e).rightBottom},{default:_(()=>[S("\u53F3\u4E0B\u89D2")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),r(g,{label:"\u6C34\u5370\u900F\u660E\u5EA6"},{default:_(()=>[r(D,{modelValue:l(t).watermark.opacity,"onUpdate:modelValue":s[7]||(s[7]=E=>l(t).watermark.opacity=E),precision:1,step:.1,min:.1,max:.9,onChange:a},null,8,["modelValue","step","min","max"])]),_:1})]),_:1})]),_:1})])):C("",!0)]),r(m),Qo,d("ul",eu,[d("li",tu,[r(u,{modelValue:l(t).compress.enable,"onUpdate:modelValue":s[8]||(s[8]=E=>l(t).compress.enable=E),onChange:a,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"]),nu]),l(t).compress.enable?(f(),b("li",au,[r(I,null,{default:_(()=>[r(A,{ref:"compressConfigBoxRef",style:{"margin-top":"10rem"},onEncoder:s[9]||(s[9]=E=>{l(t).compress.encoder=E,a()})},null,512)]),_:1})])):C("",!0)]),r(m),su,d("ul",ou,[d("li",uu,[S(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A "),r(v,{modelValue:l(t).imageLinkType.selected,"onUpdate:modelValue":s[10]||(s[10]=E=>l(t).imageLinkType.selected=E),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u89C4\u5219",onChange:o},{default:_(()=>[(f(!0),b(ce,null,de(l(t).imageLinkType.presetList,E=>(f(),$(B,{key:E.name+"-"+E.id,label:E.name,value:E.name,class:"image-link-type-rule-option"},{default:_(()=>[d("span",iu,O(E.name),1),d("span",lu,O(E.rule),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),d("li",ru,[r(u,{modelValue:n.value,"onUpdate:modelValue":s[11]||(s[11]=E=>n.value=E),"active-text":"\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219"},null,8,["modelValue"]),cu]),n.value?(f(),b("li",du,[r(R)])):C("",!0)]),r(m),mu,d("ul",pu,[d("li",_u,[r(u,{modelValue:l(t).imageLinkFormat.enable,"onUpdate:modelValue":s[12]||(s[12]=E=>l(t).imageLinkFormat.enable=E),onChange:a,"active-text":"\u81EA\u52A8\u8F6C\u6362\u56FE\u7247\u94FE\u63A5\u683C\u5F0F"},null,8,["modelValue"]),d("span",fu," \u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u94FE\u63A5\u65F6\u4F7F\u7528 "+O(l(t).imageLinkFormat.selected)+" \u683C\u5F0F ",1)]),d("li",gu,[S(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\uFF1A "),r(v,{modelValue:l(t).imageLinkFormat.selected,"onUpdate:modelValue":s[13]||(s[13]=E=>l(t).imageLinkFormat.selected=E),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u683C\u5F0F",onChange:o},{default:_(()=>[(f(!0),b(ce,null,de(l(t).imageLinkFormat.presetList,E=>(f(),$(B,{key:E.name,label:E.name,value:E.name,class:"image-link-type-rule-option"},{default:_(()=>[d("span",hu,O(E.name),1),d("span",Eu,O(E.format),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),r(m),Fu,d("ul",vu,[d("li",bu,[S(" \u9009\u62E9\u4E3B\u9898\u6A21\u5F0F\uFF1A "),r(v,{modelValue:l(t).theme.mode,"onUpdate:modelValue":s[14]||(s[14]=E=>l(t).theme.mode=E),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:o},{default:_(()=>[r(B,{label:"\u6697\u591C\u4E3B\u9898",value:l(Q).dark},null,8,["value"]),r(B,{label:"\u767D\u663C\u4E3B\u9898",value:l(Q).light},null,8,["value"]),r(B,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:l(Q).auto},null,8,["value"])]),_:1},8,["modelValue"])])]),l(t).theme.mode===l(Q).auto?(f(),b("div",Du," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):C("",!0),l(t).theme.mode===l(Q).auto?(f(),b("ul",Iu,[d("li",Cu,[r(p,{ref:"form"},{default:_(()=>[r(g,null,{default:_(()=>[r(w,{modelValue:l(t).theme.autoLightTime[0],"onUpdate:modelValue":s[15]||(s[15]=E=>l(t).theme.autoLightTime[0]=E),start:"00:00",step:"00:30",end:"23:59",onChange:o},null,8,["modelValue"]),yu,r(w,{modelValue:l(t).theme.autoLightTime[1],"onUpdate:modelValue":s[16]||(s[16]=E=>l(t).theme.autoLightTime[1]=E),start:l(t).theme.autoLightTime[0],step:"00:30",end:"23:59",onChange:o},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):C("",!0)])}}});var wu=j(Au,[["__scopeId","data-v-92d0dcc8"]]);const Su={class:"page-container"},ku={key:0,class:"tool-panel"},Bu={class:"panel-header"},Lu={class:"panel-body"},$u={key:1,class:"toolbox"},xu=["onClick"],Tu={class:"top"},Ru={class:"left flex-center"},Ou={class:"right"},Uu={class:"bottom"},Mu=G({__name:"picx-toolbox",setup(e){const t=$e(),n=k("/toolbox"),a=k(!1),o=k({path:"",icon:"",name:"",desc:"",uuid:""}),i=k([{name:"\u56FE\u7247\u538B\u7F29",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u4E0D\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\u7684\u79BB\u7EBF\u6781\u81F4\u538B\u7F29",icon:"MagicStick",uuid:fe(),path:"/compress"},{name:"\u56FE\u7247\u8F6C Base64",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u5728\u7EBF\u8F6C\u6362\u6210 Base64 \u7F16\u7801",icon:"Paperclip",uuid:fe(),path:"/base64"}]),s=c=>{a.value=!0,o.value=Pe({},c),V.dispatch("TOOLBOX_IMG_LIST_RESET"),t.push(`${n.value}${c.path}`)};te(()=>t.currentRoute.value,c=>{c.path===n.value&&(a.value=!1)},{deep:!0});const u=()=>{t.isReady().then(()=>{const c=t.currentRoute.value.path;if(n.value!==c){const m=c.substring(c.lastIndexOf("/")),g=i.value.find(D=>D.path===m);g&&s(g)}})};return me(()=>{u()}),(c,m)=>{const g=Wn,D=Yn,h=J("router-view"),F=re;return f(),b("div",Su,[a.value?(f(),b("div",ku,[d("div",Bu,[r(D,{"separator-icon":"ArrowRight"},{default:_(()=>[r(g,{to:{path:n.value}},{default:_(()=>[S("\u5DE5\u5177\u7BB1")]),_:1},8,["to"]),r(g,null,{default:_(()=>[S(O(o.value.name),1)]),_:1})]),_:1})]),d("div",Lu,[r(h)])])):(f(),b("ul",$u,[(f(!0),b(ce,null,de(i.value,p=>(f(),b("li",{class:"tool-item",key:p.uuid,onClick:I=>s(p)},[d("div",Tu,[d("div",Ru,[r(F,{size:30},{default:_(()=>[(f(),$($t(p.icon)))]),_:2},1024)]),d("div",Ou,O(p.name),1)]),d("div",Uu,O(p.desc),1)],8,xu))),128))]))])}}});var Pu=j(Mu,[["__scopeId","data-v-641d9b86"]]);const _t=e=>(De("data-v-19b6b02f"),e=e(),Ie(),e),Vu={class:"page-container feedback-page-container"},Nu=_t(()=>d("div",{class:"help-info-item description"}," \u{1F3DE}\uFE0F PicX \u662F\u4E00\u6B3E\u57FA\u4E8E GitHub API \u5F00\u53D1\u7684\u56FE\u5E8A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u56FE\u7247\u4E0A\u4F20\u6258\u7BA1\u3001\u751F\u6210\u56FE\u7247\u94FE\u63A5\u548C\u5E38\u7528\u56FE\u7247\u5DE5\u5177\u7BB1\u670D\u52A1\u3002 ",-1)),Gu={class:"help-info-item"},ju={class:"help-info-item"},zu={class:"help-info-item"},Hu={class:"help-info-item"},Xu={class:"help-info-item"},Ku=_t(()=>d("div",{class:"help-info-item",style:{"margin-bottom":"2rem"}}," \u{1F381} \u5982\u679C PicX \u5BF9\u4F60\u6709\u5E2E\u52A9\uFF0C\u6B22\u8FCE\u8D5E\u8D4F\u4F5C\u8005\uFF0C\u652F\u6301\u5F00\u6E90\u3002 ",-1)),Wu={class:"help-info-item img"},Yu=_t(()=>d("div",{class:"help-info-item red-text"},[d("strong",null," \u26A0\uFE0F \u90D1\u91CD\u58F0\u660E\uFF1A\u8BF7\u52FF\u4F7F\u7528 PicX \u4E0A\u4F20\u8FDD\u53CD\u4F60\u5F53\u5730\u6CD5\u5F8B\u7684\u56FE\u7247\uFF0C\u6240\u9020\u6210\u7684\u4E00\u5207\u540E\u679C\u4E0E\u4F5C\u8005\u65E0\u5173\u3002 ")],-1)),qu=G({__name:"feedback-info",setup(e){const t=L(()=>it()==="win"?"Ctrl + D":"Command + D");return(n,a)=>{const o=qn,i=Ve;return f(),b("div",Vu,[Nu,d("div",Gu,[S(" \u{1F30D} \u5EFA\u8BAE\u5C06\u672C\u7AD9\u6DFB\u52A0\u5230\u6D4F\u89C8\u5668\u6536\u85CF\u5939\uFF0C\u65B9\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002\u5FEB\u6377\u952E\uFF1A"),d("code",null,O(l(t)),1)]),d("div",ju,[S(" \u{1F981} \u4F5C\u8005\uFF1A "),r(o,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:_(()=>[S("@XPoet")]),_:1})]),d("div",zu,[S(" \u{1F300} \u4ED3\u5E93\uFF1A "),r(o,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:_(()=>[S(" https://github.com/XPoet/picx ")]),_:1})]),d("div",Hu,[S(" \u{1F4D6} \u6587\u6863\uFF1A "),r(o,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:_(()=>[S(" https://picx-docs.xpoet.cn ")]),_:1})]),d("div",Xu,[S(" \u{1F4A1} \u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u5982\u9047\u5230\u95EE\u9898\uFF0C\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u6587\u6863\uFF0C\u6216\u8005\u7ED9\u4F5C\u8005\u63D0\xA0 "),r(o,{type:"primary",style:{"font-size":"16rem"},href:"https://github.com/XPoet/picx/issues",target:"_blank"},{default:_(()=>[S(" Issue ")]),_:1}),S(" \xA0\u3002 ")]),Ku,d("div",Wu,[r(i,{style:{width:"300rem"},src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/common/appreciation.webp"})]),Yu])}}});var Ju=j(qu,[["__scopeId","data-v-19b6b02f"]]);const Zu={class:"img-process-state-card-container"},Qu={class:"img-container","element-loading-text":"\u6B63\u5728\u538B\u7F29..."},ei={class:"info-container"},ti={class:"img-name text-ellipsis"},ni={class:"img-size"},ai={key:0,class:"finial-file-size file-size-item"},si=G({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup(e,{emit:t}){const n=i=>{t("remove",i)},a=i=>{Kt(i)},o=i=>{ot(i,()=>{x.success({message:" Base64 \u7F16\u7801\u590D\u5236\u6210\u529F"})})};return(i,s)=>{const u=Ve,c=J("Remove"),m=re,g=ve,D=Le;return f(),b("div",Zu,[ne((f(),b("div",Qu,[r(u,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])])),[[D,e.imgObj.processing]]),d("div",ei,[d("div",ti,O(e.imgObj.finialName||e.imgObj.originalName),1),d("div",ni,[d("div",{class:se(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize}])},O(l(Ae)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize?(f(),b("div",ai,O(l(Ae)(e.imgObj.finialSize))+" KB ",1)):C("",!0)])]),e.imgObj.finialFile?(f(),b("div",{key:0,class:"operate-container flex-center",onClick:s[0]||(s[0]=h=>a(e.imgObj.finialFile))}," \u70B9\u51FB\u4E0B\u8F7D ")):C("",!0),e.cardType==="base64"&&e.imgObj.originalBase64?(f(),b("div",{key:1,class:"operate-container flex-center",onClick:s[1]||(s[1]=h=>o(e.imgObj.originalBase64))}," \u70B9\u51FB\u590D\u5236 Base64 \u7F16\u7801 ")):C("",!0),r(g,{placement:"top",offset:8,content:"\u5220\u9664"},{default:_(()=>[r(m,{class:"del-btn",onClick:s[2]||(s[2]=h=>n(e.imgObj.uuid))},{default:_(()=>[r(c)]),_:1})]),_:1})])}}});var vn=j(si,[["__scopeId","data-v-075514ec"]]);const oi={class:"compress-tool-container"},ui={key:0,class:"compress-tool-left"},ii=G({__name:"compress-tool",setup(e){const t=ee(),n=k(null),a=k(null),o=k([]),i=k(ue.webP),s=k(!1),u=k(!1),c=p=>{u.value=!1,s.value=!1,p.forEach(I=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:I.uuid,originalName:I.file.name,originalSize:I.file.size,originalBase64:I.base64,originalFile:I.file})})},m=p=>{u.value=!1,i.value=p},g=()=>{var p,I;t.dispatch("TOOLBOX_IMG_LIST_RESET"),u.value=!1,(p=n.value)==null||p.reset(),(I=a.value)==null||I.reset()},D=async()=>{s.value=!0;for(const p of o.value)p.processing=!0,p.finialFile=await Yt(p.originalFile,i.value),p.finialBase64=await Ke(p.finialFile)||"",p.finialSize=p.finialFile.size,p.finialName=p.finialFile.name,p.processing=!1;u.value=!0,s.value=!1},h=()=>{o.value.forEach(p=>{Kt(p.finialFile)})},F=p=>{var I;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",p),(I=n.value)==null||I.remove(p)};return te(()=>t.state.toolboxImageListModule.toolboxImageList,p=>{o.value=p},{immediate:!0,deep:!0}),(p,I)=>{const A=vn,B=mt,v=Fn,R=Ce;return f(),b("div",oi,[o.value.length?(f(),b("div",ui,[(f(!0),b(ce,null,de(o.value,w=>(f(),$(A,{"img-obj":w,key:w.uuid,onRemove:F},null,8,["img-obj"]))),128))])):C("",!0),d("div",{class:se(["compress-tool-right",{"no-img":!o.value.length}])},[r(B,{ref_key:"gettingImagesRef",ref:n,onGetImgList:c},null,512),r(v,{ref_key:"compressConfigBoxRef",ref:a,style:{"margin-top":"18rem"},onEncoder:I[0]||(I[0]=w=>m(w))},null,512),d("div",{class:se(["user-operate",{compressed:u.value&&o.value.length>1}])},[u.value&&o.value.length>1?(f(),$(R,{key:0,plain:"",type:"success",onClick:h},{default:_(()=>[S(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1})):C("",!0),d("div",null,[o.value.length?(f(),$(R,{key:0,plain:"",type:"warning",onClick:g},{default:_(()=>[S(" \u91CD\u7F6E ")]),_:1})):C("",!0),o.value.length?(f(),$(R,{key:1,disabled:s.value||u.value,plain:"",type:"primary",onClick:D},{default:_(()=>[S(" \u538B\u7F29 ")]),_:1},8,["disabled"])):C("",!0)])],2)],2)])}}});var li=j(ii,[["__scopeId","data-v-3e4ce208"]]);const ri={class:"base64-tool-container"},ci={key:0,class:"base64-tool-left"},di={class:"user-operate"},mi=G({__name:"base64-tool",setup(e){const t=ee(),n=k(null),a=k([]),o=u=>{u.forEach(c=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:c.uuid,originalName:c.file.name,originalSize:c.file.size,originalBase64:c.base64})})},i=()=>{var u;t.dispatch("TOOLBOX_IMG_LIST_RESET"),(u=n.value)==null||u.reset()},s=u=>{var c;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",u),(c=n.value)==null||c.remove(u)};return te(()=>t.state.toolboxImageListModule.toolboxImageList,u=>{a.value=u},{immediate:!0,deep:!0}),(u,c)=>{const m=vn,g=mt,D=Ce;return f(),b("div",ri,[a.value.length?(f(),b("div",ci,[(f(!0),b(ce,null,de(a.value,h=>(f(),$(m,{"card-type":"base64","img-obj":h,key:h.uuid,onRemove:s},null,8,["img-obj"]))),128))])):C("",!0),d("div",{class:se(["base64-tool-right",{"no-img":!a.value.length}])},[r(g,{ref_key:"gettingImagesRef",ref:n,onGetImgList:o},null,512),d("div",di,[a.value.length?(f(),$(D,{key:0,plain:"",type:"warning",onClick:i},{default:_(()=>[S(" \u91CD\u7F6E ")]),_:1})):C("",!0)])],2)])}}});var pi=j(mi,[["__scopeId","data-v-b3c16fa6"]]);const we=" | PicX \u56FE\u5E8A",_i=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Za,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${we}`}},{path:"/upload",name:"upload",component:Ns,meta:{title:`\u56FE\u7247\u4E0A\u4F20${we}`}},{path:"/management",name:"Management",component:ko,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${we}`}},{path:"/settings",name:"settings",component:wu,meta:{title:`\u6211\u7684\u8BBE\u7F6E${we}`}},{path:"/toolbox",name:"Toolbox",component:Pu,meta:{title:`\u5DE5\u5177\u7BB1${we}`},children:[{path:"/toolbox/compress",name:"Compress",component:li},{path:"/toolbox/base64",name:"Base64",component:pi}]},{path:"/feedback",name:"feedback",component:Ju,meta:{title:`\u5E2E\u52A9\u53CD\u9988${we}`}}],Ue=Jn({history:Zn(),routes:_i});Ue.beforeEach((e,t,n)=>{e.meta.title&&(window.document.title=e.meta.title),n()});const bn=()=>{const e=ee(),t=async o=>{await Qn(()=>{const i=document.getElementsByTagName("html")[0];o===Q.dark&&(i.classList.remove("light"),i.classList.add("dark")),o===Q.light&&(i.classList.remove("dark"),i.classList.add("light"))})},n=o=>{const i=u=>{const c=new Date,m=c.getFullYear(),g=c.getMonth()+1,D=c.getDate();return new Date(`${m}/${g}/${D} ${o[u]}:00`).getTime()},s=Date.now();return i(0)<=s&&s<=i(1)},a=async o=>{const{theme:i}=o;i.mode===Q.auto?await t(n(i.autoLightTime)?Q.light:Q.dark):await t(i.mode)};te(()=>e.getters.getUserSettings,async o=>{await a(o)},{deep:!0,immediate:!0})};const fi={id:"busuanzi_value_site_uv",class:"uv"},gi={id:"busuanzi_value_site_pv",class:"pv"},hi=G({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,n=k(null),a=k(!1),o=L(()=>!0),i=(s,u)=>s.querySelector(`.${u?"u":"p"}v`).innerText;return me(()=>{const s=document.createElement("script");s.async=!0,s.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",n.value.appendChild(s),s.onload=()=>{const u=setTimeout(()=>{i(n.value,t.isuv)&&(a.value=!0),clearTimeout(u)},1500)}}),(s,u)=>ne((f(),b("span",{class:"site-count",ref_key:"siteCountDom",ref:n},[S(" \u8D85\u8FC7 "),ne(d("span",fi,null,512),[[xe,e.isuv]]),ne(d("span",gi,null,512),[[xe,!e.isuv]]),S(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[xe,a.value&&l(o)]])}});var Ei="./assets/logo.206d082d.png";const Dn=e=>(De("data-v-1f5f4d49"),e=e(),Ie(),e),Fi={class:"header"},vi={class:"header-left"},bi=Dn(()=>d("div",{class:"logo"},[d("img",{src:Ei,alt:"PicX"})],-1)),Di=Dn(()=>d("div",{class:"title"},"PicX",-1)),Ii=[bi,Di],Ci={class:"website-count"},yi={class:"header-right"},Ai={class:"username"},wi={key:0,class:"avatar"},Si={class:"el-dropdown-link"},ki={class:"avatar"},Bi=["src","alt"],Li=G({__name:"header-content",setup(e){const t=$e(),n=ee(),a=L(()=>n.getters.getUserConfigInfo).value,o=()=>{!a.logined&&t.currentRoute.value.path!=="/config"&&t.push("/config")},i=()=>{n.dispatch("LOGOUT"),t.push("/config")},s=u=>{switch(u){case"upload":t.push("/");break;case"config":t.push("/config");break;case"management":t.push("/management");break;case"logout":i();break}};return(u,c)=>{var I,A;const m=hi,g=J("UserFilled"),D=re,h=yt,F=At,p=wt;return f(),b("header",Fi,[d("div",vi,[d("div",{class:"brand",onClick:c[0]||(c[0]=B=>l(t).push("/"))},Ii),d("div",Ci,[r(m,{isuv:!1})])]),d("div",yi,[d("div",{class:"user-info",onClick:o},[d("div",Ai,O(l(a).owner?l(a).owner:u.$t("header.notLogin")),1),((I=l(a))==null?void 0:I.avatarUrl)?C("",!0):(f(),b("div",wi,[r(D,{size:22},{default:_(()=>[r(g)]),_:1})])),((A=l(a))==null?void 0:A.avatarUrl)?(f(),$(p,{key:1,trigger:"click",onCommand:s},{dropdown:_(()=>[r(F,null,{default:_(()=>[r(h,{command:"logout"},{default:_(()=>[S(O(u.$t("header.logout")),1)]),_:1})]),_:1})]),default:_(()=>{var B,v;return[d("span",Si,[d("span",ki,[d("img",{src:(B=l(a))==null?void 0:B.avatarUrl,alt:(v=l(a))==null?void 0:v.owner},null,8,Bi)])])]}),_:1})):C("",!0)])])])}}});var $i=j(Li,[["__scopeId","data-v-1f5f4d49"]]);const xi=[{name:"nav.config",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"nav.upload",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"nav.management",icon:"picture",isActive:!1,path:"/management",isShow:!0},{name:"nav.settings",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"nav.toolbox",icon:"files",isActive:!1,path:"/toolbox",isShow:!0},{name:"nav.feedback",icon:"chat-dot-round",isActive:!1,path:"/feedback",isShow:!0}];const Ti={class:"nav"},Ri={class:"nav-list"},Oi=["onClick"],Ui={class:"nav-content"},Mi={class:"nav-name"},Pi={class:"nav-item quick-actions flex-center"},Vi={class:"nav-content"},Ni={class:"nav-name"},Gi={class:"quick-actions-box"},ji=G({__name:"nav-content",setup(e){const t=$e(),n=ee(),a=L(()=>n.getters.getUserConfigInfo).value,o=L(()=>n.getters.getUserSettings).value,i=L(()=>{switch(o.elementPlusSize){case Z.small:return 22;case Z.large:return 30;default:return 26}}),s=k(o.theme.mode===Q.dark),u=k(xi),c=h=>{const{path:F}=h;if(F==="/management"){if(a.selectedRepo===""){x.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),t.push("/config");return}if(a.selectedDir===""){x.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),t.push("/config");return}}t.push(F)},m=h=>{u.value.forEach(F=>{const p=F;return p.isActive=F.path===h||h.includes(F.path),p})},g=()=>{n.dispatch("USER_SETTINGS_PERSIST")},D=()=>{o.theme.mode===Q.dark?o.theme.mode=Q.light:o.theme.mode=Q.dark,g()};return te(()=>t.currentRoute.value,h=>{m(h.path)}),te(()=>a.logined,h=>{u.value.forEach(F=>{switch(F.path){case"/management":case"/settings":F.isShow=h}})},{deep:!0,immediate:!0}),Ct(()=>{t.isReady().then(()=>{const h=`/${t.currentRoute.value.path.split("/")[1]}`;m(h)})}),me(()=>{t.isReady().then(()=>{m(t.currentRoute.value.path)})}),(h,F)=>{const p=re,I=J("Operation"),A=Lt,B=ea;return f(),b("aside",Ti,[d("ul",Ri,[(f(!0),b(ce,null,de(u.value,(v,R)=>ne((f(),b("li",{class:se(["nav-item flex-center",{active:v.isActive}]),key:R,onClick:w=>c(v)},[d("div",Ui,[r(p,{size:l(i)},{default:_(()=>[(f(),$($t(v.icon)))]),_:2},1032,["size"]),d("span",Mi,O(h.$t(v.name)),1)])],10,Oi)),[[xe,v.isShow]])),128))]),d("div",Pi,[r(B,{placement:"right",width:200,trigger:"click"},{reference:_(()=>[d("div",Vi,[r(p,{size:l(i)},{default:_(()=>[r(I)]),_:1},8,["size"]),d("span",Ni,O(h.$t("nav.actions")),1)])]),default:_(()=>[d("div",Gi,[r(A,{modelValue:s.value,"onUpdate:modelValue":F[0]||(F[0]=v=>s.value=v),class:"mb-2","active-text":h.$t("actions.night"),onChange:D},null,8,["modelValue","active-text"]),r(A,{modelValue:l(o).watermark.enable,"onUpdate:modelValue":F[1]||(F[1]=v=>l(o).watermark.enable=v),class:"mb-2","active-text":h.$t("actions.watermark"),onChange:g},null,8,["modelValue","active-text"]),r(A,{modelValue:l(o).compress.enable,"onUpdate:modelValue":F[2]||(F[2]=v=>l(o).compress.enable=v),class:"mb-2","active-text":h.$t("actions.compress"),onChange:g},null,8,["modelValue","active-text"]),r(A,{modelValue:l(o).imageLinkFormat.enable,"onUpdate:modelValue":F[3]||(F[3]=v=>l(o).imageLinkFormat.enable=v),class:"mb-2","active-text":h.$t("actions.transform")+l(o).imageLinkFormat.selected,onChange:g},null,8,["modelValue","active-text"])])]),_:1})])])}}});var zi=j(ji,[["__scopeId","data-v-1c3fb0df"]]);const Hi={class:"main-container"},Xi={class:"top-container"},Ki={class:"bottom-container"},Wi={class:"bottom-content"},Yi={class:"left"},qi={class:"right"},Ji=G({__name:"main-container",setup(e){return me(()=>{bn()}),(t,n)=>{const a=J("router-view");return f(),b("main",Hi,[d("div",Xi,[r($i)]),d("div",Ki,[d("div",Wi,[d("div",Yi,[r(zi)]),d("div",qi,[r(a)])])])])}}});var Zi=j(Ji,[["__scopeId","data-v-c5c7351e"]]);const Qi=G({__name:"App",setup(e){const t=ee(),n=k("default"),a=o=>{o<=600?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:Z.small}),n.value=Z.small):o<=900?(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:Z.default}),n.value=Z.default):(t.dispatch("SET_USER_SETTINGS",{elementPlusSize:Z.large}),n.value=Z.large)};return me(()=>{bn(),a(window.innerWidth),window.addEventListener("resize",ba(o=>{a(o.target.innerWidth)},800))}),(o,i)=>(f(),$(l(na),{size:n.value,"z-index":3e3,locale:l(ta)},{default:_(()=>[r(Zi)]),_:1},8,["size","locale"]))}}),el={notLogin:"\u672A\u767B\u5F55",logout:"\u9000\u51FA\u767B\u5F55"},tl={config:"\u56FE\u5E8A\u914D\u7F6E",upload:"\u4E0A\u4F20\u56FE\u7247",management:"\u56FE\u5E8A\u7BA1\u7406",settings:"\u6211\u7684\u8BBE\u7F6E",toolbox:"\u5DE5\u5177\u7BB1",feedback:"\u5E2E\u52A9\u53CD\u9988",actions:"\u5FEB\u6377\u64CD\u4F5C"},nl={night:"\u6697\u591C\u6A21\u5F0F",watermark:"\u6DFB\u52A0\u6C34\u5370",compress:"\u538B\u7F29\u56FE\u7247",transform:"\u8F6C\u6362 "};var al={header:el,nav:tl,actions:nl};const sl={notLogin:"Not Login",logout:"Logout"},ol={config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},ul={night:"Night Mode",compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "};var il={header:sl,nav:ol,actions:ul};const ll=aa({locale:"zh-CN",messages:{"zh-CN":al,"en-US":il}}),In="custom-contextmenu-container";let z=null,ft=!1;const rl={mounted(e,t){e.addEventListener("contextmenu",n=>{const{dir:a,type:o,img:i}=t.value;n.preventDefault(),n.stopPropagation();const s=L(()=>V.getters.getUserViewDir).value,u=a?`${s==="/"?"":`${s}/`}${a}`:s;z=document.querySelector(`.${In}`),z||(z=document.createElement("ul"),z.setAttribute("class",In),z.style.position="fixed",z.style.zIndex="1000",z.innerHTML='<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">\u590D\u5236\u56FE\u7247\u94FE\u63A5</li>',document.body.appendChild(z));const c=z==null?void 0:z.querySelector(".upload-image"),m=z==null?void 0:z.querySelector(".copy-link");o===ye.img?(m.style.display="block",c.innerHTML="\u4ECE\u5F53\u524D\u4F4D\u7F6E\u4E0A\u4F20\u65B0\u56FE\u7247"):(m.style.display="none",c.innerHTML=`\u4E0A\u4F20\u56FE\u7247\u5230 < ${u==="/"?"\u6839\u76EE\u5F55":u} > \u76EE\u5F55`);let g=n.clientX,D=n.clientY;const h=z.clientWidth,F=z.clientHeight,p=document.documentElement.clientWidth,I=document.documentElement.clientHeight,A=6;h+g>p&&(g=p-h-A),F+D>I&&(D=I-F-A),z.style.top=`${D}px`,z.style.left=`${g}px`,ft||(ft=!0,c==null||c.addEventListener("click",async()=>{const v=u==="/"?Y.rootDir:Y.repoDir,R=u==="/"?[]:u.split("/");await V.dispatch("SET_USER_CONFIG_INFO",{dirMode:v,selectedDir:u,selectedDirList:R}),await Ue.push("/upload")}),m==null||m.addEventListener("click",async()=>{const v=L(()=>V.getters.getUserConfigInfo).value,R=L(()=>V.getters.getUserSettings).value;We(i,v,R)}));const B=()=>{z&&(document.removeEventListener("click",B),document.body.removeChild(z),z=null,ft=!1)};document.addEventListener("click",B)})}};const gt=sa(Qi);gt.directive("contextmenu",rl);for(const[e,t]of Object.entries(oa))gt.component(e,t);gt.use(Ue).use(V,tn).use(ll).mount("#app");
