var Wt=Object.defineProperty,Qt=Object.defineProperties;var Zt=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var en=Object.prototype.hasOwnProperty,tn=Object.prototype.propertyIsEnumerable;var Ze=(e,t,s)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ge=(e,t)=>{for(var s in t||(t={}))en.call(t,s)&&Ze(e,s,t[s]);if(Qe)for(var s of Qe(t))tn.call(t,s)&&Ze(e,s,t[s]);return e},Ne=(e,t)=>Qt(e,Zt(t));import{C as nn,e as sn,d as on,a as an,c as un,u as ln,b as rn,E as z,f as S,g as P,h as De,r as B,w as K,i as ke,j as et,k as ze,l as tt,m as nt,n as st,o as ot,p as ce,q as at,s as cn,v as $e,t as _,x as D,y as c,z as f,A as r,B as oe,D as T,F as J,G as y,H as v,I as de,J as _e,K as V,L as dn,M as ne,N as i,O as ae,P as ue,Q as _n,R as j,S as pn,T as le,U as he,V as Ie,W as ut,X as pe,Y as lt,Z as it,_ as rt,$ as ct,a0 as mn,a1 as we,a2 as Le,a3 as dt,a4 as fn,a5 as _t,a6 as gn,a7 as hn,a8 as En,a9 as pt,aa as vn,ab as Fn,ac as Dn,ad as In,ae as mt,af as Cn,ag as An,ah as bn}from"./vendor.eba18976.js";const Sn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const a of u.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(o){if(o.ep)return;o.ep=!0;const u=s(o);fetch(o.href,u)}};Sn();const yn="modulepreload",ft={},kn="./",gt=function(t,s){return!s||s.length===0?t():Promise.all(s.map(n=>{if(n=`${kn}${n}`,n in ft)return;ft[n]=!0;const o=n.endsWith(".css"),u=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${u}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":yn,o||(a.as="script",a.crossOrigin=""),a.href=n,document.head.appendChild(a),o)return new Promise((l,d)=>{a.addEventListener("load",l),a.addEventListener("error",d)})})).then(()=>t())};var me;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(me||(me={}));var Y;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.reposDir="reposDir"})(Y||(Y={}));var M;(function(e){e.staticaly="staticaly",e.jsdelivr="jsdelivr",e.github="github",e.zzko="zzko"})(M||(M={}));const Ue="PICX_",Ge=`${Ue}CONFIG`,ht=`${Ue}UPLOADED`,Et=`${Ue}MANAGEMENT_MULTI`,vt=`${Ue}SETTINGS`;var se;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(se||(se={}));var fe;(function(e){e.newBranch="newBranch",e.reposBranch="reposBranch"})(fe||(fe={}));const Ce=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),$n=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},wn=e=>{if(e==="/")return[];const t=e.split("/"),s=[];let n="";return t.forEach((o,u)=>{n+=`${u>0?"/":""}${o}`,s.unshift(n)}),s};function Ft(e,t,s){var n;return e?t.length===s?e:Ft((n=e.childrenDirs)==null?void 0:n.find(o=>o.dir===t[s]),t,++s):null}const Be=(e,t)=>{if(e==="/")return t;const s=e.split("/");return Ft(t,s,0)},Te=(e,t,s)=>{var n;return s==="dir"?(n=t.childrenDirs)==null?void 0:n.filter(o=>o.type==="dir"):s==="image"?t.imageList.filter(o=>o.type==="image"):[]},Ln=()=>{const e=localStorage.getItem(Et);return e?JSON.parse(e):Ce("/","/")},Un={state:{name:"dirImageListModule",dirObject:Ln()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},s){if(s==="/")return;const n=(l,d,p)=>l?(l.childrenDirs.some(m=>m.dir===d)||l.childrenDirs.push(Ce(d,p)),l.childrenDirs.find(m=>m.dir===d)||Ce(d,p)):Ce(d,p),o=s.split("/");let u="",a=e.dirObject;for(let l=0,d=o.length;l<d;l++){const p=o[l];u+=`${l>0?"/":""}${p}`,a=n(a,p,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",p)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},s){if(s==="/")return;const n=(a,l,d)=>{if(l==="/")return e.dirObject;const p=a.childrenDirs.find(h=>h.dir===l);if(!p)return a;if(d){const h=a.childrenDirs.findIndex(m=>m.dir===l);h!==-1&&a.childrenDirs.splice(h,1)}return p},o=s.split("/");let u=e.dirObject;o.forEach((a,l)=>{u=n(u,a,l===o.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",a)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},s){const n=(u,a,l,d,p=!1)=>{var m;if(!u)return e.dirObject;let h=(m=u.childrenDirs)==null?void 0:m.find(I=>I.dir===a);return h||(h={type:"dir",dir:a,dirPath:l,childrenDirs:[],imageList:[]},u.childrenDirs.push(h)),p&&!h.imageList.some(I=>I.name===d.name)&&h.imageList.push(d),h};let o=e.dirObject;if(s.dir==="/")o.imageList.some(u=>u.name===s.name)||o.imageList.push(s);else{const u=s.dir.split("/");let a="";u.forEach((l,d)=>{a+=`${d>0?"/":""}${l}`,o=n(o,l,a,s,d===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},s){const n=(p,h)=>{if(p.length){const m=p.findIndex(I=>I.uuid===h);m!==-1&&p.splice(m,1)}},o=(p,h,m,I)=>{if(!p)return e.dirObject;const F=p.childrenDirs.find(C=>C.dir===h);return F?(F.dir===h&&I&&n(F.imageList,m.uuid),F):e.dirObject},{dir:u,uuid:a}=s;if(u==="/"){n(e.dirObject.imageList,a),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let d=e.dirObject;l.forEach((p,h)=>{d=o(d,p,s,h===l.length-1),!d.imageList.length&&!d.childrenDirs.length&&wn(d.dirPath).forEach(I=>{const F=Be(I,e.dirObject);if(F&&!F.imageList.length&&!F.childrenDirs.length){const{dirPath:C}=$n(I);t("SET_USER_CONFIG_INFO",{viewDir:C}),t("DIR_IMAGE_LIST_REMOVE_DIR",I)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},s){let n=e.dirObject;if(s==="/"){n.imageList=[],n.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const o=(a,l,d)=>{var h;if(!a)return e.dirObject;const p=(h=a.childrenDirs)==null?void 0:h.find(m=>m.dir===l);return p?(d&&(p.imageList=[],p.childrenDirs=[]),p):e.dirObject},u=s.split("/");u.forEach((a,l)=>{n=o(n,a,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(Et,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e}){e.dirObject=Ce("/","/")}},getters:{getDirObject:e=>e.dirObject}},Bn={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:s}){e.curImgUuid=t,e.curImgBase64Url=s},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const s=e.list.findIndex(n=>n.uuid===t);if(s!==-1&&e.list.splice(s,1),e.list.length===0)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const n=e.list[0];e.curImgBase64Url=n.imgData.base64Url,e.curImgUuid=n.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter(s=>s.uploadStatus.progress!==100);t.length>0&&(e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},Tn=()=>{const e=sessionStorage.getItem(ht);return e?JSON.parse(e):[]},On={state:{uploadedImageList:Tn()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},s){e.uploadedImageList.unshift(s),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},s){if(e.uploadedImageList.length>0){const n=e.uploadedImageList.findIndex(o=>o.uuid===s);n!==-1&&(e.uploadedImageList.splice(n,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem(ht,JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[]}},getters:{getUploadedImageList:e=>e.uploadedImageList}},Dt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},It=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Mn=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Ct=e=>{for(const t in e)switch(Dt(e[t])){case"object":Ct(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},je=(e,t)=>{for(const s in t)Dt(t[s])!=="object"?e&&(e[s]=t[s]):je(e[s],t[s])};class He{static zerofill(t){return t<10?`0${t}`:t}static getYyyyMmDd(t=Date.now()){const s=new Date(t),n=s.getFullYear(),o=s.getMonth()+1,u=s.getDate();return`${n}${this.zerofill(o)}${this.zerofill(u)}`}static formatTimestamp(t=Date.now()){const s=new Date(t),n=s.getFullYear(),o=s.getMonth()+1,u=s.getDate(),a=s.getHours(),l=s.getMinutes(),d=s.getSeconds();return`${n}-${this.zerofill(o)}-${this.zerofill(u)} ${this.zerofill(a)}:${this.zerofill(l)}:${this.zerofill(d)}`}}const At=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],branchMode:fe.reposBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:Y.reposDir,dirList:[],loggingStatus:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(Ge);return t&&(je(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===Y.autoDir&&(e.selectedDir=He.getYyyyMmDd())),e},xn=e=>{const{selectedDir:t,selectedBranch:s,dirMode:n}=e.userConfigInfo;if(n==="newDir"){const o=t.split("");let u=0,a="";for(let l=0;l<o.length&&((o[l]===" "||o[l]==="."||o[l]==="\u3001")&&(o[l]="-"),o[l]==="/"&&(u+=1),!(u>=3));l++)a+=o[l];e.userConfigInfo.selectedDir=a}e.userConfigInfo.selectedBranch=s.replace(/\s+/g,"-")},Rn={state:{userConfigInfo:At()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=At()},SET_USER_CONFIG_INFO({state:e,dispatch:t},s){for(const n in s)e.userConfigInfo.hasOwnProperty(n)&&(e.userConfigInfo[n]=s[n]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},s){e.userConfigInfo.dirList.some(n=>n.value===s)||(e.userConfigInfo.dirList.push({label:s,value:s}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},s){const{dirList:n}=e.userConfigInfo;if(n.some(o=>o.value===s)){const o=n.findIndex(u=>u.value===s);n.splice(o,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){xn(e),localStorage.setItem(Ge,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Ct(e.userConfigInfo)}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},Pn={state:{imageViewer:{imgInfo:null,isShow:!1}},mutations:{IMAGE_VIEWER(e,{imgInfo:t,isShow:s}){e.imageViewer.imgInfo=t,e.imageViewer.isShow=s},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.imgInfo=null}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},Vn={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:s,checked:n}=t;n&&e.imgCardArr.forEach(o=>{o.uuid===s&&(o.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},Nn={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},zn={state:{uploadSettings:{isSetMaxSize:!0,imageMaxSize:30*1024}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!0,e.uploadSettings.imageMaxSize=50*1024}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}};var Oe;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(Oe||(Oe={}));const Gn=async(e,t)=>new nn(e,{encoderState:{type:t,options:sn[t].meta.defaultOptions},processorState:on,preprocessorState:an}).process(),Xe={defaultHash:!0,defaultMarkdown:!1,defaultPrefix:!1,prefixName:"",isCompress:!0,compressEncoder:Oe.webP,themeMode:"light",autoLightThemeTime:["08:00","19:00"],elementPlusSize:"default",externalLinkType:M.staticaly},jn=()=>{const e=Mn(vt);return e&&je(Xe,e),Xe},Hn={state:{userSettings:jn()},actions:{SET_USER_SETTINGS({state:e},t){for(const s in t)e.userSettings.hasOwnProperty(s)&&(e.userSettings[s]=t[s])},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(vt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=Xe}},getters:{getUserSettings:e=>e.userSettings}},N=un({modules:{dirImageListModule:Un,toUploadImageModule:Bn,uploadedImageListModule:On,userConfigInfoModule:Rn,imageViewerModule:Pn,imageCardModule:Vn,uploadAreaActiveModule:Nn,uploadSettingsModule:zn,userSettingsModule:Hn},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("IMAGE_VIEWER_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),t("UPLOAD_SETTINGS_LOGOUT"),e("USER_SETTINGS_LOGOUT"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),bt=Symbol("vuex-store");function H(){return ln(bt)}const Xn="https://api.github.com",W=rn.create({baseURL:Xn,timeout:3e5});W.defaults.headers["Content-Type"]="application/json";W.interceptors.request.use(e=>{const t=localStorage.getItem(Ge);if(t){const{token:s}=JSON.parse(t);s&&(e.headers.Authorization=`token ${s}`)}return e},e=>Promise.reject(e));W.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data){const t=e.response.status,s=e.response.data.message;z.error(`Code: ${t}, Message: ${s}`),console.error("[PicX Error]",e.response)}else z.error(`${e}`);return e.response});const Me=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},Ye=e=>{const t=e.lastIndexOf(".");return e.substr(t+1,e.length)},St=e=>/(png|jpg|gif|jpeg|webp|avif|svg\+xml|image\/x-icon)$/.test(e),Je=e=>Number((e/1024).toFixed(2)),yt=e=>e?{name:Me(e),hash:It(),suffix:Ye(e)}:{name:"",hash:"",suffix:""},kt=()=>{let e=document.querySelector(".temp-external-link-txt");return e||(e=document.createElement("textarea"),e.setAttribute("class","temp-external-link-txt"),e.style.position="absolute",e.style.top="-99999rem",e.style.left="-99999rem",document.body.appendChild(e)),e},ie=(e,t,s)=>{const n=`https://cdn.staticaly.com/gh/${s.owner}/${s.selectedRepos}@${s.selectedBranch}/${t.path}`,o=`https://jsd.cdn.zzko.cn/gh/${s.owner}/${s.selectedRepos}@${s.selectedBranch}/${t.path}`,u=`https://cdn.jsdelivr.net/gh/${s.owner}/${s.selectedRepos}@${s.selectedBranch}/${t.path}`,a=decodeURI(t.download_url);switch(e){case M.staticaly:return n;case M.zzko:return o;case M.jsdelivr:return u;case M.github:return a;default:return a}},re=(e,t)=>`![${Me(e)}](${t})`,Yn=(e,t)=>{let s="",n="";const{name:o,is_transform_md:u}=e;switch(t){case M.jsdelivr:u?(s=re(o,e.jsdelivr_cdn_url),n="Markdown \u683C\u5F0F\u7684 jsDelivr CDN"):(s=e.jsdelivr_cdn_url,n="jsDelivr CDN");break;case M.staticaly:u?(s=re(o,e.staticaly_cdn_url),n="Markdown \u683C\u5F0F\u7684 Staticaly CDN"):(s=e.staticaly_cdn_url,n="Staticaly CDN");break;case M.zzko:u?(s=re(o,e.zzko_cdn_url),n="Markdown \u683C\u5F0F\u7684 zzko CDN"):(s=e.zzko_cdn_url,n="zzko CDN");break;default:u?(s=re(o,e.github_url),n="Markdown \u683C\u5F0F\u7684 GitHub"):(s=e.github_url,n="GitHub")}const a=kt();a.value=s,a.select(),document.execCommand("copy"),z.success(`${n} \u5916\u94FE\u590D\u5236\u6210\u529F\uFF01`)},Jn=(e,t)=>{let s="";const n=kt();n.value="",(e==null?void 0:e.length)>0?(e.forEach((o,u)=>{const a=o.is_transform_md;switch(t){case M.jsdelivr:s=a?re(o.name,o.jsdelivr_cdn_url):o.jsdelivr_cdn_url;break;case M.staticaly:s=a?re(o.name,o.staticaly_cdn_url):o.staticaly_cdn_url;break;case M.zzko:s=a?re(o.name,o.zzko_cdn_url):o.zzko_cdn_url;break;default:s=a?re(o.name,o.github_url):o.github_url}u<e.length-1?n.value+=s+`
`:n.value+=s}),n.select(),document.execCommand("copy"),z.success("\u6279\u91CF\u590D\u5236\u56FE\u7247\u94FE\u63A5\u6210\u529F")):console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},xe=S(()=>N.getters.getUserConfigInfo).value;function qn(e,t){return{type:"image",uuid:It(),dir:t,name:e.name,path:e.path,sha:e.sha,deleting:!1,is_transform_md:!1,size:e.size,checked:!1,github_url:ie(M.github,e,xe),jsdelivr_cdn_url:ie(M.jsdelivr,e,xe),staticaly_cdn_url:ie(M.staticaly,e,xe),zzko_cdn_url:ie(M.zzko,e,xe)}}const Ee=S(()=>N.getters.getUserConfigInfo).value,$t=(e="")=>new Promise(t=>{W.get(`/repos/${Ee.owner}/${Ee.selectedRepos}/contents/${e}`,{params:{ref:Ee.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length>0?t(s.data.filter(n=>n.type==="dir").map(n=>({value:n.name,label:n.name}))):t(null)}).catch(()=>{t(null)})}),Re=(e="")=>new Promise(t=>{W.get(`/repos/${Ee.owner}/${Ee.selectedRepos}/contents/${e}`,{params:{ref:Ee.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length?(s.data.filter(n=>n.type==="dir").forEach(n=>N.dispatch("DIR_IMAGE_LIST_ADD_DIR",n.path)),setTimeout(()=>{s.data.filter(n=>n.type==="file"&&St(Ye(n.name))).forEach(n=>{N.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",qn(n,e))})},100),t(!0)):t(null)}).catch(()=>{t(null)})});var G=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};const Kn={class:"page-container config-page-container"},Wn=P({__name:"config",setup(e){const t=De(),s=H(),n=S(()=>s.getters.getUserConfigInfo).value,o=S(()=>s.getters.getUserConfigInfo).value,u=S(()=>s.getters.getUserSettings).value,a=B(!1),l=B(!1),d=B(!1),p=S(()=>u.elementPlusSize==="large"?"right":"top"),h=B("elCascaderKey");function m(){s.dispatch("USER_CONFIG_INFO_PERSIST")}function I(b){n.loggingStatus=!0,n.owner=b.data.login,n.name=b.data.name,n.email=b.data.email,n.avatarUrl=b.data.avatar_url,m()}function F(b){W.get(b,{params:{type:"public",sort:"created",per_page:100}}).then(E=>{if(console.log("[getReposList] ",E),E.status===200&&E.data.length>0){n.reposList=[];for(const L of E.data)!L.fork&&!L.private&&n.reposList.push({value:L.name,label:L.name,desc:L.description});a.value=!1,m()}})}async function C(){l.value=!0,n.dirList=await $t(),m(),l.value=!1}function k(b){switch(b){case Y.rootDir:n.selectedDir="/";break;case Y.autoDir:n.selectedDir=He.getYyyyMmDd();break;case Y.newDir:n.selectedDir="xxx";break;case Y.reposDir:const{dirList:E}=n;E.length?n.selectedDir=E[0].value:n.selectedDir="";break;default:n.selectedDir="/";break}m()}function g(b){d.value=!0,W.get(`/repos/${n.owner}/${b}/branches`).then(E=>{if(console.log("[getBranchList] ",E),E&&E.status===200){if(d.value=!1,E.data.length>0){for(const L of E.data)n.branchList.push({value:L.name,label:L.name});n.branchList.reverse(),n.selectedBranch=n.branchList[0].value,n.branchMode=fe.reposBranch,C()}else n.selectedBranch="master",n.branchMode=fe.newBranch;k(n.dirMode),m()}})}function $(){n.token?(a.value=!0,W.get("/user",{headers:{Authorization:`token ${n.token}`}}).then(b=>{console.log("[getUserInfo] ",b),b&&b.status===200?(I(b),F(b.data.repos_url)):a.value=!1})):z.warning("Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01")}function A(b){n.branchList=[],n.dirList=[],g(b),m()}async function R(b){n.selectedBranch=b,await C(),h.value=n.selectedBranch,n.selectedDir=n.dirList[0].value,n.selectedDirList=[n.selectedDir],m()}function Q(b){const E=n.selectedBranch,L=n.branchList[0].value;switch(b){case fe.newBranch:n.selectedBranch="xxx",n.dirMode=Y.newDir,n.selectedDir="xxx";break;case fe.reposBranch:E!==L&&(n.selectedBranch=L,C());break;default:n.selectedBranch="";break}m()}function w(){a.value=!1,l.value=!1,s.dispatch("LOGOUT")}function O(){const{selectedDir:b,dirMode:E}=n;let L="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(b===""){switch(E){case Y.newDir:L="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case Y.reposDir:L=`\u8BF7\u9009\u62E9 ${n.selectedRepos} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:L="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}z.warning(L)}else t.push("/upload")}const X={lazy:!0,checkStrictly:!0,async lazyLoad(b,E){const{level:L,pathLabels:x}=b;let Z;L===0?Z=n.dirList:Z=await $t(x.join("/")),E(Z?Z.map(ee=>({value:ee.value,label:ee.label,leaf:L>=2})):[])}};function q(b){n.selectedDirList=b,n.selectedDir=b.join("/"),m()}return K(()=>o,b=>{b||(a.value=!1,l.value=!1)}),(b,E)=>{const L=ke,x=et,Z=ze,ee=tt,be=nt,te=st,Se=ot,ye=ce,qt=at,Kt=cn,Pe=$e;return _(),D("div",Kn,[c(ee,{"label-width":"70rem","label-position":r(p),class:"config-form"},{default:f(()=>[c(x,{label:"Token"},{default:f(()=>[c(L,{modelValue:r(n).token,"onUpdate:modelValue":E[0]||(E[0]=U=>r(n).token=U),clearable:"",autofocus:!r(n).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),c(x,{class:"operation"},{default:f(()=>[c(Z,{plain:"",type:"primary","native-type":"submit",onClick:E[1]||(E[1]=oe(U=>$(),["prevent"]))},{default:f(()=>[T(" \u786E\u8BA4 Token ")]),_:1})]),_:1})]),_:1},8,["label-position"]),r(n).token?J((_(),y(ee,{key:0,"label-width":"70rem","label-position":r(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[r(n).owner?(_(),y(x,{key:0,label:"\u7528\u6237\u540D"},{default:f(()=>[c(L,{modelValue:r(n).owner,"onUpdate:modelValue":E[2]||(E[2]=U=>r(n).owner=U),readonly:""},null,8,["modelValue"])]),_:1})):v("",!0),r(n).email?(_(),y(x,{key:1,label:"\u90AE\u7BB1"},{default:f(()=>[c(L,{modelValue:r(n).email,"onUpdate:modelValue":E[3]||(E[3]=U=>r(n).email=U),readonly:""},null,8,["modelValue"])]),_:1})):v("",!0),r(n).reposList.length?(_(),y(x,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:f(()=>[c(te,{modelValue:r(n).selectedRepos,"onUpdate:modelValue":E[4]||(E[4]=U=>r(n).selectedRepos=U),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:A},{default:f(()=>[(_(!0),D(de,null,_e(r(n).reposList,(U,Ve)=>(_(),y(be,{key:Ve,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):v("",!0)]),_:1},8,["label-position"])),[[Pe,a.value]]):v("",!0),r(n).selectedRepos&&r(n).branchList.length?J((_(),y(ee,{key:1,"label-width":"70rem","label-position":r(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[(r(n).selectedRepos,v("",!0)),r(n).branchList.length>1&&r(n).branchMode==="reposBranch"?(_(),y(x,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:f(()=>[c(te,{modelValue:r(n).selectedBranch,"onUpdate:modelValue":E[6]||(E[6]=U=>r(n).selectedBranch=U),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:R},{default:f(()=>[(_(!0),D(de,null,_e(r(n).branchList,(U,Ve)=>(_(),y(be,{key:Ve,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):v("",!0),r(n).branchMode==="newBranch"?(_(),y(x,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:f(()=>[c(L,{modelValue:r(n).selectedBranch,"onUpdate:modelValue":E[7]||(E[7]=U=>r(n).selectedBranch=U),onInput:E[8]||(E[8]=U=>m()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F..."},null,8,["modelValue"])]),_:1})):v("",!0)]),_:1},8,["label-position"])),[[Pe,d.value]]):v("",!0),r(n).selectedBranch?J((_(),y(ee,{key:2,"label-width":"70rem","label-position":r(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:f(()=>[r(n).selectedBranch?(_(),y(x,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:f(()=>[c(qt,{modelValue:r(n).dirMode,"onUpdate:modelValue":E[9]||(E[9]=U=>r(n).dirMode=U),onChange:k},{default:f(()=>[c(ye,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[c(Se,{label:"newDir"},{default:f(()=>[T("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),c(ye,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+r(n).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:f(()=>[c(Se,{label:"rootDir"},{default:f(()=>[T("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),c(ye,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[c(Se,{label:"autoDir"},{default:f(()=>[T("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),r(n).dirList.length&&r(n).branchMode!=="newBranch"?(_(),y(ye,{key:0,content:"\u9009\u62E9 "+r(n).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:f(()=>[c(Se,{label:"reposDir"},{default:f(()=>[T(" \u9009\u62E9 "+V(r(n).selectedRepos)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):v("",!0)]),_:1},8,["modelValue"])]),_:1})):v("",!0),r(n).dirMode==="autoDir"?(_(),y(x,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:f(()=>[c(L,{modelValue:r(n).selectedDir,"onUpdate:modelValue":E[10]||(E[10]=U=>r(n).selectedDir=U),readonly:""},null,8,["modelValue"])]),_:1})):v("",!0),r(n).dirMode==="rootDir"?(_(),y(x,{key:2,label:"\u6839\u76EE\u5F55"},{default:f(()=>[c(L,{modelValue:r(n).selectedDir,"onUpdate:modelValue":E[11]||(E[11]=U=>r(n).selectedDir=U),readonly:""},null,8,["modelValue"])]),_:1})):v("",!0),r(n).dirMode==="newDir"?(_(),y(x,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:f(()=>[c(L,{modelValue:r(n).selectedDir,"onUpdate:modelValue":E[12]||(E[12]=U=>r(n).selectedDir=U),onInput:E[13]||(E[13]=U=>m()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):v("",!0),r(n).dirList.length&&r(n).dirMode==="reposDir"&&r(n).branchMode!=="newBranch"?(_(),y(x,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:f(()=>[(_(),y(Kt,{style:{width:"100%"},props:X,key:h.value,modelValue:r(n).selectedDirList,"onUpdate:modelValue":E[14]||(E[14]=U=>r(n).selectedDirList=U),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:"",onChange:q},null,8,["modelValue"]))]),_:1})):v("",!0)]),_:1},8,["label-position"])),[[Pe,l.value]]):v("",!0),c(ee,{"label-width":"70rem","label-position":r(p)},{default:f(()=>[c(x,{class:"operation"},{default:f(()=>[r(n).owner?(_(),y(Z,{key:0,plain:"",type:"warning",onClick:E[15]||(E[15]=U=>w())},{default:f(()=>[T(" \u91CD\u7F6E ")]),_:1})):v("",!0),r(n).selectedRepos?(_(),y(Z,{key:1,plain:"",type:"success",onClick:O},{default:f(()=>[T(" \u5B8C\u6210\u914D\u7F6E ")]),_:1})):v("",!0)]),_:1})]),_:1},8,["label-position"])])}}});var Qn=G(Wn,[["__scopeId","data-v-4ca595c3"]]);const wt=e=>(ae("data-v-439af088"),e=e(),ue(),e),Zn={class:"copy-external-link-box"},es={key:0,t:"1631782798077",class:"markdown-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2861",width:"26",height:"26"},ts=wt(()=>i("path",{d:"M92 192C42.24 192 0 232.128 0 282.016v459.968C0 791.904 42.24 832 92 832h840C981.76 832 1024 791.872 1024 741.984V282.016C1024 232.16 981.76 192 932 192z m0 64h840c16.512 0 28 12.256 28 26.016v459.968c0 13.76-11.52 26.016-28 26.016H92C75.488 768 64 755.744 64 741.984V282.016c0-13.76 11.52-25.984 28-25.984zM160 352v320h96v-212.992l96 127.008 96-127.04V672h96V352h-96l-96 128-96-128z m544 0v160h-96l144 160 144-160h-96v-160z","p-id":"2862",fill:"#808080"},null,-1)),ns=[ts],ss={key:1,t:"1631784688556",class:"markdown-icon active",viewBox:"0 0 1280 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3242",width:"26",height:"26"},os=wt(()=>i("path",{d:"M1187.6 118.2H92.4C41.4 118.2 0 159.6 0 210.4v603c0 51 41.4 92.4 92.4 92.4h1095.4c51 0 92.4-41.4 92.2-92.2V210.4c0-50.8-41.4-92.2-92.4-92.2zM677 721.2H554v-240l-123 153.8-123-153.8v240H184.6V302.8h123l123 153.8 123-153.8h123v418.4z m270.6 6.2L763 512H886V302.8h123V512H1132z","p-id":"3243",fill:"#3c3c3c"},null,-1)),as=[os],us={class:"btn-box"},ls=P({__name:"copy-external-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,s=S(()=>N.getters.getUserSettings).value;let n=B(t.imgObj).value;const o=M,u=a=>{Yn(n,a)};return dn(()=>{n=t.imgObj}),ne(()=>{n.is_transform_md=s.defaultMarkdown}),K(()=>s.defaultMarkdown,a=>{n.is_transform_md=a}),(a,l)=>{const d=ce;return _(),D("div",Zn,[i("div",null,[c(d,{content:r(n).is_transform_md?"\u70B9\u51FB\u8F6C\u6362\u666E\u901A\u5916\u94FE":"\u70B9\u51FB\u8F6C\u6362 Markdown \u683C\u5F0F\u5916\u94FE",placement:"top"},{default:f(()=>[i("div",{class:"markdown-icon-box flex-center",onClick:l[0]||(l[0]=p=>r(n).is_transform_md=!r(n).is_transform_md)},[r(n).is_transform_md?v("",!0):(_(),D("svg",es,ns)),r(n).is_transform_md?(_(),D("svg",ss,as)):v("",!0)])]),_:1},8,["content"])]),i("div",us,[c(d,{content:"\u70B9\u51FB\u590D\u5236 Staticaly CDN \u5916\u94FE",placement:"top"},{default:f(()=>[i("span",{class:"btn-item copy-url flex-center",onClick:l[1]||(l[1]=p=>u(r(o).staticaly))}," Staticaly ")]),_:1}),c(d,{content:"\u70B9\u51FB\u590D\u5236 zzko CDN \u5916\u94FE",placement:"top"},{default:f(()=>[i("span",{class:"btn-item copy-url flex-center",onClick:l[2]||(l[2]=p=>u(r(o).zzko))}," zzko ")]),_:1})])])}}});var qe=G(ls,[["__scopeId","data-v-439af088"]]),Lt=()=>({uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",prefixName:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1,isPrefix:!1},externalLink:{github:"",jsdelivr:"",staticaly:"",zzko:""}});function is(e,t){const s=document.createElement("canvas"),n=s.getContext("2d"),o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(u=>{o.onload=()=>{const{width:a}=o,{height:l}=o;s.width=a,s.height=l,n==null||n.drawImage(o,0,0,a,l);const d=s.toDataURL(`image/${t}`);u(d)}})}function rs(e,t){const s=S(()=>N.getters.getUserSettings).value,n=Lt();n.imgData.base64Url=e,n.imgData.base64Content=e.split(",")[1];const{name:o,hash:u,suffix:a}=yt(t.name);return n.uuid=u,n.fileInfo.size=t.size,n.fileInfo.originSize=t.size,n.fileInfo.lastModified=t.lastModified,n.filename.name=o,n.filename.hash=u,n.filename.suffix=a,n.filename.now=s.defaultHash?`${o}.${u}.${a}`:`${o}.${a}`,n.filename.initName=o,n.filename.isHashRename=s.defaultHash,n}const cs=(e,t)=>{let s="";return e.selectedDir!=="/"&&(s=`${e.selectedDir}/`),`/repos/${e.owner}/${e.selectedRepos}/contents/${s}${t}`};function Ut(e,t){const{selectedBranch:s,email:n,owner:o}=e;t.uploadStatus.uploading=!0;const u={message:"Upload picture via PicX(https://github.com/XPoet/picx)",branch:s,content:t.imgData.base64Content};return n&&(u.committer={name:o,email:n}),new Promise((a,l)=>{W.put(cs(e,t.filename.now),u).then(d=>{d&&d.status===201?(ds(d,t,e),N.dispatch("TO_UPLOAD_IMAGE_UPLOADED",t.uuid),a(!0)):(t.uploadStatus.uploading=!1,a(!1))}).catch(d=>{l(d)})})}function ds(e,t,s){const n=N.getters.getUserSettings;t.uploadStatus.progress=100,t.uploadStatus.uploading=!1,t.externalLink.github=ie(M.github,e.data.content,s),t.externalLink.jsdelivr=ie(M.jsdelivr,e.data.content,s),t.externalLink.staticaly=ie(M.staticaly,e.data.content,s),t.externalLink.zzko=ie(M.zzko,e.data.content,s);const o={checked:!1,type:"image",uuid:t.uuid,dir:s.selectedDir,name:e.data.content.name,path:e.data.content.path,sha:e.data.content.sha,is_transform_md:n.defaultMarkdown,deleting:!1,size:t.fileInfo.size,github_url:t.externalLink.github,jsdelivr_cdn_url:t.externalLink.jsdelivr,staticaly_cdn_url:t.externalLink.staticaly,zzko_cdn_url:t.externalLink.zzko};t.uploadedImg=o,N.dispatch("UPLOADED_LIST_ADD",o),N.dispatch("DIR_IMAGE_LIST_ADD_DIR",s.selectedDir),N.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)}const _s={class:"image-box"},ps=["src"],ms={class:"info-box"},fs={class:"image-info"},gs={key:1,class:"filename"},hs={class:"image-operation"},Es={class:"operation-box"},vs={class:"operation-left"},Fs={class:"operation-right"},Ds={class:"operation-btn"},Is=P({__name:"image-card",props:{listing:{type:Boolean,default:!1},imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1},index:{type:Number},modelValue:{type:Number}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,n=H(),o=_n(),u=S(()=>n.getters.getUserConfigInfo).value,a=S(()=>n.getters.getUserSettings).value,l=S(()=>o.path==="/management"),d=S(()=>{switch(a.externalLinkType){case M.jsdelivr:return s.imageObj.jsdelivr_cdn_url;case M.staticaly:return s.imageObj.staticaly_cdn_url;case M.zzko:return s.imageObj.zzko_cdn_url;default:return s.imageObj.github_url}}),p=B(),h=B(!1),m=B(""),I=B(!1),F=(w,O=!1)=>{O||(w.deleting=!0);const{owner:X,selectedRepos:q}=u;return new Promise(b=>{W.delete(`/repos/${X}/${q}/contents/${w.path}`,{data:{owner:X,repo:q,path:w.path,message:"Delete pictures via PicX (https://github.com/XPoet/picx)",sha:w.sha}}).then(E=>{console.log("deleteImage >> ",E),E&&E.status===200?(w.deleting=!1,z.success(`${O?"\u66F4\u65B0":"\u5220\u9664"}\u6210\u529F\uFF01`),n.dispatch("UPLOADED_LIST_REMOVE",w.uuid),n.dispatch("DIR_IMAGE_LIST_REMOVE",w),b(!0)):w.deleting=!1})})},C=w=>{Ie.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${w.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{F(w)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},k=w=>{w.checked=!w.checked,n.commit("IMAGE_CARD",{imageObj:w})},g=async w=>{t("update:modelValue",s.index),m.value=Me(w.name),await ut(()=>{const O=setTimeout(()=>{var X;(X=p.value)==null||X.focus(),clearTimeout(O)},150)})},$=()=>{t("update:modelValue",void 0)},A=async()=>{$();const{imageObj:w}=s;if(m.value===Me(w.name)||!m.value)return;const O=async()=>{const X=ct.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),q=Ye(w.name),b={name:m.value+w.name.substring(w.name.indexOf(".")),size:w.size,lastModified:Date.now(),type:`image/${q}`},E=await is(d.value,q);if(E){const L=rs(E,b);L&&await Ut(u,L)&&(m.value="",await F(w,!0),await n.dispatch("UPLOADED_LIST_REMOVE",L.uuid))}X.close()};Ie.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${m.value} \uFF1F`,"\u63D0\u793A",{type:"warning"}).then(async()=>{await O()}).catch(()=>{console.log("\u53D6\u6D88\u56FE\u7247\u91CD\u547D\u540D")})},R=w=>{I.value=w},Q=w=>{Ie.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${w.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Je(w.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(w,O)=>{const X=ke,q=qe,b=j("Check"),E=pe,L=j("MoreFilled"),x=lt,Z=it,ee=rt,be=$e;return J((_(),D("div",{class:le(["image-card",{listing:e.listing,checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:O[5]||(O[5]=te=>h.value=!0),onMouseleave:O[6]||(O[6]=te=>h.value=!1)},[i("div",_s,[i("img",{"data-fancybox":"gallery",src:r(d)},null,8,ps)]),i("div",ms,[i("div",fs,[m.value&&s.modelValue===s.index?(_(),y(X,{key:0,size:"small",class:"rename-input",modelValue:m.value,"onUpdate:modelValue":O[0]||(O[0]=te=>m.value=te),onBlur:$,onKeydown:pn(oe(A,["prevent"]),["enter"]),ref_key:"renameInputRef",ref:p},null,8,["modelValue","onKeydown"])):(_(),D("div",gs,V(e.imageObj.name),1)),i("div",hs,[c(q,{"img-obj":e.imageObj},null,8,["img-obj"])])])]),J(i("div",Es,[i("div",vs,[r(l)?(_(),D("div",{key:0,class:le([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:O[1]||(O[1]=te=>k(e.imageObj))},[e.imageObj.checked?(_(),y(E,{key:0},{default:f(()=>[c(b)]),_:1})):v("",!0)],2)):v("",!0)]),i("div",Fs,[c(ee,{size:"default",trigger:"click",onVisibleChange:R},{dropdown:f(()=>[c(Z,null,{default:f(()=>[c(x,{onClick:O[2]||(O[2]=te=>C(e.imageObj))},{default:f(()=>[T(" \u5220\u9664 ")]),_:1}),c(x,{onClick:O[3]||(O[3]=oe(te=>g(e.imageObj),["self"]))},{default:f(()=>[T(" \u91CD\u547D\u540D ")]),_:1}),c(x,{onClick:O[4]||(O[4]=te=>Q(e.imageObj))},{default:f(()=>[T(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:f(()=>[i("div",Ds,[c(E,null,{default:f(()=>[c(L)]),_:1})])]),_:1})])],512),[[he,h.value||I.value||e.imageObj.checked]])],34)),[[be,e.imageObj.deleting]])}}});var Bt=G(Is,[["__scopeId","data-v-878ae3a8"]]);const Cs={key:0,class:"selected-info-bar-box"},As={class:"info-item"},bs={key:0,class:"info-item"},Ss={class:"info-item"},ys=P({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=H(),s=S(()=>t.getters.getUserConfigInfo);return S(()=>t.getters.getUserSettings),(n,o)=>{const u=mn;return r(s).selectedRepos?(_(),D("div",Cs,[i("span",As,[T(" \u4ED3\u5E93\uFF1A "),c(u,{"disable-transitions":""},{default:f(()=>[T(V(r(s).selectedRepos),1)]),_:1})]),r(s).selectedBranch?(_(),D("span",bs,[T(" \u5206\u652F\uFF1A "),c(u,{"disable-transitions":""},{default:f(()=>[T(V(r(s).selectedBranch),1)]),_:1})])):v("",!0),i("span",Ss,[T(" \u76EE\u5F55\uFF1A "),c(u,{"disable-transitions":""},{default:f(()=>[T(V(e.barType==="management"?r(s).viewDir:r(s).selectedDir),1)]),_:1})])])):v("",!0)}}});var Ke=G(ys,[["__scopeId","data-v-8c50316c"]]);const ks=P({name:"to-upload-image-card",components:{copyExternalLink:qe,selectedInfoBar:Ke},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=H(),t=we({isShowDialog:!1,curImgInfo:{size:""},userConfigInfo:S(()=>e.getters.getUserConfigInfo).value,userSettings:S(()=>e.getters.getUserSettings).value,toUploadImage:S(()=>e.getters.getToUploadImage).value,hashRename(n,o){n?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},prefixName(n,o){n?o.filename.name=`${o.filename.prefixName}${o.filename.initName}`:o.filename.name=`${o.filename.initName}`,o.filename.isHashRename?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},rename(n,o){n?o.filename.name=o.filename.newName.trim().replace(/\s+/g,"-"):t.prefixName(o.filename.isPrefix,o),o.filename.isHashRename?o.filename.now=`${o.filename.name}.${o.filename.hash}.${o.filename.suffix}`:o.filename.now=`${o.filename.name}.${o.filename.suffix}`},getFileSize(n){return`${Je(n)} KB`},formatLastModified(n){return He.formatTimestamp(n)},async uploadImage_all(n){const o=this.toUploadImage.uploadedNumber;return o>=this.toUploadImage.list.length?se.uploaded:await Ut(n,this.toUploadImage.list[o])?o<this.toUploadImage.list.length?(await this.uploadImage_all(n),se.allUploaded):se.uploaded:se.uploadFail}}),s=n=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",n.uuid)};return ne(()=>{const{defaultHash:n,defaultPrefix:o,prefixName:u}=t.userSettings;t.toUploadImage.list.forEach(a=>{a.filename.isPrefix=o,a.filename.prefixName=u,t.prefixName(o,a),a.filename.isHashRename=n,t.hashRename(n,a)})}),Ne(ge({},Le(t)),{removeToUploadImage:s})}}),$s={key:0,class:"to-upload-image-list-card"},ws={class:"header"},Ls={key:0},Us={key:0,class:"body"},Bs={class:"image-uploading-info-box"},Ts={class:"left-image-box"},Os=["src"],Ms={class:"right-operation-box"},xs={class:"top"},Rs={class:"image-name"},Ps={class:"image-info"},Vs={key:0,class:"file-size item"},Ns={class:"last-modified item"},zs={key:0,class:"bottom rename-operation"},Gs={key:1,class:"bottom rename-operation"},js=["onClick"];function Hs(e,t,s,n,o,u){const a=Ke,l=dt,d=ke,p=qe,h=j("Upload"),m=pe,I=j("Loading"),F=j("Check"),C=j("Delete"),k=ce;return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(_(),D("div",$s,[i("div",ws,[i("div",null,[c(a)]),i("div",null,[e.toUploadImage.list.length?(_(),D("span",Ls," \u5DF2\u4E0A\u4F20\uFF1A"+V(e.toUploadImage.uploadedNumber)+" / "+V(e.toUploadImage.list.length),1)):v("",!0)])]),e.toUploadImage.list.length?(_(),D("div",Us,[i("ul",Bs,[(_(!0),D(de,null,_e(e.toUploadImage.list,(g,$)=>(_(),D("li",{class:le(["image-uploading-info-item",{disable:e.loadingAllImage}]),key:$},[i("div",Ts,[i("img",{"data-fancybox":"gallery",src:g.imgData.base64Url},null,8,Os)]),i("div",Ms,[i("div",xs,[i("div",Rs,V(g.filename.now),1),i("div",Ps,[e.userSettings.isCompress?(_(),D("span",Vs,[i("del",null,V(e.getFileSize(g.fileInfo.originSize)),1)])):v("",!0),i("span",{class:le(["file-size item",{compressed:e.userSettings.isCompress}])},V(e.getFileSize(g.fileInfo.size)),3),i("span",Ns,V(e.formatLastModified(g.fileInfo.lastModified)),1)])]),!g.uploadStatus.uploading&&g.uploadStatus.progress!==100?(_(),D("div",zs,[c(l,{label:"\u54C8\u5E0C\u5316",modelValue:g.filename.isHashRename,"onUpdate:modelValue":A=>g.filename.isHashRename=A,onChange:A=>e.hashRename(A,g)},null,8,["modelValue","onUpdate:modelValue","onChange"]),c(l,{label:"\u91CD\u547D\u540D",modelValue:g.filename.isRename,"onUpdate:modelValue":A=>g.filename.isRename=A,onChange:A=>e.rename(A,g)},null,8,["modelValue","onUpdate:modelValue","onChange"]),g.filename.isRename?(_(),y(d,{key:0,class:"rename-input",size:"small",modelValue:g.filename.newName,"onUpdate:modelValue":A=>g.filename.newName=A,onInput:A=>e.rename(A,g),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):v("",!0),!g.filename.isRename&&e.userConfigInfo.defaultPrefix&&e.userConfigInfo.prefixName?(_(),y(l,{key:1,label:"\u547D\u540D\u524D\u7F00",modelValue:g.filename.isPrefix,"onUpdate:modelValue":A=>g.filename.isPrefix=A,onChange:A=>e.prefixName(A,g)},null,8,["modelValue","onUpdate:modelValue","onChange"])):v("",!0)])):v("",!0),!g.uploadStatus.uploading&&g.uploadStatus.progress===100?(_(),D("div",Gs,[c(p,{"img-obj":g.uploadedImg},null,8,["img-obj"])])):v("",!0)]),i("div",{class:le(["upload-status-box",{"wait-upload":!g.uploadStatus.uploading&&g.uploadStatus.progress!==100,uploading:g.uploadStatus.uploading&&g.uploadStatus.progress!==100,uploaded:!g.uploadStatus.uploading&&g.uploadStatus.progress===100}])},[!g.uploadStatus.uploading&&g.uploadStatus.progress!==100?(_(),y(m,{key:0},{default:f(()=>[c(h)]),_:1})):v("",!0),g.uploadStatus.uploading&&g.uploadStatus.progress!==100?(_(),y(m,{key:1,class:"is-loading"},{default:f(()=>[c(I)]),_:1})):v("",!0),!g.uploadStatus.uploading&&g.uploadStatus.progress===100?(_(),y(m,{key:2},{default:f(()=>[c(F)]),_:1})):v("",!0)],2),g.uploadStatus.progress!==100&&!g.uploadStatus.uploading?(_(),D("div",{key:0,class:"remove-to-upload-image",onClick:A=>e.removeToUploadImage(g)},[c(k,{effect:"dark",content:"\u79FB\u9664",placement:"top"},{default:f(()=>[c(m,null,{default:f(()=>[c(C)]),_:1})]),_:1})],8,js)):v("",!0)],2))),128))])])):v("",!0)])):v("",!0)}var Xs=G(ks,[["render",Hs]]);const We=async(e,t)=>{if(!e)return null;if(!St(e.type))return z.error("\u8BE5\u6587\u4EF6\u683C\u5F0F\u4E0D\u652F\u6301\uFF01"),null;let s;const{isCompress:n,compressEncoder:o}=N.getters.getUserSettings,u=e.type==="image/gif";if(!u&&n){const a=ct.service({target:".upload-area",text:"\u6B63\u5728\u538B\u7F29\u56FE\u7247"});s=await Gn(e,o),a.close()}return new Promise(a=>{const l=new FileReader;l.readAsDataURL(!u&&n?s:e),l.onload=d=>{var m;const p=(m=d.target)==null?void 0:m.result,h=Je(p.length);h>=t?Ie.confirm(`\u5F53\u524D\u56FE\u7247 ${(h/1024).toFixed(2)} M\uFF0CCDN \u53EA\u80FD\u52A0\u901F\u5C0F\u4E8E 50 MB \u7684\u56FE\u7247\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u7B2C\u4E09\u65B9\u5DE5\u5177 TinyPNG \u538B\u7F29`,"\u56FE\u7247\u8FC7\u5927\uFF0C\u7981\u6B62\u4E0A\u4F20",{confirmButtonText:"\u524D\u5F80 TinyPNG",cancelButtonText:"\u653E\u5F03\u4E0A\u4F20"}).then(()=>{window.open("https://tinypng.com/")}).catch(()=>{console.log("\u653E\u5F03\u4E0A\u4F20")}):a({base64:p,originalFile:e,compressFile:!u&&n?s:e})}})},Ys=(e,t)=>e.clipboardData&&e.clipboardData.items?new Promise(s=>{var n;for(let o=0,u=e.clipboardData.items.length;o<u;o++){const a=e.clipboardData.items[o];if(a.kind==="file"){const l=a.getAsFile();(n=We(l,t))==null||n.then(d=>{if(!d)return;const{base64:p,originalFile:h,compressFile:m}=d;s({base64:p,originalFile:h,compressFile:m})})}}}):null;const Js=P({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=H(),t=we({userConfigInfo:S(()=>e.getters.getUserConfigInfo).value,userSettings:S(()=>e.getters.getUserSettings).value,uploadAreaActive:S(()=>e.getters.getUploadAreaActive),uploadSettings:S(()=>e.getters.getUploadSettings).value,toUploadImage:S(()=>e.getters.getToUploadImage).value,onSelect(o){var u;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const a of o.target.files)(u=We(a,this.uploadSettings.imageMaxSize))==null||u.then(l=>{if(!l)return;const{base64:d,originalFile:p,compressFile:h}=l;this.getImage(d,p,h)})},onDrop(o){var u;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const a of o.dataTransfer.files)(u=We(a,this.uploadSettings.imageMaxSize))==null||u.then(l=>{if(!l)return;const{base64:d,originalFile:p,compressFile:h}=l;this.getImage(d,p,h)})},async onPaste(o){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);const{base64:u,originalFile:a,compressFile:l}=await Ys(o,this.uploadSettings.imageMaxSize);this.getImage(u,a,l)},getImage(o,u,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const{defaultHash:l,isCompress:d,defaultPrefix:p,prefixName:h}=this.userSettings,m=d?a:u,I=Lt();I.imgData.base64Url=o,I.imgData.base64Content=o.split(",")[1];const{name:F,hash:C,suffix:k}=yt(m==null?void 0:m.name);I.uuid=C,I.fileInfo.compressedSize=a==null?void 0:a.size,I.fileInfo.originSize=u.size,I.fileInfo.size=m==null?void 0:m.size,I.fileInfo.lastModified=m==null?void 0:m.lastModified,I.filename.initName=F,I.filename.name=p?`${h}${F}`:F,I.filename.prefixName=h,I.filename.hash=C,I.filename.suffix=k,I.filename.now=l?`${I.filename.name}.${C}.${k}`:`${I.filename.name}.${k}`,I.filename.isHashRename=l,I.filename.isPrefix=p,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(I))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:C,base64Url:o})},onFocus(){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)}}),s=Le(t),n=t.onPaste.bind(t);return ne(()=>{window.addEventListener("paste",n)}),fn(()=>{window.removeEventListener("paste",n)}),ge({},s)}}),qs=e=>(ae("data-v-0a450f9d"),e=e(),ue(),e),Ks={key:0,for:"uploader",class:"active-upload"},Ws={key:1,class:"tips active-upload"},Qs=qs(()=>i("div",{class:"text active-upload"},"\u62D6\u62FD\u3001\u7C98\u8D34\u3001\u6216\u70B9\u51FB\u6B64\u5904\u4E0A\u4F20",-1)),Zs=["src"];function eo(e,t,s,n,o,u){const a=j("UploadFilled"),l=pe,d=$e;return J((_(),D("div",{class:le(["upload-area active-upload",{focus:e.uploadAreaActive}]),onDragover:t[2]||(t[2]=oe(()=>{},["prevent"])),onDrop:t[3]||(t[3]=oe((...p)=>e.onDrop&&e.onDrop(...p),["stop","prevent"])),onPaste:t[4]||(t[4]=oe((...p)=>e.onPaste&&e.onPaste(...p),["stop"])),"element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(_(),D("label",Ks)):v("",!0),i("input",{id:"uploader",type:"file",onChange:t[0]||(t[0]=(...p)=>e.onSelect&&e.onSelect(...p)),multiple:"multiple",autofocus:"",onFocus:t[1]||(t[1]=(...p)=>e.onFocus&&e.onFocus(...p))},null,32),e.toUploadImage.curImgBase64Url?v("",!0):(_(),D("div",Ws,[c(l,{class:"icon active-upload"},{default:f(()=>[c(a)]),_:1}),Qs])),e.toUploadImage.curImgBase64Url?(_(),D("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,Zs)):v("",!0)],34)),[[d,e.imageLoading]])}var to=G(Js,[["render",eo],["__scopeId","data-v-0a450f9d"]]);const no={class:"upload-page-container"},so={key:0,class:"upload-page-left page-container",style:{width:"280rem"}},oo={class:"upload-page-right page-container"},ao={class:"row-item"},uo={class:"content-box"},lo={class:"row-item"},io={class:"content-box"},ro={class:"row-item"},co={class:"content-box",style:{"text-align":"right"}},_o=P({__name:"upload",setup(e){const t=H(),s=De();B(null),B(null);const n=B(null),o=B(null),u=S(()=>t.getters.getUserConfigInfo),a=S(()=>t.getters.getUserSettings),l=S(()=>t.getters.getUserLoggingStatus),d=S(()=>t.getters.getUploadedImageList),p=S(()=>t.getters.getToUploadImage),h=B(!1),m=()=>{const{token:F,selectedRepos:C,selectedDir:k}=u.value;if(!F){z.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E\uFF01"),s.push("/config");return}if(!C){z.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),s.push("/config");return}if(!k){z.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),s.push("/config");return}if(p.value.list.length===0){z.error("\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}if(p.value.list.length===p.value.uploadedNumber){z.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247\uFF01");return}h.value=!0,n.value.uploadImage_all(u.value).then(g=>{switch(g){case se.uploaded:case se.allUploaded:h.value=!1,t.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case se.uploadFail:h.value=!1,t.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL");break}}).catch(g=>{console.error("upload error: ",g),h.value=!1})},I=()=>{h.value=!1,t.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return K(()=>l,F=>{!F&&I()}),(F,C)=>{const k=ze;return _(),D("div",no,[r(d).length&&r(a).elementPlusSize==="large"?(_(),D("div",so,[(_(!0),D(de,null,_e(r(d),(g,$)=>(_(),D("div",{class:"uploaded-item",key:$},[c(Bt,{"image-obj":g,"is-uploaded":!0},null,8,["image-obj"])]))),128))])):v("",!0),i("div",oo,[i("div",ao,[i("div",uo,[c(to,{"image-loading":h.value,ref_key:"uploadAreaDom",ref:o},null,8,["image-loading"])])]),i("div",lo,[i("div",io,[c(Xs,{ref_key:"toUploadImageCardDom",ref:n,"loading-all-image":h.value},null,8,["loading-all-image"])])]),i("div",ro,[i("div",co,[r(p).list.length?(_(),y(k,{key:0,plain:"",type:"warning",onClick:I},{default:f(()=>[T("\u91CD\u7F6E ")]),_:1})):v("",!0),c(k,{plain:"",type:"primary",onClick:m},{default:f(()=>[T(" \u4E0A\u4F20 ")]),_:1})])])])])}}});const Tt=e=>(ae("data-v-5d9c41a5"),e=e(),ue(),e),po=Tt(()=>i("div",{class:"icon"},[i("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[i("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),i("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),mo={key:1,class:"icon"},fo=Tt(()=>i("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[i("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),go=[fo],ho={key:2,class:"text"},Eo={key:3,class:"text"},vo=P({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,s=H(),n=S(()=>s.getters.getUserConfigInfo).value,o=()=>{const{folderObj:u,mode:a}=t;if(a==="back"){const l=n.viewDir;if(l==="/")return;const d=l.split("/");d.length===1?n.viewDir="/":d.length>1&&(d.length-=1,n.viewDir=d.join("/"))}a==="dir"&&(n.viewDir=u.dirPath),s.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,a)=>{const l=ce;return _(),D("div",{class:"folder-card",onDblclick:o},[e.mode==="dir"?(_(),y(l,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:f(()=>[po]),_:1})):v("",!0),e.mode==="back"?(_(),D("div",mo,go)):v("",!0),e.mode==="dir"?(_(),D("div",ho,V(e.folderObj.dir),1)):v("",!0),e.mode==="back"?(_(),D("div",Eo,"\u53CC\u51FB\u540E\u9000")):v("",!0)],32)}}});var Ot=G(vo,[["__scopeId","data-v-5d9c41a5"]]);let Ae=0;async function Fo(e,t){e.deleting=!0;const{owner:s,selectedRepos:n}=t;return new Promise((o,u)=>{W.delete(`/repos/${s}/${n}/contents/${e.path}`,{data:{owner:s,repo:n,path:e.path,message:"delete picture via PicX(https://github.com/XPoet/picx)",sha:e.sha}}).then(a=>{a&&a.status===200?(e.deleting=!1,N.dispatch("UPLOADED_LIST_REMOVE",e.uuid),N.dispatch("DIR_IMAGE_LIST_REMOVE",e),o(!0)):(e.deleting=!1,o(!1))}).catch(a=>{u(a)})})}async function Mt(e,t){return Ae>=e.length?me.deleted:await Fo(e[Ae],t)?Ae<e.length&&(Ae+=1,await Mt(e,t))?(Ae=0,me.allDeleted):me.deleted:me.deleteFail}const Do={key:0,class:"selector-wrapper"},Io={class:"selector-left-box"},Co={class:"item"},Ao={class:"selector-right-box"},bo=P({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e,{emit:t}){const s=e,n=H(),o=B(!1),u=S(()=>n.getters.getImageCardCheckedArr),a=S(()=>n.getters.getUserConfigInfo).value,l=S(()=>n.getters.getUserSettings).value,d=S(()=>u.value.length||0);K(()=>d.value,F=>{const C=s.currentDirImageList.length;o.value=F===C});function p(){Jn(u.value,l.externalLinkType)}function h(){s.currentDirImageList.forEach(F=>{F.checked&&(F.checked=!1)})}async function m(){var F;((F=u.value)==null?void 0:F.length)>0?Ie.confirm("\u662F\u5426\u6279\u91CF\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u56FE\u7247\uFF1F","\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{await Mt(u.value,a)===me.allDeleted&&z.success("\u6279\u91CF\u5220\u9664\u6210\u529F\uFF01")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):z.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")}function I(){let F=[];s.currentDirImageList.forEach(C=>{C.checked=o.value}),F=s.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:F})}return ne(()=>{I()}),(F,C)=>{const k=dt,g=j("CopyDocument"),$=pe,A=ce,R=j("Delete");return r(d)?(_(),D("div",Do,[i("div",Io,[c(k,{label:o.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:o.value,"onUpdate:modelValue":C[0]||(C[0]=Q=>o.value=Q),onChange:I},null,8,["label","modelValue"]),i("div",Co,"\u5DF2\u9009\u62E9 "+V(r(d))+" \u5F20\u56FE\u7247",1),i("div",{class:"item cancel-select-btn",onClick:h},"\u53D6\u6D88\u9009\u62E9")]),i("div",Ao,[c(A,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u5916\u94FE"},{default:f(()=>[c($,{class:"btn-icon",onClick:p},{default:f(()=>[c(g)]),_:1})]),_:1}),c(A,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:f(()=>[c($,{class:"btn-icon",onClick:m},{default:f(()=>[c(R)]),_:1})]),_:1})])])):v("",!0)}}});var So=G(bo,[["__scopeId","data-v-52ded6e0"]]);const yo=e=>(ae("data-v-06d1e340"),e=e(),ue(),e),ko={class:"page-container management-page-container"},$o={class:"content-container"},wo={class:"top"},Lo={class:"left"},Uo={class:"right flex-start"},Bo={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},To={key:0,class:"image-item"},Oo=yo(()=>i("div",{class:"clear"},null,-1)),Mo=P({__name:"management",setup(e){const t=H(),s=De(),n=S(()=>t.getters.getUserConfigInfo).value,o=S(()=>t.getters.getUserLoggingStatus).value,u=S(()=>t.getters.getDirObject).value,a=B(new Date().getTime()),l=B(!1),d=B(!1),p=B(),h=B([]),m=B([]);async function I($){l.value=!0;const A=Be($,u);if(A){const R=Te($,A,"dir"),Q=Te($,A,"image");!R.length&&!Q.length?await Re($):(h.value=R,m.value=Q,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value}))}else await Re($);l.value=!1}async function F(){const{selectedDir:$,viewDir:A,dirMode:R}=n;if(A===""&&((R===Y.newDir||R===Y.autoDir)&&!Be($,u)&&(n.selectedDir="/",n.dirMode="rootDir"),n.selectedDir?n.viewDir=n.selectedDir:n.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await Re(n.viewDir);return}await I(n.viewDir)}function C(){d.value=!d.value}async function k(){const{viewDir:$}=n;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",$),l.value=!0,await Re($),l.value=!1}ne(()=>{F()}),K(()=>o,$=>{$===!1&&s.push("/config")}),K(()=>n.viewDir,async $=>{await I($),a.value+=1},{deep:!0}),K(()=>u,$=>{const{viewDir:A}=n,R=Be(A,$);R&&(h.value=Te(A,R,"dir"),m.value=Te(A,R,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value}))},{deep:!0});const g=B(!1);return K(()=>m.value,$=>{g.value=$.filter(A=>A.checked).length>0},{deep:!0}),($,A)=>{const R=j("Tickets"),Q=j("Menu"),w=pe,O=ce,X=j("Refresh"),q=$e;return _(),D("div",ko,[i("div",$o,[i("div",wo,[i("div",Lo,[c(Ke,{"bar-type":"management"})]),i("div",Uo,[c(O,{placement:"top",content:d.value?"\u5207\u6362\u65B9\u5757\u5C55\u793A":"\u5207\u6362\u5217\u8868\u5C55\u793A"},{default:f(()=>[c(w,{class:"btn-icon",onClick:oe(C,["stop"])},{default:f(()=>[d.value?(_(),y(R,{key:0})):v("",!0),d.value?v("",!0):(_(),y(Q,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"]),c(O,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D"},{default:f(()=>[c(w,{class:"btn-icon",onClick:oe(k,["stop"])},{default:f(()=>[c(X)]),_:1},8,["onClick"])]),_:1})])]),J((_(),D("div",Bo,[m.value.length?(_(),y(So,{currentDirImageList:m.value,"onUpdate:initImageList":m.value,key:a.value},null,8,["currentDirImageList","onUpdate:initImageList"])):v("",!0),i("ul",{class:"image-list",style:_t({height:g.value?"calc(100% - 50rem)":"100%"})},[r(n).viewDir!=="/"?(_(),D("li",To,[c(Ot,{mode:"back"})])):v("",!0),(_(!0),D(de,null,_e(h.value,(b,E)=>(_(),D("li",{class:"image-item",key:E},[c(Ot,{"folder-obj":b},null,8,["folder-obj"])]))),128)),Oo,(_(!0),D(de,null,_e(m.value,(b,E)=>(_(),D("li",{class:"image-item",key:E,style:_t({width:d.value?"50%":"230rem",height:d.value?"80rem":"240rem"})},[c(Bt,{"image-obj":b,listing:d.value,modelValue:p.value,"onUpdate:modelValue":A[0]||(A[0]=L=>p.value=L),index:E},null,8,["image-obj","listing","modelValue","index"])],4))),128))],4)])),[[q,l.value]])])])}}});var xo=G(Mo,[["__scopeId","data-v-06d1e340"]]);const Ro={},Po={class:"tutorials-step-3"},Vo=gn('<h3>\u8FDB\u884C\u56FE\u5E8A\u914D\u7F6E\uFF08\u7ED1\u5B9A GitHub Token\u3001\u5B58\u50A8\u56FE\u7247\u7684\u4ED3\u5E93\u548C\u76EE\u5F55\uFF09</h3><p>1\u3001\u586B\u5199 Token\uFF0C\u81EA\u52A8\u83B7\u53D6\u8BE5\u7528\u6237\u4E0B\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2\u3001\u5728\u4ED3\u5E93\u7684\u4E0B\u62C9\u5217\u8868\u4E2D\uFF0C\u9009\u62E9\u4E00\u4E2A\u4F5C\u4E3A\u56FE\u5E8A\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3\u3001\u9009\u62E9\u4E00\u79CD\u76EE\u5F55\u65B9\u5F0F\uFF08\u76EE\u5F55\u5373\u4ED3\u5E93\u91CC\u5B58\u653E\u56FE\u7247\u7684\u6587\u4EF6\u5939\uFF09</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>\u65B0\u5EFA\u76EE\u5F55\uFF1A\u9700\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\u3002</li><li>\u6839\u76EE\u5F55\uFF1A\u56FE\u7247\u5C06\u76F4\u63A5\u5B58\u50A8\u5728\u4ED3\u5E93\u6839\u76EE\u5F55\u4E0B\u3002</li><li>\u81EA\u52A8\u76EE\u5F55\uFF1A\u81EA\u52A8\u751F\u6210\u65E5\u671F\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55\u3002\u4F8B\u5982\uFF1A20200909</li><li>\u9009\u62E9\u4ED3\u5E93\u76EE\u5F55\uFF1A\u81EA\u52A8\u83B7\u53D6\u4ED3\u5E93\u4E0B\u6240\u6709\u76EE\u5F55\uFF0C\u9009\u62E9\u4E00\u4E2A\u5373\u53EF\u3002</li></ul></div>',10),No=[Vo];function zo(e,t){return _(),D("div",Po,No)}var xt=G(Ro,[["render",zo]]);const Go={class:"tutorials-step-2"},jo=i("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),Ho=i("p",null,"\u7136\u540E\u70B9\u51FB Generate token \u6309\u94AE\uFF0C\u5373\u53EF\u751F\u6210\u4E00\u4E2Atoken\uFF0C\u5982\u4E0B\u56FE\uFF1A",-1),Xo=i("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),Yo=i("p",{style:{color:"red"}},[i("em",null,"\u65B0\u751F\u6210\u7684 Token \u53EA\u4F1A\u663E\u793A\u4E00\u6B21\uFF0C\u8BF7\u59A5\u5584\u4FDD\u5B58\uFF01\u5982\u6709\u9057\u5931\uFF0C\u91CD\u65B0\u751F\u6210\u5373\u53EF\u3002")],-1),Rt=P({__name:"step2",setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(s,n)=>(_(),D("div",Go,[i("h3",null,[T(" \u521B\u5EFA\u4E00\u4E2A\u6709 repo \u6743\u9650\u7684 "),i("span",{class:"go-create-token",onClick:t}," GitHub Token")]),jo,Ho,Xo,Yo]))}});const Jo={class:"tutorials-step-1"},qo=i("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1),Pt=P({__name:"step1",setup(e){function t(){window.open("https://github.com/new")}return(s,n)=>(_(),D("div",Jo,[i("h3",null,[T(" \u521B\u5EFA\u4E00\u4E2A\u7528\u6765\u5B58\u50A8\u56FE\u7247\u7684 "),i("span",{class:"go-create-repo",onClick:t}," GitHub \u4ED3\u5E93")]),qo]))}});const Ko=P({name:"tutorials",components:{Step1:Pt,Step2:Rt,Step3:xt},setup(){const e=B(0);return{stepNum:e,step:s=>{s==="prev"&&(e.value<0?e.value=0:e.value-=1),s==="next"&&(e.value>3?e.value=3:e.value+=1)}}}}),Vt=e=>(ae("data-v-0275023f"),e=e(),ue(),e),Wo={class:"page-container tutorials-page-container"},Qo={class:"step-content"},Zo={key:3},ea=Vt(()=>i("h2",null,"\u{1F44D} \u606D\u559C\u4F60\u5B8C\u6210\u56FE\u5E8A\u4F7F\u7528\u6559\u7A0B \u{1F31F} \u5FEB\u53BB\u8BD5\u8BD5\u5427~",-1)),ta=Vt(()=>i("h2",null,"https://github.com/XPoet/picx",-1)),na=[ea,ta],sa={class:"btn-next-prev"};function oa(e,t,s,n,o,u){const a=hn,l=En,d=Pt,p=Rt,h=xt,m=ze;return _(),D("div",Wo,[c(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:f(()=>[c(a,{title:"\u521B\u5EFA GitHub \u4ED3\u5E93"}),c(a,{title:"\u83B7\u53D6 GitHub Token"}),c(a,{title:"\u914D\u7F6E\u56FE\u5E8A"})]),_:1},8,["active"]),i("div",Qo,[e.stepNum===0?(_(),y(d,{key:0})):v("",!0),e.stepNum===1?(_(),y(p,{key:1})):v("",!0),e.stepNum===2?(_(),y(h,{key:2})):v("",!0),e.stepNum===3?(_(),D("div",Zo,na)):v("",!0)]),i("div",sa,[e.stepNum>0?(_(),y(m,{key:0,type:"primary",onClick:t[0]||(t[0]=I=>e.step("prev"))},{default:f(()=>[T("\u4E0A\u4E00\u6B65 ")]),_:1})):v("",!0),e.stepNum<3?(_(),y(m,{key:1,type:"primary",onClick:t[1]||(t[1]=I=>e.step("next"))},{default:f(()=>[T("\u4E0B\u4E00\u6B65 ")]),_:1})):v("",!0)])])}var aa=G(Ko,[["render",oa],["__scopeId","data-v-0275023f"]]);const ve=e=>(ae("data-v-38b000ea"),e=e(),ue(),e),ua={class:"page-container settings-page-container"},la=ve(()=>i("div",{class:"setting-title"},"\u4E2A\u6027\u8BBE\u7F6E\uFF1A",-1)),ia={class:"setting-list"},ra={class:"setting-item"},ca={class:"setting-item"},da={class:"setting-item"},_a=ve(()=>i("div",{class:"setting-title"},"CDN \u63D0\u4F9B\u5546\uFF1A",-1)),pa={class:"setting-list"},ma={class:"setting-item"},fa=ve(()=>i("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),ga={class:"setting-list"},ha={class:"setting-item"},Ea={class:"setting-item"},va=ve(()=>i("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u50CF\u7F16\u7801\u5668\uFF08\u538B\u7F29\u7B97\u6CD5\uFF09\uFF1A",-1)),Fa=ve(()=>i("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),Da={class:"setting-list"},Ia={class:"setting-item"},Ca={key:0,class:"setting-title"},Aa={key:1,class:"setting-list"},ba={class:"setting-item"},Sa=ve(()=>i("span",{class:"time-middle-space"}," ~ ",-1)),ya=P({__name:"settings",setup(e){const t=S(()=>N.getters.getUserSettings).value,s=()=>{N.dispatch("USER_SETTINGS_PERSIST")},n=Oe,o=()=>{N.dispatch("SET_USER_SETTINGS",ge({},t)),s()};return(u,a)=>{const l=pt,d=ke,p=nt,h=st,m=ot,I=at,F=vn,C=et,k=tt;return _(),D("div",ua,[la,i("ul",ia,[i("li",ra,[c(l,{modelValue:r(t).defaultHash,"onUpdate:modelValue":a[0]||(a[0]=g=>r(t).defaultHash=g),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u54C8\u5E0C\u7801\uFF08\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F\uFF09"},null,8,["modelValue"])]),i("li",ca,[c(l,{modelValue:r(t).defaultPrefix,"onUpdate:modelValue":a[1]||(a[1]=g=>r(t).defaultPrefix=g),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u914D\u7F6E\u7684\u524D\u7F00\uFF08\u793A\u4F8B\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00\uFF09"},null,8,["modelValue"]),r(t).defaultPrefix?(_(),y(d,{key:0,class:"prefix-input",modelValue:r(t).prefixName,"onUpdate:modelValue":a[2]||(a[2]=g=>r(t).prefixName=g),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:s,clearable:"",autofocus:""},null,8,["modelValue"])):v("",!0)]),i("li",da,[c(l,{modelValue:r(t).defaultMarkdown,"onUpdate:modelValue":a[3]||(a[3]=g=>r(t).defaultMarkdown=g),onChange:s,"active-text":"\u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u5916\u94FE\u542F\u7528 Markdown \u683C\u5F0F\uFF08![ ... ]( ... )\uFF09"},null,8,["modelValue"])])]),_a,i("ul",pa,[i("li",ma,[c(h,{modelValue:r(t).externalLinkType,"onUpdate:modelValue":a[4]||(a[4]=g=>r(t).externalLinkType=g),placeholder:"\u9009\u62E9 CDN \u63D0\u4F9B\u5546",onChange:o},{default:f(()=>[c(p,{label:"Staticaly",value:"staticaly"}),c(p,{label:"zzko",value:"zzko"}),c(p,{label:"jsDelivr",value:"jsdelivr"})]),_:1},8,["modelValue"])])]),fa,i("ul",ga,[i("li",ha,[c(l,{modelValue:r(t).isCompress,"onUpdate:modelValue":a[5]||(a[5]=g=>r(t).isCompress=g),onChange:s,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"])]),i("li",Ea,[va,c(I,{disabled:!r(t).isCompress,modelValue:r(t).compressEncoder,"onUpdate:modelValue":a[6]||(a[6]=g=>r(t).compressEncoder=g),onChange:s},{default:f(()=>[c(m,{label:r(n).webP},{default:f(()=>[T(V(r(n).webP)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u5927\u591A\u6570\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"]),c(m,{label:r(n).mozJPEG},{default:f(()=>[T(V(r(n).mozJPEG)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF09 ",1)]),_:1},8,["label"]),c(m,{label:r(n).avif},{default:f(()=>[T(V(r(n).avif)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u6BD4\u6700\u9AD8\uFF0C\u76EE\u524D\u4EC5\u8C37\u6B4C\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])])]),Fa,i("ul",Da,[i("li",Ia,[c(h,{modelValue:r(t).themeMode,"onUpdate:modelValue":a[7]||(a[7]=g=>r(t).themeMode=g),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:o},{default:f(()=>[c(p,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:"auto"}),c(p,{label:"\u6697\u591C\u4E3B\u9898",value:"dark"}),c(p,{label:"\u767D\u663C\u4E3B\u9898",value:"light"})]),_:1},8,["modelValue"])])]),r(t).themeMode==="auto"?(_(),D("div",Ca," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):v("",!0),r(t).themeMode==="auto"?(_(),D("ul",Aa,[i("li",ba,[c(k,{ref:"form"},{default:f(()=>[c(C,null,{default:f(()=>[c(F,{modelValue:r(t).autoLightThemeTime[0],"onUpdate:modelValue":a[8]||(a[8]=g=>r(t).autoLightThemeTime[0]=g),start:"00:00",step:"00:30",end:"23:59",onChange:o},null,8,["modelValue"]),Sa,c(F,{modelValue:r(t).autoLightThemeTime[1],"onUpdate:modelValue":a[9]||(a[9]=g=>r(t).autoLightThemeTime[1]=g),start:r(t).autoLightThemeTime[0],step:"00:30",end:"23:59",onChange:o},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):v("",!0)])}}});var ka=G(ya,[["__scopeId","data-v-38b000ea"]]);const Fe=" | PicX \u56FE\u5E8A\u795E\u5668",$a=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Qn,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${Fe}`}},{path:"/upload",name:"upload",component:_o,meta:{title:`\u56FE\u7247\u4E0A\u4F20${Fe}`}},{path:"/management",name:"Management",component:xo,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${Fe}`}},{path:"/tutorials",name:"tutorials",component:aa,meta:{title:`\u4F7F\u7528\u6559\u7A0B${Fe}`}},{path:"/about",name:"about",component:()=>gt(()=>import("./about.71bda61a.js"),["assets/about.71bda61a.js","assets/about.8b9cf834.css","assets/vendor.eba18976.js","assets/vendor.4a75f9e7.css"]),meta:{title:`\u5E2E\u52A9\u53CD\u9988${Fe}`}},{path:"/settings",name:"settings",component:ka,meta:{title:`\u6211\u7684\u8BBE\u7F6E${Fe}`}}],Nt=Fn({history:Dn(),routes:$a});Nt.beforeEach((e,t,s)=>{e.meta.title&&(window.document.title=e.meta.title),s()});const wa=e=>(ae("data-v-56a77182"),e=e(),ue(),e),La={class:"nav"},Ua={class:"nav-list"},Ba=["onClick"],Ta={class:"nav-content"},Oa={class:"nav-name"},Ma={class:"nav-content"},xa=wa(()=>i("span",{class:"nav-name"},"\u5FEB\u6377\u64CD\u4F5C",-1)),Ra={class:"quick-actions-box"},Pa=P({__name:"nav-content",setup(e){const t=De(),s=H(),n=S(()=>s.getters.getUserConfigInfo).value,o=S(()=>s.getters.getUserSettings).value,u=S(()=>{switch(o.elementPlusSize){case"small":return 22;case"large":return 30;default:return 26}}),a=B(o.themeMode==="dark"),l=B([{name:"\u56FE\u5E8A\u914D\u7F6E",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"\u4E0A\u4F20\u56FE\u7247",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"\u56FE\u5E8A\u7BA1\u7406",icon:"box",isActive:!1,path:"/management",isShow:!0},{name:"\u6211\u7684\u8BBE\u7F6E",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"\u4F7F\u7528\u6559\u7A0B",icon:"magic-stick",isActive:!1,path:"/tutorials",isShow:!0},{name:"\u5E2E\u52A9\u53CD\u9988",icon:"chat-dot-round",isActive:!1,path:"/about",isShow:!0}]),d=B(!1),p=F=>{const{path:C}=F;if(C==="/management"){if(n.selectedRepos===""){z.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),t.push("/config");return}if(n.selectedDir===""){z.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),t.push("/config");return}}t.push(C)},h=F=>{l.value.forEach(C=>{const k=C;return k.isActive=C.path===F,k})},m=()=>{s.dispatch("USER_SETTINGS_PERSIST")},I=()=>{o.themeMode==="dark"?o.themeMode="light":o.themeMode="dark",m()};return K(()=>t.currentRoute.value,F=>{h(F.path)}),K(()=>n.loggingStatus,F=>{l.value.forEach(C=>{switch(C.path){case"/management":case"/settings":C.isShow=F}})},{deep:!0,immediate:!0}),ne(()=>{var F,C;t.isReady().then(()=>{h(t.currentRoute.value.path)}),(F=document.querySelector(".quick-actions .quick-actions-box"))==null||F.addEventListener("click",k=>{d.value=!0,k.stopPropagation()}),(C=document.querySelector(".quick-actions"))==null||C.addEventListener("click",k=>{d.value=!d.value,k.stopPropagation()}),document.addEventListener("click",()=>{d.value&&(d.value=!1)})}),(F,C)=>{const k=pe,g=j("Operation"),$=pt;return _(),D("aside",La,[i("ul",Ua,[(_(!0),D(de,null,_e(l.value,(A,R)=>J((_(),D("li",{class:le(["nav-item flex-center",{active:A.isActive}]),key:R,onClick:Q=>p(A)},[i("div",Ta,[c(k,{size:r(u)},{default:f(()=>[(_(),y(In(A.icon)))]),_:2},1032,["size"]),i("span",Oa,V(A.name),1)])],10,Ba)),[[he,A.isShow]])),128))]),i("div",{class:le(["nav-item quick-actions flex-center",{active:d.value}])},[i("div",Ma,[c(k,{size:r(u)},{default:f(()=>[c(g)]),_:1},8,["size"]),xa]),J(i("div",Ra,[c($,{modelValue:a.value,"onUpdate:modelValue":C[0]||(C[0]=A=>a.value=A),class:"mb-2","active-text":"\u6697\u591C\u6A21\u5F0F",onChange:I},null,8,["modelValue"]),c($,{modelValue:r(o).isCompress,"onUpdate:modelValue":C[1]||(C[1]=A=>r(o).isCompress=A),class:"mb-2","active-text":"\u538B\u7F29\u56FE\u7247",onChange:m},null,8,["modelValue"]),c($,{modelValue:r(o).defaultMarkdown,"onUpdate:modelValue":C[2]||(C[2]=A=>r(o).defaultMarkdown=A),class:"mb-2","active-text":"\u8F6C\u6362 Markdown",onChange:m},null,8,["modelValue"])],512),[[he,d.value]])],2)])}}});var zt=G(Pa,[["__scopeId","data-v-56a77182"]]);const Va=P({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e,t){const s=B(null),n=B(!1),o=(u,a)=>u.querySelector(`.${a?"u":"p"}v`).innerText;return ne(()=>{const u=document.createElement("script");u.async=!0,u.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",s.value.appendChild(u),u.onload=()=>{const a=setTimeout(()=>{o(s.value,e.isuv)&&(n.value=!0),clearTimeout(a)},1500)}}),{siteCountDom:s,isShow:n}}}),Na={class:"site-count",ref:"siteCountDom"},za={id:"busuanzi_value_site_uv",class:"uv"},Ga={id:"busuanzi_value_site_pv",class:"pv"};function ja(e,t,s,n,o,u){return J((_(),D("span",Na,[T(" \u8D85\u8FC7 "),J(i("span",za,null,512),[[he,e.isuv]]),J(i("span",Ga,null,512),[[he,!e.isuv]]),T(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[he,e.isShow]])}var Gt=G(Va,[["render",ja]]),Ha="./assets/logo.206d082d.png";const Xa=P({name:"header-content",components:{siteCount:Gt},setup(){const e=De(),t=H(),s=we({defaultUsername:"\u672A\u767B\u5F55",userConfigInfo:S(()=>t.state.userConfigInfoModule.userConfigInfo)}),n=()=>{!s.userConfigInfo.loggingStatus&&e.currentRoute.value.path!=="/config"&&e.push("/config")},o=()=>{t.dispatch("LOGOUT"),e.push("/config")},u=l=>{switch(l){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":o();break}},a=()=>{window.open("https://github.com/XPoet/picx")};return Ne(ge({},Le(s)),{router:e,onUserInfoClick:n,handleCommand:u,goGitHubRepo:a})}}),jt=e=>(ae("data-v-23f79e85"),e=e(),ue(),e),Ya={class:"header"},Ja={class:"header-left"},qa=jt(()=>i("div",{class:"logo"},[i("img",{src:Ha,alt:"PicX"})],-1)),Ka=jt(()=>i("div",{class:"title"},"PicX",-1)),Wa=[qa,Ka],Qa={class:"header-right"},Za={class:"username"},eu={key:0,class:"avatar"},tu={class:"el-dropdown-link"},nu={class:"avatar"},su=["src","alt"];function ou(e,t,s,n,o,u){var F,C;const a=Gt,l=ce,d=j("UserFilled"),p=pe,h=lt,m=it,I=rt;return _(),D("header",Ya,[i("div",Ja,[i("div",{class:"brand",onClick:t[0]||(t[0]=k=>e.router.push("/"))},Wa),i("div",{class:"website-count",onClick:t[1]||(t[1]=(...k)=>e.goGitHubRepo&&e.goGitHubRepo(...k))},[c(l,{content:"\u611F\u89C9\u597D\u7528\uFF0C\u70B9 Star \u652F\u6301\u4F5C\u8005(*\uFFE3\uFE36\uFFE3)",placement:"bottom"},{default:f(()=>[c(a,{isuv:!1})]),_:1})])]),i("div",Qa,[i("div",{class:"user-info",onClick:t[2]||(t[2]=(...k)=>e.onUserInfoClick&&e.onUserInfoClick(...k))},[i("div",Za,V(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),((F=e.userConfigInfo)==null?void 0:F.avatarUrl)?v("",!0):(_(),D("div",eu,[c(p,{size:22},{default:f(()=>[c(d)]),_:1})])),((C=e.userConfigInfo)==null?void 0:C.avatarUrl)?(_(),y(I,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:f(()=>[c(m,null,{default:f(()=>[c(h,{command:"logout"},{default:f(()=>[T(" \u9000\u51FA\u767B\u5F55 ")]),_:1})]),_:1})]),default:f(()=>{var k,g;return[i("span",tu,[i("span",nu,[i("img",{src:(k=e.userConfigInfo)==null?void 0:k.avatarUrl,alt:(g=e.userConfigInfo)==null?void 0:g.owner},null,8,su)])])]}),_:1},8,["onCommand"])):v("",!0)])])])}var Ht=G(Xa,[["render",ou],["__scopeId","data-v-23f79e85"]]);const Xt=()=>{const e=H(),t=async o=>{await ut(()=>{const u=document.getElementsByTagName("html")[0];o==="dark"?(u.classList.remove("light"),u.classList.add("dark")):(u.classList.remove("dark"),u.classList.add("light"))})},s=o=>{const u=l=>{const d=new Date,p=d.getFullYear(),h=d.getMonth()+1,m=d.getDate();return new Date(`${p}/${h}/${m} ${o[l]}:00`).getTime()},a=Date.now();return u(0)<=a&&a<=u(1)},n=o=>{const{themeMode:u,autoLightThemeTime:a}=o;t(u==="auto"?s(a)?"light":"dark":u)};K(()=>e.getters.getUserSettings,o=>{n(o)},{deep:!0,immediate:!0})};const au=P({name:"main-container",components:{headerContent:Ht,navContent:zt},setup(){const e=H(),t=s=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",s.target.classList.contains("active-upload"))};return ne(()=>{Xt()}),{changeUploadAreaActive:t}}}),uu={class:"top-container"},lu={class:"bottom-container"},iu={class:"bottom-content"},ru={class:"left"},cu={class:"right"},du={class:"content"};function _u(e,t,s,n,o,u){const a=Ht,l=zt,d=j("router-view");return _(),D("main",{class:"main-container",onClick:t[0]||(t[0]=(...p)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(...p))},[i("div",uu,[c(a)]),i("div",lu,[i("div",iu,[i("div",ru,[c(l)]),i("div",cu,[i("div",du,[c(d)])])])])])}var Yt=G(au,[["render",_u],["__scopeId","data-v-6f4aaa19"]]);const pu=P({name:"App",components:{ElConfigProvider:mt,mainContainer:Yt},setup(){const e=H(),t=we({zIndex:3e3,size:"small",locale:Cn}),s=n=>{n<=600?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"small"}),t.size="small"):n<=800?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"default"}),t.size="default"):(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"large"}),t.size="large")};return ne(()=>{Xt(),s(window.innerWidth),window.addEventListener("resize",n=>{s(n.target.innerWidth)})}),ge({},Le(t))}});function mu(e,t,s,n,o,u){const a=Yt,l=mt;return _(),y(l,{size:e.size,"z-index":e.zIndex,locale:e.locale},{default:f(()=>[c(a)]),_:1},8,["size","z-index","locale"])}var fu=G(pu,[["render",mu]]);gt(()=>import("./register-sw.215decb5.js"),[]);const Jt=An(fu);for(const[e,t]of Object.entries(bn))Jt.component(e,t);Jt.use(Nt).use(N,bt).mount("#app");export{G as _};
